function Wimpy(C) {
    var A = "xml";
    var K = "skin";
    var J = "auto";
    var I;
    var L = null;
    var B;
    var G;
    var M;
    var F;
    var E = this;
    var D;
    var H = C;
    this.load = function (N) {
        L = N;
        L.setIcon(IMAGE_PREFIX + "images/flakes/music.gif");
        L.flakeAdded = function () {
            if (Browser.isIE6) {
                debug.trace("IE6 again called");
                E.makeWimpy(F, _skin, G)
            } 
        };
        if (!L.title) {
            L.setTitle("Podcast")
        }
        I = $(H + "wimpy_embed");
        B = $(H + "xmlbox");
        _autobox = $(H + "auto");
        M = $(H + "skin_select");
        if (F = L.Profiles[A]) {
            _skin = L.Profiles[K];
            G = L.Profiles[J];
            if (Browser.isIE6) {
                setTimeout(function () {
                    E.makeWimpy(F, _skin, G)
                }, 1000)
            }
            else {
                E.makeWimpy(F, _skin, G)
            }
            B.value = F;
            _autobox.checked = G == "True" ? true : false;
            M.value = L.Profiles[K]
        }
        else {
            var P = L.url;
            var O = P.split("=");
            if (O[1]) {
                B.value = unescape(O[1]);
                M.value = "blackpod";
                E.makeWimpy(B.value, M.value, false)
            }
            else {
                L.toggleEdit()
            } 
        } 
    };
    this.onclose = function () {
        I.innerHTML = ""
    };
    this.save = function () {
        L.Profiles[A] = B.value;
        L.Profiles[K] = M.value;
        L.Profiles[J] = $(H + "auto").checked;
        L.save()
    };
    this.submit = function () {
        E.save();
        E.makeWimpy(L.Profiles[A], L.Profiles[K], L.Profiles[J]);
        L.toggleEdit()
    };
    this.keyPress = function (N) {
        if (N.keyCode == 13) {
            this.submit()
        } 
    };
    this.cancel = function () {
        L.toggleEdit()
    };
    this.makeWimpy = function (S, U, T) {
        var V = SITE_PREFIX + "flakes/wimpy/";
        RssServices.GetRSSChannel(S, false, 1, function (W) {
            if (W == null) {
                $(H + "wimpy_embed").innerHTML = "The url is invalid or doesn't contain a podcast. Please check again."
            }
            else {
                if (W.Title) {
                    L.setTitle(W.Title)
                } 
            } 
        }
        , function () {
            alert("The url is invalid")
        });
        var O = new Array();
        var P = new Array();
        O.aiwa = 275;
        P.aiwa = 233;
        O.aqua = 275;
        P.aqua = 239;
        O.blackdawn = 275;
        P.blackdawn = 275;
        O.blanco = 167;
        P.blanco = 142;
        O.fruity = 269;
        P.fruity = 222;
        O.ipod = 188;
        P.ipod = 300;
        O.itunes = 520;
        P.itunes = 300;
        O.slim = 300;
        P.slim = 25;
        O.blackpod = 188;
        P.blackpod = 300;
        var N = SITE_PREFIX + "/podcastproxy.axd?url=" + S;
        var Q = new Array();
        Q.add('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" ');
        Q.add('width="');
        Q.add(O[U]);
        Q.add('" height="');
        Q.add(P[U]);
        Q.add('" id="wimpy4331_' + H + '">');
        Q.add('<param name="allowScriptAccess" value="always" />');
        Q.add('<param name="movie" value="' + V + 'wimpy.swf" />');
        Q.add('<param name="loop" value="false" />');
        Q.add('<param name="menu" value="false" />');
        Q.add('<param name="quality" value="high" />');
        Q.add('<param name="scale" value="noscale" />');
        Q.add('<param name="salign" value="lt" />');
        Q.add('<param name="bgcolor" value="FFFFFF" />');
        Q.add('<param name="wmode" value="transparent" />');
        Q.add('<param name="flashvars" value="wimpyReg=MmlwJTNEJTI3VmMzJTNBJTdEJTQwJTdGJTVCZCU3QiUyRkNUJTIxSDYlNUIlM0Ewd25iVTd5UEN3&wimpyApp=' + N + "&wimpySkin=" + V + "/skins/skin_" + U + '.xml&forceXMLplaylist=yes&ecomWindow=_blank" />');
        Q.add('<embed src="' + V + 'wimpy.swf" flashvars="wimpyReg=MmlwJTNEJTI3VmMzJTNBJTdEJTQwJTdGJTVCZCU3QiUyRkNUJTIxSDYlNUIlM0Ewd25iVTd5UEN3&wimpyApp=' + N + "&wimpySkin=" + V + "/skins/skin_" + U + '.xml&forceXMLplaylist=yes&ecomWindow=_blank" loop="false" menu="false" quality="high" width="' + O[U] + '" height="' + P[U] + '" scale="noscale" salign="lt" name="wimpy4331_' + H + '" align="center" bgcolor="FFFFFF" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />');
        var R = PF.$(H + "wimpy_embed");
        if (R != null) {
            R.innerHTML = Q.join("")
        } 
    } 
}
function DropDown(E, L) {
    var Q;
    var X;
    var Z;
    var A;
    var H = Array();
    var W = Array();
    var I;
    var V;
    var K;
    var Y, J;
    var P = '<div id="' + E + '_selectDiv" style="position:relative; width:220px; ">';
    P += '<div style="filter:alpha(opacity=0);-moz-opacity:0; opacity:0;"><input readonly type="text" value="" style="filter:alpha(opacity=0);-moz-opacity:0; opacity:0;padding-left:-5px;text-indent:-1000px;background-color:transparent;border:0px; width:100%; position:absolute;z-index:1000;cursor:pointer;" id="' + E + '_selector" ></input></div>';
    P += '<div id="' + E + '_selectDivSelected" class="dropdown_selected"  >&nbsp;</div><div id="' + E + 'down" class="dropdown_down" style="position:absolute; right:0px; top:1px;padding-left:5px; padding-right:5px;" >&nbsp;</div>';
    P += '<div id="' + E + '_selectDivOptions" style="position:absolute; top:20px; left:0px; width:100%; background-color:#FFF;border:#CCC 1px solid;z-index: 1px;" class="dropdown_options" >';
    P += "</div>";
    P += "</div>";
    var N = $$("div");
    N.innerHTML = P; J = $(L);
    J.appendChild(N);
    Q = $(E + "_selectDiv");
    Y = $(E + "_selector");
    Z = $(E + "_selectDivOptions");
    X = $(E + "_selectDivSelected");
    A = $(E);
    A.style.display = "none";
    Z.style.top = "20px";
    Z.style.display = "none";
    Y.onclick = function () { U() };
    Y.onkeydown = function (a) { O(a); return false };
    X.onclick = function () { R() };
    $(E + "down").onclick = function () { R() };
    I = E; V = $(E).selectedIndex;
    for (var S = 0; S < A.length; S++) {
        var M = document.createElement("div");
        M.innerHTML = '<div style="width:100%;cursor:default;">' + A.options[S].text + "</div>";
        H[S] = A.options[S].value;
        W[S] = A.options[S].text;
        M.id = I + S;
        M.className = "dropdown_option";
        M.onclick = function () {
            T(this)
        };
        M.onmouseover = function () { G(this) };
        Z.appendChild(M)
    } 
    X.innerHTML = W[V];
    function G(a) {
        if (!K) {
            K = V
        }
        D(K).className = "dropdown_hout";
        a.className = "dropdown_hover";
        K = F(a)
    }
    function T(a) {
        X.innerHTML=a.innerHTML;A.selectedIndex=F(a);K=V=F(a);U();$(I+"_selector").focus()}function F(b){var a=I.length;return b.id.substr(a)}function D(a){return $(I+a)}function U(){if(Z.style.display=="none"){Z.style.display="block";G(D(V))}else{Z.style.display="none"}}function O(a){if(a){key=a.keyCode}else{key=window.event.keyCode}if(key==40){C()}else{if(key==38){B()}else{if(key==13){T(D(K))}else{if(key==27){Z.style.display="none"}}}}}function B(){if(K>0){if(Z.style.display=="none"){var a=--K;G(D(a));T(D(a));U()}else{G(D(Number(K)-1))}}}function C(){if(K<H.length-1){if(Z.style.display=="none"){T(D(++K));U()}else{G(D(Number(K)+1))}}}function R(){$(I+"_selector").focus();U()}};
var TVListingWS=function(){TVListingWS.initializeBase(this);this._timeout=0;this._userContext=null;this._succeeded=null;this._failed=null};TVListingWS.prototype={GetMatchedAddress:function(B,C,A,D){return this._invoke(TVListingWS.get_path(),"GetMatchedAddress",true,{zip:B},C,A,D)},GetXml:function(A,C,B,D){return this._invoke(TVListingWS.get_path(),"GetXml",true,{url:A},C,B,D)},GetFeedListByZip:function(C,E,A,D,B,G){return this._invoke(TVListingWS.get_path(),"GetFeedListByZip",true,{zip:C,time:E,date:A},D,B,G)},GetFeedList:function(D,B,C,A,E){return this._invoke(TVListingWS.get_path(),"GetFeedList",false,{urlColl:D,mainUrl:B},C,A,E)}};TVListingWS.registerClass("TVListingWS",Sys.Net.WebServiceProxy);TVListingWS._staticInstance=new TVListingWS();TVListingWS.set_path=function(A){TVListingWS._staticInstance._path=A};TVListingWS.get_path=function(){return TVListingWS._staticInstance._path};TVListingWS.set_timeout=function(A){TVListingWS._staticInstance._timeout=A};TVListingWS.get_timeout=function(){return TVListingWS._staticInstance._timeout};TVListingWS.set_defaultUserContext=function(A){TVListingWS._staticInstance._userContext=A};TVListingWS.get_defaultUserContext=function(){return TVListingWS._staticInstance._userContext};TVListingWS.set_defaultSucceededCallback=function(A){TVListingWS._staticInstance._succeeded=A};TVListingWS.get_defaultSucceededCallback=function(){return TVListingWS._staticInstance._succeeded};TVListingWS.set_defaultFailedCallback=function(A){TVListingWS._staticInstance._failed=A};TVListingWS.get_defaultFailedCallback=function(){return TVListingWS._staticInstance._failed};TVListingWS.set_path(SITE_PREFIX+"flakes/tvlisting/TVListingWS.soap");TVListingWS.GetMatchedAddress=function(B,C,A,D){TVListingWS._staticInstance.GetMatchedAddress(B,C,A,D)};TVListingWS.GetXml=function(A,C,B,D){TVListingWS._staticInstance.GetXml(A,C,B,D)};TVListingWS.GetFeedListByZip=function(C,D,A,E,B,G){TVListingWS._staticInstance.GetFeedListByZip(C,D,A,E,B,G)};TVListingWS.GetFeedList=function(D,B,C,A,E){TVListingWS._staticInstance.GetFeedList(D,B,C,A,E)};function TV_LISTING(W){var C=null;var I=IMAGE_PREFIX+"flakes/tvlisting/images/";var J="http://www.meevee.com/FEEDS";var g,G,U,R,f;var E=19;var k,Y,T,H,P;var S=8;var K=null;var Q=this;var c="http://images.meevee.com/_networkLogos20/";var D=new Array();var j=2;var e="";var Z=false;var O=null;var X=false;var M=null;var A=0;var B=false;var d=null;var h="";var L="";var b="sync";var N="location";var a=false;this.zipChanged=false;this.failureCount=0;this.load=function(l){C=l;C.body.innerHTML='<div id="'+W+'blockUI" style="display: none; background-color: white;width: 100%; height: 100px; position: absolute; left: 0px; top: 0px; z-index: 50000;-moz-opacity:0.7;opacity:0.7;filter:alpha(opacity=70);" onclick="return false" onmousedown="return false" onmousemove="return false" onmouseup="return false" ondblclick="return false">&nbsp;</div><div class="tvlisting_toolbar" id="'+W+'toolbar"><span id="tvlisting_providerName'+W+'"></span><select id="'+W+'date"></select><select id="'+W+'time"></select></div><div id="'+W+'locAlert" style="text-align:center;display:none;"></div><div class="tvlisting_body" id="'+W+'body"></div>';this.prepareEditArea();Z=true;$("body"+W).className+=" flake_content_with_tab";C.setIcon(I+"icon.gif");if(!C._toggleEdit){C._toggleEdit=l.toggleEdit;C.toggleEdit=function(){if(!l.page.CanEditFlake){return}Q.populateProvidersAndChannelsOnEdit();C._toggleEdit()}}if(!C._setTitle){C._setTitle=l.setTitle;C.setTitle=function(o){C.Profiles.userTitle="1";C._setTitle(o)}}if(typeof GeoLocation!="undefined"){M=new GeoLocation($(W+"zipCode"),false,RenderMode.TABULAR,false)}Events.OnLocationChange.add(this);A=C.Profiles[b];L=C.Profiles[N];if(App.My.Country!="USA"&&App.My.Country!="US"){$(W+"locStandard").disabled=true}if(null==A){A=1;C.Profiles[b]=A}else{A=parseInt(A)}$(W+"locStandard").checked=true;var m=false;if(C.Profiles.zip!=null&&C.Profiles.zip.trim().length>0){k=C.Profiles.zip;if(A==0){$(W+"locFlake").checked=true;$(W+"zipCode").value=L}else{A=1;$(W+"locStandard").checked=true}this.generateToolbar();if(k!=App.My.ZipCode&&App.My.ZipCode.trim().length>0&&A==1&&C.page.IsOwner){this.doSync()}else{if(k==App.My.ZipCode){$(W+"locStandard").checked=true;$(W+"zipCode").value=""}else{$(W+"locFlake").checked=true;$(W+"zipCode").value=L}Y=C.Profiles.providerId;if(Y==null){m=true}P=C.Profiles.providerName;if(C.Profiles.channelInfo){D=this.StringToArray(C.Profiles.channelInfo)}if(C.Profiles.maxView){S=C.Profiles.maxView}$(W+"channelsPerPage").value=S;$(W+"provider").value=Y}}else{C.Profiles.showChannels="all";S=8;m=true;this.generateToolbar();if(App.My.ZipCode!=null&&App.My.ZipCode!=""){k=App.My.ZipCode.trim();$(W+"locStandard").checked=true;L=App.getLocationVariable();A=1;$(W+"zipCode").value=""}else{if(App.My!=null&&(App.My.Country=="USA"||App.My.Country=="US")&&App.My.City!=""&&App.My.State!=""&&(App.My.ZipCode==null||App.My.ZipCode=="")){CoreServices.GetZipCode(App.My.City,App.My.State,function(o){if(o!=""){App.My.ZipCode=o;k=App.My.ZipCode;L=App.My.City+", "+App.My.State+", "+App.My.ZipCode+", "+App.My.Country;$(W+"zipCode").value="";App.changeGlobalLocation(App.My.City,App.My.State,App.My.ZipCode,App.My.Country);Q.prepareAndRenderUI()}});return}else{if(App.My.Country!="USA"&&App.My.Country!="US"){$(W+"locStandard").disabled=true}$(W+"locFlake").checked=true;this.showLoadAlert()}}}if(k!=null&&k!=""){this.getCityName(k);e=V();H=0;if(m||!D.length){this.showTVListFromZip(k)}else{this.showTVList()}}};this.prepareEditArea=function(){var l="";if(L){l=L}else{if(App.My.Country=="USA"||App.My.Country=="US"){l="("+App.My.City+", "+App.My.State+")"}else{if(App.My.City&&App.My.Country){l="("+App.My.City+", "+App.My.Country+") [Only available for USA]"}else{l="[Only available for USA]"}}}var m="My";if(!C.page.IsOwner){m="Owner's"}C.setEditArea('<table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td style="padding-top: 5px;width:100px;" valign="top">Location:</td><td style="padding-top: 5px;"><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top" style="width:20px;"><input type="radio" name="'+W+'locOption" id="'+W+'locStandard" onclick="'+W+'.setStandardZip()" /></td><td style="padding:3px;"><label for="'+W+'locStandard">'+m+" standard location <br/>"+l+'</label></td></tr><tr><td valign="top" style="width:20px;"><input type="radio" name="'+W+'locOption" id="'+W+'locFlake" /></td><td style="padding:3px;"><label for="'+W+'locFlake">This location:</label><br/><input class="input_text" id="'+W+'zipCode" onblur="'+W+'.validateZip ()" onkeypress="if(event.keyCode==13)'+W+'.validateZip()" onfocus="'+W+'.selectFlake()" type="text" /></td></tr></table><span id="'+W+'zipError" class="tverror"></span></td></tr><tr><td style="padding-top: 5px;">TV Service Provider:</td><td style="padding-top: 5px;" id="'+W+'provider_td"><select id="'+W+'provider" style="width: 100px" disabled></select></td></tr><tr><td style="padding-top: 4px;" valign="top">Channels:</td><td style="padding-top: 4px;" id="'+W+'channels_td"><input type="radio" name="'+W+'showChannels" id="'+W+'showChannelsAll" disabled onclick="'+W+'.showChannels(\'all\')" value="all" checked="checked"/>All Channels<br/><input type="radio" name="'+W+'showChannels" id="'+W+'showChannelsSel" disabled onclick="'+W+'.showChannels(\'selected\')" value="selected"/>Selected Channels<span id="'+W+'channelError" class="tverror"></span></td></tr><tr id="'+W+'channels_tr" class="tvlisting_channels_tr" style="display: none"><td>&nbsp;</td><td><div id="'+W+'channels" class="tvlisting_channels"></div><a href="javascript:void(0)" onclick="'+W+'.selectAll()">Select all</a> | <a onclick="'+W+'.selectNone()" href="javascript:void(0)">Select none</a></td></tr><tr><td style="padding-top: 5px;">Channels per page:</td><td style="padding-top: 5px;"><select id="'+W+'channelsPerPage"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8" selected="selected">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option></select></td></tr><tr><td>&nbsp;</td><td style="padding-top: 5px;"><input type="button" class="button" value="Save" id="'+W+'saveButton" onclick="'+W+'.save()" /> <input type="button" class="button cancel" onclick="'+W+'.cancel();" value="Cancel" /></td></tr></table>')};this.selectFlake=function(){$(W+"locFlake").checked=true;$focus(W+"zipCode")};this.showLocationAlert=function(){if(B==false&&App.My.Country=="USA"&&C.page.IsOwner){var l=new Sys.StringBuilder();l.append('<div style="padding:8px;">Global location changed, do you want to sync? <a href="javascript:void(0)" onclick="javascript:'+W+'.doSync()">Yes</a> or <a href="javascript:void(0)" onclick="javascript:'+W+'.donotSync()">No</a> </div>');$(W+"locAlert").innerHTML=l.toString();$display($(W+"locAlert"));$nodisplay($(W+"body"));$(W+"date").disabled=true;$(W+"time").disabled=true;B=true}};this.showLoadAlert=function(){if(B==false){var l=new Sys.StringBuilder();l.append('<div class="tvlisting_noResult"><p>We\'re sorry, the TV Showtimes Flake doesn\'t<br/>support locations outside of the US at this time.</p><p>If you\'d still like to get the listings for a city<br/>in the US, please <a href="javascript:void(0)" onclick="'+W+'.showEdit()">click here</a></p></div>');$(W+"locAlert").innerHTML=l.toString();$display($(W+"locAlert"));$nodisplay($(W+"body"));$(W+"date").disabled=true;$(W+"time").disabled=true;B=true}};this.showEdit=function(){C._toggleEdit();$display($(W+"locAlert"));$nodisplay($(W+"body"))};this.onEvent=function(l,m){if(A==1&&C.page.IsOwner&&(App.My.Country=="US"||App.My.Country=="USA")){this.OnGlobalLocationChanged(m)}};this.OnGlobalLocationChanged=function(l){if(L!=l&&A==1){this.doSync()}};this.doSync=function(){L=App.getLocationVariable();k=App.My.ZipCode;this.prepareAndRenderUI();$(W+"locStandard").checked=true;$(W+"zipCode").value="";C.Profiles.zip=k;C.Profiles[N]=L;C.save();Z=true};this.donotSync=function(){A=0;this.prepareAndRenderUI();C.Profiles[b]=A;C.save()};this.prepareAndRenderUI=function(){$nodisplay($(W+"locAlert"));$display($(W+"body"));B=false;loadFromZipCode=true;Q.getCityName(k);e=V();H=0;Q.generateToolbar();Q.showTVListFromZip(k)};this.getCityName=function(l){if(l==null){l=94101;k=l}TVListingWS.GetMatchedAddress(l,F(this,this.getCitySuccess))};this.getCitySuccess=function(m){if(m.length>0){var l=m[0];var o=l.split(",");if(!C.Profiles.userTitle){C._setTitle("TV Listings for "+o[0])}}else{if(k==94101&&m.length==0){if(!C.Profiles.userTitle){C._setTitle("TV Listings for San Francisco")}}else{if(!C.Profiles.userTitle){C._setTitle("TV Listings")}}}};this.populateProvidersAndChannelsOnEdit=function(){if(Z==true){if(L){this.updateProvider();this.updateChannel()}if(C.Profiles.showChannels=="selected"){$(W+"showChannelsSel").checked=true;$(W+"showChannelsAll").checked=false;$(W+"showChannelsAll").disabled=false;$(W+"showChannelsSel").disabled=false;this.showChannels("sel")}else{this.showChannels("all")}if(C.Profiles.showChannels=="all"){$(W+"showChannelsAll").disabled=false;$(W+"showChannelsSel").disabled=false}Z=false}C.headerLinkSwitch();if(!$isVisible(C.editContainerId)){C.resize()}};this.Profiles=function(){return C.Profiles};this.prepareShowTvList=function(){var o="<div id="+W+"divMessage style='display: none; height:25px;background:#fff'></div>";var m="30%";o+='<div id="'+W+'listingContainer"><table border=0 cellpadding=3 cellspacing=0 class="tvlisting_table" id="'+W+'listingTable">';o+='<tr class=tvlisting_timebar><td width="10%">';if(G.selectedIndex==0&&g.selectedIndex==0){o+="&nbsp;"}else{o+='<div id="'+W+'left" class=tvlisting_left onclick="'+W+'.left()">&nbsp;</div>'}o+="</td>";n=this.get24(G.value).split(":")[0];hr=n%12;temp=(hr==0?12:hr)+":00 "+(n>=12?"PM":"AM");o+='<td width="'+m+'" class="tvlistingtime" colspan=6>'+temp+"</td>";temp=(hr==0?12:hr)+":30 "+(n>=12?"PM":"AM");o+='<td width="'+m+'" class="tvlistingtime" colspan=6>'+temp+"</td>";n=Number(n)+1;hr=n%12;temp=(hr==0?12:hr)+":00 "+(n>=12&&n<24?"PM":"AM");o+='<td width="'+m+'" style="border-right:1px solid #ccc;" colspan=6 class="tvlistingtime">';if(G.selectedIndex==G.length-1&&g.selectedIndex==g.length-1){o+="<span>"+temp+"</span></td>"}else{o+='<div id="'+W+'right" class=tvlisting_right onclick="'+W+'.right()">&nbsp;</div><span>'+temp+"</span></td>"}o+="</tr>";if(startIndex>0&&D.length>S){o+='<tr id="'+W+'up" class=tvlisting_channelbar_up onclick="'+W+'.up()"><td colspan='+E+">&nbsp;</td></tr>";$delayCall(this.setTooltipUp)}o+="</table></div>";if(startIndex<D.length-S&&D.length>S){o+='<div id="'+W+'down" class=tvlisting_channelbar_down onclick="'+W+'.down()">&nbsp;</div>';$delayCall(this.setTooltipDown)}$(W+"body").innerHTML=o;var l=$(W+"listingTable");if(G.selectedIndex<G.length-1){TooltipManager.setTooltip($(W+"right"),"Show next time range")}if(G.selectedIndex>0){TooltipManager.setTooltip($(W+"left"),"Show previous time range")}};this.setTooltipUp=function(){TooltipManager.setTooltip($(W+"up"),"Scroll up channel list")};this.setTooltipDown=function(){TooltipManager.setTooltip($(W+"down"),"Scroll down channel list")};this.manualName=function(m){var o=m.split("-");var l=o[0].split(" ");if(l.length>2){return l.slice(0,2).join(" ")}else{return o[0]}};this.changeProvider=function(){this.populateProvidersAndChannelsOnEdit();C._toggleEdit()};this.renderTvList=function(Ak){var As=$(W+"time").value?this.get24($(W+"time").value).split(":")[0]:dt.getHours();As*=60;if(P){var Ai=this.manualName(P);if(C.page.IsOwner){Ai+=' (<a href="javascript:void(0)" style="color:white;text-decoration:underline;" onclick="'+W+'.changeProvider()">change</a>)'}$("tvlisting_providerName"+W).innerHTML=Ai}var Af=$(W+"blockUI");if(typeof($(W+"listingContainer"))=="object"){this.prepareShowTvList();_table=$(W+"listingContainer");$nodisplay(Af)}var Ap=new Date();var y=Ap.getTime();var Aj;var s=new Array();var Ag=new Sys.StringBuilder();var Ar=_table.innerHTML;Ag.append(Ar);Ag.append("<table border='0' class='tvlisting_table' cellpadding='3' cellspacing='0'><tbody>");for(Aj=0;Aj<Ak.length;Aj++){result=Ak[Aj];if(result){var Ae=this.getParam(result[1],"name");var o=Number(this.getParam(result[1],"logoId"));var x=result[0];var Ah;Ag.append('<tr><td class="tvlistingLogo">');var Aa=18;if(o>0){Ag.append('<img alt="'+Ae+'" title="'+Ae+'" src="'+c+o+'_sm.gif" />')}else{Ag.append(Ae)}Ag.append("</td>");for(Ah=0;Ah<x.length;Ah++){var Au=x[Ah][0];var Al=Au.split("-").length;var Ac=this.get24(Au.split("-")[Al-2]);var q=this.get24(Au.split("-")[Al-1]);var Aq=Ac.split(":")[0]*60+Number(Ac.split(":")[1]);var m=q.split(":")[0]*60+Number(q.split(":")[1]);if(m<Aq){m+=24*60}if(m>As&&Aq<As+90){var At=Au.split("-").slice(0,-2).join("-");var w=Aq<As?As:Aq;var u=m>As+90?As+90:m;if(u-w>0){var Ab="";var Ao=(u-w)/5;var r=(u-w)+"%";if(Aa==18&&Aq>As){var t=(Aq-As)/5;Aa-=t;var An=(Aq-As)+"%";Ag.append('<td colspan="'+t+'" width="'+An+'">&nbsp;</td>')}Aa-=Ao;if(x[Ah].length==4){var Am=x[Ah][1];Ab=x[Ah][2]}else{var Am="";Ab=x[Ah][1]}Ag.append('<td id="TVprog_'+Aj+"_"+Ah+'" colspan="'+Ao+'" width="'+r+'" class="tvlisting_programcell" onclick="'+W+".tdOnClick('"+Ab+"')\"><div class=tvlisting_title>"+At+"</div></td>");var z=new Array();z.push("TVprog_"+Aj+"_"+Ah);z.push("<b>"+x[Ah][0]+"</b><br/>"+Am);s.push(z)}}}if(Aa>0){var Ao=Aa;Ag.append('<td colspan="'+Ao+'">');if(Aa==18){Ag.append("No program found")}else{Ag.append("&nbsp;")}Ag.append("</td>")}Ag.append("</tr>")}}Ag.append("</tbody></table>");_table.innerHTML=Ag.toString();for(var Ad=0;Ad<s.length;Ad++){if($(s[Ad][0])){TooltipManager.setTooltip($(s[Ad][0]),s[Ad][1])}}if(_table){var l=document.createElement("tr");_table.firstChild.appendChild(l)}var Ap=new Date();var v=Ap.getTime();$nodisplay($(W+"divMessage"));X=false;g.disabled=false;G.disabled=false};this.tdOnClick=function(l){window.open("http://"+l.replace("mpp","www.meevee.com/program/programDetails.aspx"))};this.showTVListFromZip=function(m){X=true;g.disabled=true;G.disabled=true;startIndex=H;var o=new Date();var l=$(W+"date").value?$(W+"date").value:(o.getMonth()+1)+"/"+o.getDate()+"/"+o.getFullYear();$(W+"body").innerHTML="<div id="+W+"divMessage style='display: none; height:25px;background:#fff'></div>";$(W+"divMessage").innerHTML="Loading programs...<img src='images/indicator.gif' />";$display($(W+"divMessage"));TVListingWS.GetFeedListByZip(m,G.value,l,F(this,this.getByZipSuccess),F(this,this.getByZipFailure))};this.getByZipFailure=function(l){if(this.canRetry()){this.showTVListFromZip(k)}};this.canRetry=function(){this.failureCount++;if(this.failureCount>1){$(W+"divMessage").innerHTML="Failed to download TV Programs";return false}return true};this.getByZipTimeout=function(l){if(this.canRetry()){this.showTVListFromZip(k)}};this.getByZipSuccess=function(l){Y=l[2];P=l[3];D=l[1];this.prepareShowTvList();this.renderTvList(l[0])};this.showTVList=function(){X=true;g.disabled=true;G.disabled=true;startIndex=H;var y=$(W+"listingTable");var l;var o;if(y){o=$(W+"blockUI");var w=PU.getPosition($(W+"body"));o.style.width=w[2]+"px";o.style.height=w[3]+"px";o.style.left=w[0]+"px";o.style.top=w[1]+"px";var t=$(W+"divMessage");t.style.position="absolute";t.style.left=(w[0]+(w[2]-130)/2)+"px";t.style.top=(w[1]+(w[3]-40)/2)+"px";t.style.width="120px";t.style.padding="10px";t.style.zIndex="50001";t.style.border="1px solid #ccc";$display(o)}else{this.prepareShowTvList();l=$(W+"listingTable")}var m=new Date();var p=$(W+"date").value?$(W+"date").value:(m.getMonth()+1)+"/"+m.getDate()+"/"+m.getFullYear();url=J+"/LISTINGS.ASPX?UID=MAXX&PWD=BINGO&TEMPLATE_NAME=T2&TIME_MODE=1&START_DATE="+p+"&PROVIDERID="+Y+"&ZIPCODE="+k+"&";var u=0;var x;var s=Number(startIndex)+Number(S)>D.length?D.length:Number(startIndex)+Number(S);var v=new Array();var q=0;for(var r=startIndex;r<s;r++){_name=D[r][2];v[q++]="STATION_NUMBER="+D[r][0]+"&name="+_name+"&logoId="+D[r][1]+"&startTime="+G.value}if(v.length>0){$(W+"divMessage").innerHTML="Loading programs...<img src='images/indicator.gif' />";$display($(W+"divMessage"));TVListingWS.GetFeedList(v.join(","),url,F(this,this.getFeedListSuccess),F(this,this.getFeedListFailure))}else{}};this.getFeedListFailure=function(l){$(W+"divMessage").innerHTML=l.get_message()+" - exception";X=false;g.disabled=false;G.disabled=false};this.getFeedListTimeout=function(r){var l=r.get_stackTrace();var q=r.get_message();var o=r.get_statusCode();var p=r.get_exceptionType();var m=r.get_timedOut();$(W+"divMessage").innerHTML=r+" - timeout";X=false;g.disabled=false;G.disabled=false};this.getFeedListSuccess=function(l){this.renderTvList(l)};this.feeds=function(p){var o=PU.getXmlDoc(p);o=o.firstChild.nextSibling.firstChild.nextSibling.childNodes;var l=new Array();if(o.length>3){for(i=3;i<o.length;i++){var m=new Array();m.Title=o[i].firstChild.text;l[i-3]=m}}return l};this.left=function(){if(X==false){if(G.selectedIndex>0){TooltipManager.unset($(W+"left"),true);G.selectedIndex--;this.showTVList()}else{TooltipManager.unset($(W+"left"),true);g.selectedIndex--;G.selectedIndex=G.length-1;this.showTVList()}}};this.right=function(){if(X==false){if(G.selectedIndex<G.length-1){TooltipManager.unset($(W+"right"),true);G.selectedIndex++;this.showTVList()}else{TooltipManager.unset($(W+"right"),true);g.selectedIndex++;G.selectedIndex=0;this.showTVList()}}};this.down=function(){if(X==true){return}TooltipManager.unset($(W+"down"),true);H=Number(H)+Number(S);this.showTVList()};this.up=function(){if(X==true){return}TooltipManager.unset($(W+"up"),true);H=Number(H)-Number(S);this.showTVList()};this.getParam=function(o,p){var m=o.split("&");for(i=0;i<m.length;i++){var l=m[i].split("=");if(l[0]==p){return l[1]}}return false};this.get24=function(p){p=p.toUpperCase();if(p.indexOf("AM")>0||p.indexOf("PM")>0){var o=p.split(" ");var m=o[0].split(":")[0];var l=o[0].split(":")[1];if(o[1]=="PM"&&m!=12){m=Number(m)+12}else{if(o[1]=="AM"&&m==12){m=0}}l=Math.round(l/5)*5;return m+":"+l}else{return""}};this.isZip=function(o){_zipInput=$(W+"zipCode");L=_zipInput.value;var m=L.split(",");if(m.length==1&&$trim(m[0]).length==5){k=$trim(m[0])}else{k=$trim(m[m.length-2])}var l=/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/;if(!l.test(k)&&k.length!=5&&$(W+"locFlake").checked){if($trim(L.split(",")[2])=="USA"||$trim(L.split(",")[2])=="US"){return CoreServices.GetZipCode($trim(L.split(",")[0]),$trim(L.split(",")[1]),F(this,this.getZipSuccess),F(this,this.getZipFailure))}else{$(W+"zipError").innerHTML="&nbsp;Please enter a valid US zip code/location";$(W+"saveButton").disabled=true;if(W+"provider"){$(W+"provider").disabled=true}return false}}else{$(W+"zipError").innerHTML=""}if(k.length==5){if($(W+"provider")){$(W+"provider").disabled=false;$(W+"zipError").innerHTML=""}return true}else{$(W+"provider").disabled=true;$(W+"showChannelsAll").disabled=true;$(W+"showChannelsSel").disabled=true;$nodisplay($(W+"channels_tr"));if(o){$(W+"zipError").innerHTML="&nbsp;Please enter a valid US zip code/location";$(W+"saveButton").disabled=true}return false}};this.getZipSuccess=function(l){if(l){k=l;if($(W+"provider")){$(W+"provider").disabled=false;$(W+"zipError").innerHTML=""}this.updateProvider();return true}else{this.getZipFailure()}};this.getZipFailure=function(){$(W+"provider").disabled=true;$(W+"showChannelsAll").disabled=true;$(W+"showChannelsSel").disabled=true;$nodisplay($(W+"channels_tr"));return false};this.setStandardZip=function(){k=App.My.ZipCode;this.zipChanged=true;if($(W+"showChannelsAll")){$(W+"showChannelsAll").checked=true}$(W+"zipError").innerHTML="";this.updateProvider()};this.validateZip=function(){this.zipChanged=true;if($(W+"showChannelsAll")){$(W+"showChannelsAll").checked=true}if(this.isZip()){this.updateProvider()}};this.updateProvider=function(){_proTd=$(W+"provider_td");_proTd.innerHTML="Loading ...";url=J+"/PROVIDERS.ASPX?ZIPCODE="+k;TVListingWS.GetXml(url,F(this,this.getProviderXmlSuccess),F(this,this.getXmlFailure))};this.getXmlFailure=function(l){};this.getProviderXmlSuccess=function(l){xml=PU.getXmlDoc(l[0]);_providers=xml.documentElement.firstChild.childNodes;var m=new Array("ID","Name");_proTd.innerHTML=this.createSelect(_providers,"ID","Name","id="+W+'provider onchange="'+W+'.updateChannel()" class=tvlisting_provider')+'<span id="'+W+'providerError" class=tverror></span>';this.updateChannel();if(_providers.length<1){$(W+"zipError").innerHTML="&nbsp;No provider found";$(W+"zipCode").wrongZip=true;$(W+"saveButton").disabled=true;$(W+"showChannelsAll").disabled=true;$(W+"showChannelsSel").disabled=true;$(W+"provider").disabled=true}else{$(W+"provider").disabled=false;$(W+"saveButton").disabled=false}};this.showChannels=function(l){if(l!="all"){$(W+"channels_tr").style.display=""}else{$nodisplay($(W+"channels_tr"))}};this.updateChannel=function(){if(typeof($(W+"providerError"))=="object"&&$(W+"providerError")!=null){$(W+"providerError").innerHTML=""}Station_Num=0;_chaDiv=$(W+"channels");_chaDiv.innerHTML="Loading ...";var l=$(W+"provider");if($(W+"provider")!==null){Y=$(W+"provider").value;$(W+"showChannelsAll").disabled=false;$(W+"showChannelsSel").disabled=false}else{}url=J+"/channels.ASPX?PROVIDERID="+Y;TVListingWS.GetXml(url,F(this,this.getChannelXmlSuccess),F(this,this.getXmlFailure))};this.getChannelXmlSuccess=function(l){xml=PU.getXmlDoc(l[0]);K=xml.documentElement.childNodes;str="";var o="";for(i=0;i<K.length;i++){var m=this.channelName(K[i]);if(o==m){continue}o=m;str+='<div><input type="checkbox" '+this.checkProfile(K[i].attributes[Station_Num].nodeValue)+' id="'+W+"channel_"+i+'" value="'+K[i].attributes[Station_Num].nodeValue+'">'+m+"</div>"}_chaDiv.innerHTML=str};this.checkProfile=function(l){if(e.indexOf(l)>=0&&Y==C.Profiles.providerId&&k==C.Profiles.zip){return"checked"}else{return""}};this.save=function(){if($(W+"locFlake").checked){if($(W+"provider").disabled==true){$(W+"providerError").innerHTML="<br/>Please select a service provider";return}else{C.Profiles[b]=A=0;C.Profiles[N]=L=$(W+"zipCode").value}}else{if(App.My.Country=="USA"||App.My.Country=="US"){k=App.My.ZipCode;$(W+"provider").disabled=false;$(W+"zipCode").value="";C.Profiles[b]=A=1;C.Profiles[N]=App.My.City+", "+App.My.State}else{$(W+"zipError").innerHTML="&nbsp;Please enter a valid US zip code";$(W+"locFlake").checked=true}}if($(W+"showChannelsAll").checked){C.Profiles.showChannels="all"}else{C.Profiles.showChannels="selected"}D=new Array();var m=0;var o=0;var l="";var q="";if(K){for(o=0;o<K.length;o++){if(q==this.channelName(K[o])){continue}q=this.channelName(K[o]);if(this.checked($(W+"channel_"+o))==true||$(W+"showChannelsAll").checked){var s=new Array();s[0]=K[o].attributes[0].nodeValue;s[1]=K[o].attributes[4].nodeValue;s[2]=this.channelName(K[o]);D[m++]=s}}}if(D.length>0){C.Profiles.channelInfo=this.ArrayToString(D);C.Profiles.zip=k;var r=$(W+"provider");C.Profiles.providerId=Y;C.Profiles.providerName=P=r.options[r.selectedIndex].text;C.Profiles.maxView=S=$(W+"channelsPerPage").value;C.save();C._toggleEdit();e=V();H=0;this.getCityName(k);this.showTVList();B=false;$nodisplay($(W+"locAlert"));$display($(W+"body"))}else{$(W+"channelError").innerHTML="<br/>Please select at least one channel.";setTimeout(this.errTimeout,3000)}};this.errTimeout=function(){$(W+"channelError").innerHTML=""};this.checked=function(l){if(l){return l.checked}else{return false}};this.selectAll=function(){for(i=0;i<K.length;i++){if($(W+"channel_"+i)){$(W+"channel_"+i).checked=true}}};this.selectNone=function(){for(i=0;i<K.length;i++){if($(W+"channel_"+i)){$(W+"channel_"+i).checked=false}}};this.ArrayToString=function(l){var m,o;o="";for(m=0;m<l.length;m++){o+="$$"+l[m].join("#")}o=o.substr(2);return o};this.StringToArray=function(p){var m=new Array();var o=0;m=p.split("$$");var l=new Array();for(o=0;o<m.length;o++){l[o]=m[o].split("#")}return l};this.cancel=function(){C._toggleEdit()};this.channelName=function(l){Channel_Network=3;Call_Sign=1;var m=l.attributes[Channel_Network].nodeValue;return m!=""?m:l.attributes[Call_Sign].nodeValue};this.createSelect=function(p,m,o,l){m=0;o=1;str="<select "+l+">";for(i=0;i<p.length;i++){var r=p[i].attributes[o].value;var q=p[i].attributes[m].value;if(q==Y){str+="<option selected value="+q+">"+r+"</option>";if(typeof($(W+"showChannelsAll"))=="object"){$(W+"showChannelsAll").disabled=false;$(W+"showChannelsSel").disabled=false}}else{str+="<option value="+q+">"+r+"</option>"}}str+="</select>";return str};this.generateToolbar=function(){var l=$(W+"toolbar");var m,q;var p=new Date();var s=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat");m='<select id="'+W+'date" onchange="'+W+'.showTVList()">';var r=-1;while(++r<10){var o=new Date(p.getTime()+r*3600*24*1000);m+='<option value="'+(o.getMonth()+1)+"/"+o.getDate()+"/"+o.getFullYear()+'">'+s[o.getDay()]+" "+o.getDate()+"/"+(Number(o.getMonth())+1)+"</option>"}m+="</select>&nbsp;";R=p.getDate();q='<select id="'+W+'time" onchange="'+W+'.showTVList()">';var r=-1;while(++r<24){hr=r%12;temp=(hr==0?12:hr)+":00 "+(r>=12?"PM":"AM");q+='<option value="'+temp+'" '+(r==p.getHours()?"selected":"")+">"+temp+"</option>"}q+="</select>";f=p.getHours();l.innerHTML='<span id="tvlisting_providerName'+W+'" class="tvlisting_providerName"></span>';l.innerHTML+=m;l.innerHTML+=q;g=$(W+"date");G=$(W+"time")};function V(){var l="";for(var m=0;m<D.length;m++){l=l+D[m][0]+","}l=l.substr(0,l.length-1);return l}};
var MovieListingService=function(){MovieListingService.initializeBase(this);this._timeout=0;this._userContext=null;this._succeeded=null;this._failed=null};MovieListingService.prototype={GetMatchedAddress:function(B,C,A,D){return this._invoke(MovieListingService.get_path(),"GetMatchedAddress",true,{zip:B},C,A,D)},GetMoviesByDate:function(C,A,H,D,G,E,B,I){return this._invoke(MovieListingService.get_path(),"GetMoviesByDate",true,{zip:C,day:A,month:H,yr:D,flakeId:G},E,B,I)},GetTheaterByMovieDate:function(A,G,C,I,D,B,J,H,E){return this._invoke(MovieListingService.get_path(),"GetTheaterByMovieDate",true,{zip:A,day:G,month:C,yr:I,movieNm:D,flakeId:B},J,H,E)},GetTheaters:function(C,A,H,D,G,E,B,I){return this._invoke(MovieListingService.get_path(),"GetTheaters",true,{zip:C,day:A,month:H,yr:D,flakeId:G},E,B,I)},GetTheaterMovies:function(A,G,D,I,B,C,J,H,E){return this._invoke(MovieListingService.get_path(),"GetTheaterMovies",true,{zip:A,day:G,month:D,yr:I,theaterCode:B,flakeId:C},J,H,E)}};MovieListingService.registerClass("MovieListingService",Sys.Net.WebServiceProxy);MovieListingService._staticInstance=new MovieListingService();MovieListingService.set_path=function(A){MovieListingService._staticInstance._path=A};MovieListingService.get_path=function(){return MovieListingService._staticInstance._path};MovieListingService.set_timeout=function(A){MovieListingService._staticInstance._timeout=A};MovieListingService.get_timeout=function(){return MovieListingService._staticInstance._timeout};MovieListingService.set_defaultUserContext=function(A){MovieListingService._staticInstance._userContext=A};MovieListingService.get_defaultUserContext=function(){return MovieListingService._staticInstance._userContext};MovieListingService.set_defaultSucceededCallback=function(A){MovieListingService._staticInstance._succeeded=A};MovieListingService.get_defaultSucceededCallback=function(){return MovieListingService._staticInstance._succeeded};MovieListingService.set_defaultFailedCallback=function(A){MovieListingService._staticInstance._failed=A};MovieListingService.get_defaultFailedCallback=function(){return MovieListingService._staticInstance._failed};MovieListingService.set_path("/flakes/movielisting/movielistingservice.soap");MovieListingService.GetMatchedAddress=function(B,C,A,D){MovieListingService._staticInstance.GetMatchedAddress(B,C,A,D)};MovieListingService.GetMoviesByDate=function(C,A,G,D,E,H,B,I){MovieListingService._staticInstance.GetMoviesByDate(C,A,G,D,E,H,B,I)};MovieListingService.GetTheaterByMovieDate=function(A,I,D,J,E,B,H,C,G){MovieListingService._staticInstance.GetTheaterByMovieDate(A,I,D,J,E,B,H,C,G)};MovieListingService.GetTheaters=function(C,A,G,D,E,H,B,I){MovieListingService._staticInstance.GetTheaters(C,A,G,D,E,H,B,I)};MovieListingService.GetTheaterMovies=function(A,I,E,J,B,C,H,D,G){MovieListingService._staticInstance.GetTheaterMovies(A,I,E,J,B,C,H,D,G)};function MovieList(d){var L=null;var M="";var c=null;var X=null;var n=null;var O=null;var j=new Array();var o=0;var q=new Array();var E=0;var D=new Array();var I=0;var H=this;var S=1;var B="";var V=1;var W="";var b="";var e="";var T="";var Z="";var A="";var k=1;var m=1;var Q=1;var N=1;var K=1;var R="";var P=0;var a=null;var f=null;var J=null;var G="";var p=false;var l=null;var U=false;var Y="sync";var h="location";var g='<span id="'+d+'lnkAllMovie" class="ML_lnkTopInact" onclick="'+d+'.showMovies()">All movies</span> | <span id="'+d+'lnkByTheater" class="ML_lnkTopAct" onclick="'+d+'.showTheaters()">View by theater</span>';var C={VIEW_MOVIES:"movies",VIEW_THEATERS:"theaters",VIEW_MOVIE_SHOW:"movieshow",VIEW_THEATER_SHOW:"theatershow"};this.load=function(s){L=s;L.setIcon(window.IMAGE_PREFIX+"flakes/movielisting/movie.gif");L.body.style.padding="0px";var r='Please enter your ZIP code and try again:<br /><input id="'+d+'zipOnly" type="text" style="width:100px;" onclick="if(event.keyCode==13) '+d+'.saveSettings(1);" /> <input class="button" type="button" onclick="'+d+'.saveSettings(1)" value="Submit" />';if(!L.page.IsOwner){r=""}var u=window.IMAGE_PREFIX;L.body.innerHTML='<div id="'+d+'content" class="ML_contentArea"><div id="'+d+'selectionArea" class="ML_selectArea"><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td><div id="'+d+'topLnk"><span id="'+d+'lnkAllMovie" class="ML_lnkTopInact" onclick="'+d+'.showMovies()">All movies</span> | <span id="'+d+'lnkByTheater" class="ML_lnkTopAct" onclick="'+d+'.showTheaters()">View by theater</span></div></td><td align="right" id="'+d+'daySelectTD"></td></tr></table></div><div id="'+d+'loader" class="downloadInProgress" style="padding:10px 0 10px;">&nbsp;</div><div id="'+d+'infoCont"><div id="'+d+'viewTbl"></div><div id="'+d+'detailView" class="ML_detailArea" style="display:none;"></div><div id="'+d+'paging"><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td style="width:50%" id="'+d+'prev" align="right"></td><td style="width:50%" align="left" id="'+d+'next"></td></tr></table></div></div></div><div id="'+d+'noLocation" class="ML_noResult"><p>We\'re sorry, the Movie Showtimes Flake doesn\'t<br/>support locations outside of the US at this time.</p><p>If you\'d still like to get the listings for a<br/>city in the US, please enter it here:</p><table width="100%"><tr><td align="center"><input id="'+d+'nonUsInput" type="text" onkeypress="if(event.keyCode==13) '+d+'.checkEntry(2);" style="float:right;clear:right" /></td></tr><tr><td class="ML_error" style="align:center;" id="'+d+'nonUsError"></td></tr><tr><td align="center"><input value="Submit" class="button" type="button" onclick="'+d+'.checkEntry(2)" /></td></tr></table></div><div class="ML_noResult" id="'+d+'noResult" style="display:none;"><div class="ML_error" id="'+d+"noResError\"></div>We didn't find any movie listings for your location.<br />"+r+'</div><div class="ML_footer"><table width="100%" style="margin-top:8px;"><tr><td align="right" style="color:#666666;font-size:7pt;padding-right:6px;">In partnership with</td><td style="width:104px;padding-right:0 2px 0 2px;"><img src="'+u+'flakes/movielisting/MovieWebLogo.gif" alt="movieweb.com" title="movieweb.com" /></td></tr></table></div>';this.prepEditArea();this.createDay();if(typeof GeoLocation!="undefined"){a=new GeoLocation($(d+"zip"),false,RenderMode.TABULAR,false)}Events.OnLocationChange.add(this);J=L.Profiles[Y];G=L.Profiles[h];$nodisplay($(d+"noLocation"));if(App.My.Country!="USA"&&App.My.Country!="US"){$(d+"locStandard").disabled=true}if(null==J){J=0;L.Profiles[Y]=J}$nodisplay($(d+"paging"));$nodisplay($(d+"infoCont"));$(d+"locStandard").checked=true;if(L.Profiles.userZip&&L.Profiles.userZip.trim().length>0){M=L.Profiles.userZip;if(J==1&&(App.My.Country=="USA"||App.My.Country=="US")){$(d+"locStandard").checked=true}else{$(d+"locFlake").checked=true;J=0}if(M!=App.My.ZipCode&&J==1&&L.page.IsOwner&&(App.My.Country=="USA"||App.My.Country=="US")){this.doSync()}else{var t=new Date();this.showAllMovies(t);if(M!=App.My.ZipCode){$(d+"zip").value=G;$(d+"locFlake").checked=true}this.getCityName(M)}}else{if(App.My!=null&&App.My.ZipCode!=""){L.Profiles.userZip=App.My.ZipCode;M=L.Profiles.userZip;var t=new Date();this.showAllMovies(t);$(d+"locStandard").checked=true;L.Profiles[Y]=J=1;this.getCityName(L.Profiles.userZip)}else{if(App.My!=null&&(App.My.Country=="USA"||App.My.Country=="US")&&App.My.City!=""&&App.My.State!=""&&(App.My.ZipCode==null||App.My.ZipCode=="")){CoreServices.GetZipCode(App.My.City,App.My.State,function(v){if(v!=""){App.My.ZipCode=v;App.changeGlobalLocation(App.My.City,App.My.State,App.My.ZipCode,App.My.Country);H.doSync()}});return}else{if(App.My.Country!="USA"&&App.My.Country!="US"){$(d+"locStandard").disabled=true}$(d+"locFlake").checked=true;$display($(d+"noLocation"));if(typeof GeoLocation!="undefined"){f=new GeoLocation($(d+"nonUsInput"),false,RenderMode.TABULAR,false)}$nodisplay($(d+"content"));$nodisplay($(d+"loader"));L.setTitle("Movie Showtimes")}}}};this.prepEditArea=function(s){var r="";if(G&&!s){r=G}else{if(App.My.Country=="USA"||App.My.Country=="US"){r="("+App.My.City+", "+App.My.State+")"}else{if(App.My.City&&App.My.Country){r="("+App.My.City+", "+App.My.Country+") [Only available for USA]"}else{r="[Only available for USA]"}}}var t="My";if(!L.page.IsOwner){t="Owner's"}L.setEditArea('<table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td style="width:80px"></td><td id="'+d+'editErr" class="ML_error"></td></tr><tr><td style="width:80px;padding-top:5px;" align="right" valign="top">Location: </td><td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top" style="width:20px;"><input type="radio" name="'+d+'locOption" id="'+d+'locStandard" /></td><td style="padding:3px;"><label for="'+d+'locStandard">'+t+" standard location <br/>"+r+'</label></td></tr><tr><td valign="top" style="width:20px;"><input type="radio" name="'+d+'locOption" id="'+d+'locFlake" /></td><td style="padding:3px;"><label for="'+d+'locFlake">This location:</label><br/><input type="text" id="'+d+'zip" onfocus="'+d+'.selectFlake()" onkeypress="'+d+'.checkZip(event)" /></td></tr></table></td><td></td></tr><tr><td style="width:80px">&nbsp;</td><td><input type="button" id="'+d+'save" value="Save" onclick="'+d+'.saveSettings()" class="button" /> <input type="button" id="'+d+'cancel" value="Cancel" class="button cancel" onclick="'+d+'.cancelSettings()" /></td></tr></table>');if(s){setTimeout(this.syncEditArea,1000)}};this.syncEditArea=function(){if(typeof GeoLocation!="undefined"){a=new GeoLocation($(d+"zip"),false,RenderMode.TABULAR,false)}Events.OnLocationChange.add(this);var r=App.getLocationVariable();if(r!=G){$(d+"locFlake").checked=true;$(d+"zip").value=G}else{$(d+"locStandard").checked=true}};this.selectFlake=function(){$(d+"locFlake").checked=true;$focus(d+"zip")};this.showLocationAlert=function(){if(p==false&&(App.My.Country=="USA"||App.My.Country=="US")&&L.page.IsOwner){var r=new Sys.StringBuilder();$nodisplay($(d+"loader"));$display($(d+"infoCont"));r.append('<div id="'+d+'location" ><table style="width:100%"><tr><td style="text-align:center;"><span>Global location changed, do you want to sync? <a href="javascript:void(0)" onclick="javascript:'+d+'.doSync()">Yes</a> or <a href="javascript:void(0)" onclick="javascript:'+d+'.donotSync()">No</a> </span></td></tr></table></div>');$(d+"viewTbl").innerHTML=r.toString();$nodisplay($(d+"paging"));isDisplayAlert=true}};this.onEvent=function(r,s){this.prepEditArea(1);if(J=="1"&&L.page.IsOwner){this.OnGlobalLocationChanged(s)}};this.OnGlobalLocationChanged=function(r){if(G!=r&&J==1){this.doSync()}};this.doSync=function(){G=App.getLocationVariable();M=App.My.ZipCode;$(d+"zip").value="";$(d+"viewTbl").innerHTML="";$(d+"locStandard").checked=true;p=false;U=true;$(d+"topLnk").innerHTML=g;$nodisplay($(d+"noLocation"));$nodisplay($(d+"noResult"));K=0;$(d+"daySelect").disabled="disabled";H.showMovies();H.getCityName(M);H.prepEditArea();$(d+"locStandard").checked=true;L.Profiles.userZip=M;L.Profiles[h]=G;L.save()};this.donotSync=function(){J=0;$(d+"viewTbl").innerHTML="";p=false;var r=new Date();this.showAllMovies(r);this.getCityName(M);L.Profiles[Y]=J;L.save()};this.getCityName=function(r){if(r!=null){MovieListingService.GetMatchedAddress(r,F(this,this.getCitySuccess),F(this,this.getCityFailure))}};this.getCityFailure=function(r){L.setTitle("Movie Showtimes")};this.getCitySuccess=function(s){if(s.length>0){var r=s[0];var t=r.split(",");if(t[0]!="'s-graveland"){L.setTitle("Movie Showtimes in "+t[0]);G=r;if(t[0]!=App.My.City){$(d+"zip").value=G}}else{L.setTitle("Movie Showtimes")}}else{L.setTitle("Movie Showtimes near "+M)}};this.initVars=function(){M="";c=null;X=null;n=null;O=null;j=new Array();o=0;q=new Array();E=0;D=new Array();I=0;S=1;B="";V=1;W="";b="";e="";T="";Z="";A="";k=1;m=1;Q=1;N=1;l=null;R="";P=0};this.checkZip=function(r){if(r.keyCode==13){this.saveSettings()}};this.showEdit=function(){L.toggleEdit();$display($(d+"noLocation"));if(typeof GeoLocation!="undefined"){f=new GeoLocation($(d+"nonUsInput"),false,RenderMode.TABULAR,false)}$nodisplay($(d+"infoCont"))};this.createDay=function(){var r=new Sys.StringBuilder();var s=new Date();l=s;r.append('<select id="'+d+'daySelect" onchange="'+d+'.viewDay()" class="ML_selectBox">');r.append('<option value="'+s+'">');r.append("Today, ");r.append((s.getMonth()+1)+"/"+s.getDate());r.append("</option>");s.setDate(s.getDate()+1);r.append('<option value="'+s+'">');r.append("Tomorrow, ");r.append((s.getMonth()+1)+"/"+s.getDate());r.append("</option>");for(i=1;i<=2;i++){s.setDate(s.getDate()+1);r.append('<option value="'+s+'">');r.append((s.getMonth()+1)+"/"+s.getDate());r.append("</option>")}r.append("</select>");$(d+"daySelectTD").innerHTML=r.toString()};this.viewDay=function(){if(B==C.VIEW_MOVIES){this.showAllMovies(new Date($(d+"daySelect").value))}else{if(B==C.VIEW_MOVIE_SHOW){this.showTheater(e)}else{if(B==C.VIEW_THEATER_SHOW){this.showMovieTheater(b)}}}};this.checkEntry=function(s){f.forceEnter();f.parseLocation();G=$(d+"nonUsInput").value;var r=G.split(", ");$(d+"nonUsError").innerHTML="";if(r[r.length-1]=="USA"||r[r.length-1]=="US"){this.saveSettings(s)}else{$(d+"nonUsError").innerHTML="Allowed US location only"}};this.saveSettings=function(v){var u="";if(!v){a.forceEnter();a.parseLocation();u=$(d+"zip").value;G=u;var s=$(d+"editErr");var t=$trim(G.split(",")[2])}else{if(v==1){var t=$(d+"zipOnly").value;$(d+"locFlake").checked=true;u=G;K=1;J=0}else{if(v==2){f.forceEnter();f.parseLocation();G=$(d+"nonUsInput").value;var s=$(d+"editErr");var t=$trim(G.split(",")[2]);L.toggleEdit()}}}if($(d+"locFlake").checked){var r=/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/;if(!r.test(t)||t.length!=5&&$(d+"locFlake").checked){if($trim(G.split(",")[2])=="USA"||$trim(G.split(",")[2])=="US"){CoreServices.GetZipCode($trim(G.split(",")[0]),$trim(G.split(",")[1]),F(this,this.getZipSuccess),F(this,this.getZipFailure))}else{if(!v){s.innerHTML="We're sorry, this Flake doesn't support locations outside of US at this time."}else{$(d+"noResError").innerHTML="Please enter a valid US ZIP code"}K=0}}else{this.setZipCode(t)}}else{if(App.My.Country=="USA"||App.My.Country=="US"){if(App.My.ZipCode){t=App.My.ZipCode;this.setZipCode(t)}else{CoreServices.GetZipCode(App.My.City,App.My.State,F(this,this.getZipSuccess),F(this,this.getZipFailure))}$(d+"zip").value=""}else{$(d+"locFlake").checked=true;$(d+"zip").focus();$(d+"noResError").innerHTML="Please insert a valid US location";K=0;return}}};this.getZipSuccess=function(r){if(r){this.setZipCode(r)}else{this.getZipFailure()}};this.getZipFailure=function(){$(d+"locFlake").checked=true;$(d+"zip").focus();$(d+"editErr").innerHTML="Please insert a valid US Location/Zip code";L.setTitle("Movie Showtimes")};this.setZipCode=function(r){$(d+"editErr").innerHTML="";if(L.Profiles.userZip!=r){this.initVars();L.Profiles.userZip=r;M=r;if($(d+"locFlake").checked){$(d+"zip").value=G;J=0}else{$(d+"zip").value="";J=1}L.Profiles[Y]=J;$nodisplay($(d+"noLocation"));$nodisplay($(d+"noResult"));$display($(d+"content"));$(d+"topLnk").innerHTML=g;this.showMovies();if($isVisible($("editContainer"+d))){L.toggleEdit()}this.getCityName(M);$display($(d+"viewTbl"));$nodisplay($(d+"detailView"));L.Profiles[h]=G;$(d+"lnkAllMovie").className="ML_lnkTopInact";$(d+"lnkByTheater").className="ML_lnkTopAct";L.save()}else{L.toggleEdit()}};this.cancelSettings=function(){L.toggleEdit();$nodisplay($(d+"loader"));if(App.My.ZipCode!=M){$(d+"zip").value=L.Profiles[h];$(d+"locFlake").checked=true}else{$(d+"locStandard").checked=true;$(d+"zip").value=""}$(d+"editErr").innerHTML=""};this.showMovies=function(){if(!U){if(!K||B==C.VIEW_MOVIES){return}}if(B==C.VIEW_THEATERS){if(!U){Z=$(d+"content").innerHTML;m=S;N=V}if(A&&!U){V=Q;B=C.VIEW_MOVIES;S=k;$(d+"content").innerHTML=A;$(d+"daySelect").value=R;$(d+"lnkAllMovie").className="ML_lnkTopInact";$(d+"lnkByTheater").className="ML_lnkTopAct";$(d+"daySelect").disabled="";return}}var s=new Date();var r=$(d+"infoCont").offsetHeight;$nodisplay($(d+"infoCont"));$(d+"loader").style.height=r+"px";$(d+"loader").style.display="";S=1;this.showAllMovies(s);U=false;$(d+"lnkAllMovie").className="ML_lnkTopInact";$(d+"lnkByTheater").className="ML_lnkTopAct";$(d+"daySelect").disabled=""};this.showTheaters=function(){if(!K||B==C.VIEW_THEATERS){return}if(B==C.VIEW_MOVIES){A=$(d+"content").innerHTML;k=S;Q=V;R=$(d+"daySelect").value;if(Z){V=N;B=C.VIEW_THEATERS;S=m;$(d+"content").innerHTML=Z;$(d+"lnkAllMovie").className="ML_lnkTopAct";$(d+"lnkByTheater").className="ML_lnkTopInact";$(d+"daySelect").disabled="disabled";return}}var s=new Date();var r=$(d+"infoCont").offsetHeight;$(d+"infoCont").style.display="none";$(d+"loader").style.height=r+"px";$(d+"loader").style.display="";S=1;this.showAllTheaters(s);$(d+"lnkAllMovie").className="ML_lnkTopAct";$(d+"lnkByTheater").className="ML_lnkTopInact";$(d+"daySelect").disabled="disabled"};this.callFail=function(){$display($(d+"noResult"));$nodisplay($(d+"content"))};this.showAllMovies=function(s){D[I]=B;I++;if(B==C.VIEW_MOVIES){var r=$(d+"infoCont").offsetHeight;$(d+"loader").style.height=r+"px"}$nodisplay($(d+"infoCont"));$(d+"loader").style.display="";K=0;$(d+"daySelect").disabled="disabled";MovieListingService.GetMoviesByDate(M,s.getDate().toString(),s.getMonth().toString(),s.getFullYear().toString(),parseInt(L.internalId),F(this,this.viewAllMoviesResp),F(this,this.callFail))};this.viewAllMoviesResp=function(r){S=1;K=1;$(d+"daySelect").disabled="";c=r;c.sort();this.viewAllMovies()};this.viewAllMovies=function(){var r=new Sys.StringBuilder();var x=0;B=C.VIEW_MOVIES;$display($(d+"infoCont"));$nodisplay($(d+"loader"));$display($(d+"viewTbl"));$nodisplay($(d+"detailView"));r.append('<table width="100%" border="0" cellspacing="0" cellpadding="2" style="margin:12px 0 12px;">');if(c.length<=1){$D(d+"noResult");return}var w=window.IMAGE_PREFIX;for(i=(S-1)*10;i<c.length;i++){if(c[i]!="~"){var t=c[i].split("~");r.append('<tr class="');if(x){r.append("ML_oddRow");x=0}else{r.append("ML_evenRow");x=1}var u=t[0].replace(/'/g,"\\'");var z='<a href="javascript:void(0)" class="ML_contLink" onclick="'+d+".showTheater('"+u+"|"+t[1]+"|"+t[2]+"|"+t[3]+"|"+t[4]+"|"+t[5]+"|"+t[6]+"')\">";r.append('"><td style="width:22px;padding-right:2px;" align="right" valign="top" >'+z);r.append('<img src="'+w+'flakes/movielisting/movie.gif" alt="" width="14" height="16" valign="top" style="border:0;" /></a></td><td style="padding-left:2px;">');r.append(z+t[0]);r.append('</a> <span class="ML_contNote">(');r.append(t[1]);r.append(')</span></td><td style="width:20px;padding-right:4px;">&nbsp;</td></tr>')}if(!((i+1)%10)){break}}r.append("</table>");$(d+"viewTbl").innerHTML=r.toString();$nodisplay($(d+"noResult"));$display($(d+"content"));if(c.length>10){var v=parseInt(c.length/10);V=v;var s=c.length%10;if(s>0){v++}$display($(d+"paging"));this.initPaging();if(S==1||S<v){$(d+"next").innerHTML='<a href="javascript:void(0)" onclick="'+d+'.Pagination(1)"><img src="'+w+'flakes/movielisting/actNext.gif" alt="Next" title="Next" class="ML_actNav" width="25" height="25" style="border:0" /></a>'}else{$(d+"next").innerHTML='<img src="'+w+'flakes/movielisting/iactNext.gif" alt="" width="25" height="25" style="border:0" />'}if(S>1){$(d+"prev").innerHTML='<a href="javascript:void(0)" onclick="'+d+'.Pagination(-1)"><img src="'+w+'flakes/movielisting/actPrev.gif" alt="Previous" title="Previous" class="ML_actNav" width="25" height="25" style="border:0" /></a>'}else{$(d+"prev").innerHTML='<img src="'+w+'flakes/movielisting/iactPrev.gif" alt="" width="25" height="25" style="border:0" />'}}else{$(d+"paging").style.display="none"}};this.showAllTheaters=function(s){D[I]=B;I++;if(B==C.VIEW_THEATERS){var r=$(d+"infoCont").offsetHeight;$(d+"loader").style.height=r+"px"}$(d+"infoCont").style.display="none";$(d+"loader").style.display="";K=0;MovieListingService.GetTheaters(M,s.getDate(),s.getMonth(),s.getFullYear(),parseInt(L.internalId),F(this,this.viewAllTheaterResp),F(this,this.callFail))};this.viewAllTheaterResp=function(r){S=1;K=1;X=r;X.sort();this.viewAllTheaters()};this.viewAllTheaters=function(){var Aa=window.IMAGE_PREFIX;var u=new Sys.StringBuilder();var s=0;B=C.VIEW_THEATERS;$(d+"infoCont").style.display="";$(d+"loader").style.display="none";u.append('<table width="100%" border="0" cellspacing="0" cellpadding="2" style="margin:12px 0 12px;">');if(X.length<=1){u.append('<tr><td style="text-align:center">No theaters found for your area for this date. <a href="javascript:void(0)" onclick="'+d+'.showEdit()">Click here</a> to change your ZIP code.</td></tr>')}for(i=(S-1)*10;i<X.length;i++){if(X[i]!="~"){var w=X[i].split("~");u.append('<tr class="');if(s){u.append("ML_oddRow");s=0}else{u.append("ML_evenRow");s=1}var x=w[0].replace(/'/g,"\\'");var Ac=w[1].replace(/'/g,"\\'");var v='<a href="javascript:void(0)" class="ML_contLink" onclick="'+d+".showMovieTheater('"+x+"|"+Ac+"|"+w[2]+"')\">";u.append('"><td style="width:22px" align="right" valign="top">');u.append(v+'<img src="'+Aa+'flakes/movielisting/arrow.gif" alt="" width="16" height="16" style="border:0;" /></a></td><td>');u.append(v+w[0]);u.append('</a> <span class="ML_contNote">');var Ab=w[1].split(",");var t="";for(y=0;y<(Ab.length-2);y++){if(t==""){t+=Ab[y]}else{t+=","+Ab[y]}}u.append(t);u.append('</span></td><td style="width:20px;padding-right:4px"><a href="http://www.movieweb.com/movies/showtimes/theater.php?tid='+w[2]+'" target="_blank"><img src="'+Aa+'flakes/movielisting/BuyTicket.gif" alt="Buy Ticket!" title="Buy Ticket!" border="0" /></a></td></tr>')}if(!((i+1)%10)){break}}u.append("</table>");$(d+"viewTbl").innerHTML=u.toString();if(X.length>10){var z=parseInt(X.length/10);V=z;var r=X.length%10;if(r>0){z++}$(d+"paging").style.display="block";this.initPaging();if(S==1||S<z){$(d+"next").innerHTML='<a href="javascript:void(0)" onclick="'+d+'.Pagination(1)"><img src="'+Aa+'flakes/movielisting/actNext.gif" alt="Next" title="Next" class="ML_actNav" width="25" height="25" style="border:0" /></a>'}else{$(d+"next").innerHTML='<img src="'+Aa+'flakes/movielisting/iactNext.gif" alt="" width="25" height="25" style="border:0" />'}if(S>1){$(d+"prev").innerHTML='<a href="javascript:void(0)" onclick="'+d+'.Pagination(-1)"><img src="'+Aa+'flakes/movielisting/actPrev.gif" alt="Previous" title="Previous" class="ML_actNav" width="25" height="25" style="border:0" /></a>'}else{$(d+"prev").innerHTML='<img src="'+Aa+'flakes/movielisting/iactPrev.gif" alt="" width="25" height="25" style="border:0" />'}}else{$(d+"paging").style.display="none"}};this.initPaging=function(){$(d+"prev").innerHTML="";$(d+"next").innerHTML=""};this.showTheater=function(r){r=r.replace(/\'/g,"'");var u=r.split("|");var t=new Date($(d+"daySelect").value);var v=0;if(B!=C.VIEW_MOVIE_SHOW){D[I]=B;I++;v=1}if(D[I-1]==C.VIEW_MOVIES||D[I-1]==C.VIEW_THEATERS){T=$(d+"topLnk").innerHTML}else{if(v){q[E]=$(d+"infoCont").innerHTML;E++}else{q[E-1]=$(d+"infoCont").innerHTML}}W=r;if(e){if(v){j[o]=e;o++}else{j[o-1]=e}}e=r;var s=$(d+"infoCont").offsetHeight;$nodisplay($(d+"infoCont"));$(d+"loader").style.height=s+"px";$(d+"loader").style.display="";K=0;$(d+"daySelect").disabled="disabled";MovieListingService.GetTheaterByMovieDate(M,t.getDate(),t.getMonth(),t.getFullYear(),u[0],parseInt(L.internalId),F(this,this.viewTheaterForMovieResp),F(this,this.callFail))};this.viewTheaterForMovieResp=function(r){S=1;K=1;$(d+"daySelect").disabled="";n=r;n.sort();this.viewTheaterForMovie()};this.viewTheaterForMovie=function(){var Ac=window.IMAGE_PREFIX;var v=new Sys.StringBuilder();var x=W.split("|");$(d+"infoCont").style.display="";$ND($(d+"loader"));var Ab=$(d+"detailView");var w="";B=C.VIEW_MOVIE_SHOW;if(D[I-1]==C.VIEW_MOVIES){w="all movies"}else{if(D[I-1]==C.VIEW_MOVIE_SHOW){w=e.split("|")[0]}else{if(D[I-1]==C.VIEW_THEATER_SHOW){w=b.split("|")[0]}else{if(D[I-1]==C.VIEW_THEATERS){w="all theaters"}}}}$(d+"topLnk").innerHTML='&lt; <a href="javascript:void(0)" class="ML_lnkTopAct" onclick="'+d+'.backToList()">Back to '+w+"</a>";v.append('<table class="ML_movieInfo" width="100%" cellpadding="0" cellspacing="0"><tr><td>');v.append('<div style="float:left"><img src="'+x[3]+'" alt="');v.append(x[0]);v.append('" title="');v.append(x[0]);v.append('" /></div>');v.append('<div style="top:2px;padding-left:8px;float:left;"><b>');v.append(x[0]);v.append("</b>&nbsp;");var u=parseInt(x[2]);for(var s=0;s<5;s++){if(s<u){v.append('<img src="'+Ac+'flakes/movielisting/rateOn.gif" />')}else{v.append('<img src="'+Ac+'flakes/movielisting/rateOff.gif" />')}}v.append('<br /><span class="ML_contNote">MPAA Rating: '+x[1]+"</span><br />");v.append('<a href="'+x[4]+'" target="_blank">Read summary</a> | <a href="'+x[5]+'" target="_blank">Read review</a> | <a href="'+x[6]+'" target="_blank">View clip</a>');v.append("</div></td></tr></table>");var t=0;for(i=(S-1)*5;i<n.length;i++){if(n[i].length<=1){break}if(n[i]!="~"){var z=n[i].split("~");if(t%2){v.append('<div class="ML_detailOddBlock">')}else{v.append('<div class="ML_detailEvenBlock">')}v.append('<div style="float:right;"><a href="http://www.movieweb.com/movies/showtimes/theater.php?tid='+z[3]+'" target="_blank"><img src="'+Ac+'flakes/movielisting/BuyTicket.gif" alt="Buy Ticket!" title="Buy Ticket!" border="0" /></a></div>');v.append('<a href="javascript:void(0)" class="ML_contLink" onclick="');v.append(d+".showMovieTheater('"+z[0].replace(/'/g,"\\'")+"|"+z[1].replace(/'/g,"\\'")+"|"+z[3]+"')\">");v.append(z[0]+"</a><br />");v.append('<span class="ML_contNote">'+z[1]+"</span><br />");v.append(z[2]+"</div>");t++}if(!((i+1)%5)){break}}$D(Ab);Ab.innerHTML=v.toString();$ND($(d+"viewTbl"));if(n.length>5){var Aa=parseInt(n.length/5);V=Aa;var r=n.length%5;if(r>0){Aa++}$(d+"paging").style.display="block";this.initPaging();if(S==1||S<Aa){$(d+"next").innerHTML='<a href="javascript:void(0)" onclick="'+d+'.Pagination(1)"><img src="'+Ac+'flakes/movielisting/actNext.gif" alt="Next" title="Next" class="ML_actNav" width="25" height="25" style="border:0" /></a>'}else{$(d+"next").innerHTML='<img src="'+Ac+'flakes/movielisting/iactNext.gif" alt="" width="25" height="25" style="border:0" />'}if(S>1){$(d+"prev").innerHTML='<a href="javascript:void(0)" onclick="'+d+'.Pagination(-1)"><img src="'+Ac+'flakes/movielisting/actPrev.gif" alt="Previous" title="Previous" class="ML_actNav" width="25" height="25" style="border:0" /></a>'}else{$(d+"prev").innerHTML='<img src="'+Ac+'flakes/movielisting/iactPrev.gif" alt="" width="25" height="25" style="border:0" />'}}else{$(d+"paging").style.display="none"}};this.backToList=function(){if(!K){return}$(d+"paging").style.display="none";if(I>0){I--}if(D[I]==C.VIEW_THEATERS){$(d+"topLnk").innerHTML=g;$(d+"viewTbl").style.display="";$(d+"detailView").style.display="none";$(d+"lnkAllMovie").className="ML_lnkTopAct";$(d+"lnkByTheater").className="ML_lnkTopInact";$(d+"daySelect").disabled="disabled";this.viewAllTheaters();o=0;E=0;I=0;D=new Array();q=new Array();j=new Array()}else{if(D[I]==C.VIEW_MOVIES){$(d+"topLnk").innerHTML=g;$(d+"viewTbl").style.display="";$(d+"detailView").style.display="none";this.viewAllMovies();o=0;E=0;I=0;D=new Array();q=new Array();j=new Array()}else{if(D[I]==C.VIEW_MOVIE_SHOW){E--;$(d+"infoCont").innerHTML=q[E];B=C.VIEW_MOVIE_SHOW;this.setTopLnk();q.removeAt(E)}else{if(D[I]==C.VIEW_THEATER_SHOW){E--;$(d+"infoCont").innerHTML=q[E];B=C.VIEW_THEATER_SHOW;this.setTopLnk();q.removeAt(E)}}}}D.removeAt(I)};this.setTopLnk=function(){if(D[I-1]==C.VIEW_MOVIE_SHOW){o--;$(d+"topLnk").innerHTML='&lt; <a href="javascript:void(0)" class="ML_lnkTopAct" onclick="'+d+'.backToList()">Back to '+j[o].split("|")[0]+"</a>";e=j[o];j.removeAt(o)}else{if(D[I-1]==C.VIEW_THEATER_SHOW){o--;$(d+"topLnk").innerHTML='&lt; <a href="javascript:void(0)" class="ML_lnkTopAct" onclick="'+d+'.backToList()">Back to '+j[o].split("|")[0]+"</a>";b=j[o];j.removeAt(o)}else{if(D[I-1]==C.VIEW_MOVIES){$(d+"topLnk").innerHTML='&lt; <a href="javascript:void(0)" class="ML_lnkTopAct" onclick="'+d+'.backToList()">Back to all movies</a>'}else{if(D[I-1]==C.VIEW_THEATERS){$(d+"topLnk").innerHTML='&lt; <a href="javascript:void(0)" class="ML_lnkTopAct" onclick="'+d+'.backToList()">Back to all theaters</a>'}}}}};this.showMovieTheater=function(v){v=v.replace(/\'/g,"'");var u=v.split("|");var s=new Date();var t=0;$(d+"daySelect").disabled="";if(B!=C.VIEW_THEATER_SHOW){D[I]=B;I++;t=1}if(D[I-1]==C.VIEW_MOVIES||D[I-1]==C.VIEW_THEATERS){T=$(d+"topLnk").innerHTML}else{if(t){q[E]=$(d+"infoCont").innerHTML;E++}else{q[E-1]=$(d+"infoCont").innerHTML}}W=v;if(b){if(t){j[o]=b;o++}else{j[o-1]=b}}b=v;var r=$(d+"infoCont").offsetHeight;$ND($(d+"infoCont"));$(d+"loader").style.height=r+"px";$(d+"loader").style.display="";K=0;$(d+"daySelect").disabled="disabled";MovieListingService.GetTheaterMovies(M,s.getDate(),s.getMonth(),s.getFullYear(),u[2],parseInt(L.internalId),F(this,this.viewMovieForTheaterResp),F(this,this.callFail))};this.viewMovieForTheaterResp=function(r){S=1;K=1;$(d+"daySelect").disabled="";O=r;O.sort();this.viewMovieForTheater()};this.viewMovieForTheater=function(){var Aa=window.IMAGE_PREFIX;var u=new Sys.StringBuilder();var t=W.split("|");$(d+"infoCont").style.display="";$(d+"loader").style.display="none";var z=$(d+"detailView");var v="";B=C.VIEW_THEATER_SHOW;if(D[I-1]==C.VIEW_THEATERS){v="all theaters"}else{if(D[I-1]==C.VIEW_MOVIE_SHOW){v=e.split("|")[0]}else{if(D[I-1]==C.VIEW_THEATER_SHOW){v=b.split("|")[0]}else{if(D[I-1]==C.VIEW_MOVIES){v="all movies"}}}}$(d+"topLnk").innerHTML='&lt; <a href="javascript:void(0)" class="ML_lnkTopAct" onclick="'+d+'.backToList()">Back to '+v+"</a>";u.append('<div class="ML_movieInfo"><b>');u.append(t[0]);u.append("</b><br />");u.append('<span class="ML_contNote">');u.append(t[1]);u.append("</span></div>");if(O.length<=0){u.append('<div class="ML_detailOddBlock">');u.append("Showtimes not available");u.append("</div>")}else{var s=0;for(i=(S-1)*5;i<O.length;i++){if(O[i].length<=1){break}if(O[i]!="~~"){var w=O[i].split("~");if(s%2){u.append('<div class="ML_detailOddBlock">')}else{u.append('<div class="ML_detailEvenBlock">')}u.append('<div style="float:right;"><a href="http://www.movieweb.com/movies/showtimes/theater.php?tid='+t[2]+'" target="_blank"><img src="'+Aa+'flakes/movielisting/BuyTicket.gif" alt="Buy Ticket!" title="Buy Ticket!" border="0" /></a></div>');w[1]=w[1].replace(/'/g,"\\'");w[0]=w[0].replace(/'/g,"\\'");u.append(w[0]+' <span class="ML_contNote">('+w[1]+")</span><br />");if(w[7].length>0){u.append(w[7]+" | ")}u.append('<a href="javascript:void(0)" onclick="');u.append(d+".showTheater('"+w[0]+"|"+w[1]+"|"+w[2]+"|"+w[3]+"|"+w[4]+"|"+w[5]+"|"+w[6]+"')\">This movie in other theaters</a>");u.append("</div>");s++}if(!((i+1)%5)){break}}}z.style.display="block";z.innerHTML=u.toString();$(d+"viewTbl").style.display="none";if(O.length>5){var x=parseInt(O.length/5);V=x;var r=O.length%5;if(r>0){x++}$(d+"paging").style.display="block";this.initPaging();if(S==1||S<x){$(d+"next").innerHTML='<a href="javascript:void(0)" onclick="'+d+'.Pagination(1)"><img src="'+Aa+'flakes/movielisting/actNext.gif" alt="Next" title="Next" class="ML_actNav" width="25" height="25" style="border:0" /></a>'}else{$(d+"next").innerHTML='<img src="'+Aa+'flakes/movielisting/iactNext.gif" alt="" width="25" height="25" style="border:0" />'}if(S>1){$(d+"prev").innerHTML='<a href="javascript:void(0)" onclick="'+d+'.Pagination(-1)"><img src="'+Aa+'flakes/movielisting/actPrev.gif" alt="Previous" title="Previous" class="ML_actNav" width="25" height="25" style="border:0" /></a>'}else{$(d+"prev").innerHTML='<img src="'+Aa+'flakes/movielisting/iactPrev.gif" alt="" width="25" height="25" style="border:0" />'}}else{$(d+"paging").style.display="none"}};this.Pagination=function(r){if(parseInt(r)>0){if(S<=V){S++}}else{if(S>1){S--}}if(B==C.VIEW_MOVIES){this.viewAllMovies()}else{if(B==C.VIEW_THEATERS){this.viewAllTheaters()}else{if(B==C.VIEW_THEATER_SHOW){this.viewMovieForTheater()}else{if(B==C.VIEW_MOVIE_SHOW){this.viewTheaterForMovie()}}}}}};
