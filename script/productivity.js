var biRadixBase=2;
var biRadixBits=16;
var bitsPerDigit=biRadixBits;
var biRadix=1<<16;
var biHalfRadix=biRadix>>>1;
var biRadixSquared=biRadix*biRadix;
var maxDigitVal=biRadix-1;
var maxInteger=9999999999999998;
var maxDigits;
var ZERO_ARRAY;
var bigZero,bigOne;

function setMaxDigits(B){
    maxDigits=B;
    ZERO_ARRAY=new Array(maxDigits);
    for(var A=0;A<ZERO_ARRAY.length;A++){
        ZERO_ARRAY[A]=0
    }
    bigZero=new BigInt();
    bigOne=new BigInt();
    bigOne.digits[0]=1
}
setMaxDigits(20);
var dpl10=15;
var lr10=biFromNumber(1000000000000000);
function BigInt(A){
    if(typeof A=="boolean"&&A==true){
        this.digits=null
    }
    else{
        this.digits=ZERO_ARRAY.slice(0)
    }
    this.isNeg=false
}
function biFromDecimal(E){
    var D=E.charAt(0)=="-";
    var C=D?1:0;
    var A;
    while(C<E.length&&E.charAt(C)=="0"){
        ++C
    }
    if(C==E.length){
        A=new BigInt()
    }
    else{
        var B=E.length-C;
        var F=B%dpl10;
        if(F==0){
            F=dpl10
        }
        A=biFromNumber(Number(E.substr(C,F)));
        C+=F;
        while(C<E.length){
            A=biAdd(biMultiply(A,lr10),biFromNumber(Number(E.substr(C,dpl10))));
            C+=dpl10
        }
        A.isNeg=D
    }
    return A
}
function biCopy(B){
    var A=new BigInt(true);
    A.digits=B.digits.slice(0);
    A.isNeg=B.isNeg;
    return A
}
function biFromNumber(C){
    var A=new BigInt();
    A.isNeg=C<0;
    C=Math.abs(C);
    var B=0;
    while(C>0){
        A.digits[B++]=C&maxDigitVal;
        C=Math.floor(C/biRadix)
    }
    return A
}
function reverseStr(C){
    var A="";
    for(var B=C.length-1;B>-1;--B){
        A+=C.charAt(B)
    }
    return A
}
var hexatrigesimalToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");
function biToString(C,E){
    var B=new BigInt();
    B.digits[0]=E;
    var D=biDivideModulo(C,B);
    var A=hexatrigesimalToChar[D[1].digits[0]];
    while(biCompare(D[0],bigZero)==1){
        D=biDivideModulo(D[0],B);
        digit=D[1].digits[0];
        A+=hexatrigesimalToChar[D[1].digits[0]]
    }
    return(C.isNeg?"-":"")+reverseStr(A)
}
function biToDecimal(C){
    var B=new BigInt();
    B.digits[0]=10;
    var D=biDivideModulo(C,B);
    var A=String(D[1].digits[0]);
    while(biCompare(D[0],bigZero)==1){
        D=biDivideModulo(D[0],B);
        A+=String(D[1].digits[0])
    }
    return(C.isNeg?"-":"")+reverseStr(A)
}
var hexToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");
function digitToHex(C){
    var B=15;
    var A="";
    for(i=0;i<4;++i){
        A+=hexToChar[C&B];
        C>>>=4
    }
    return reverseStr(A)
}
function biToHex(B){
    var A="";var D=biHighIndex(B);for(var C=biHighIndex(B);C>-1;--C){A+=digitToHex(B.digits[C])}return A}function charToHex(H){var C=48;var B=C+9;var D=97;var G=D+25;var F=65;var E=65+25;var A;if(H>=C&&H<=B){A=H-C}else{if(H>=F&&H<=E){A=10+H-F}else{if(H>=D&&H<=G){A=10+H-D}else{A=0}}}return A}function hexToDigit(D){var B=0;var A=Math.min(D.length,4);for(var C=0;C<A;++C){B<<=4;B|=charToHex(D.charCodeAt(C))}return B}function biFromHex(E){var B=new BigInt();var A=E.length;for(var D=A,C=0;D>0;D-=4,++C){B.digits[C]=hexToDigit(E.substr(Math.max(D-4,0),Math.min(D,4)))}return B}function biFromString(I,H){var A=I.charAt(0)=="-";var D=A?1:0;var J=new BigInt();var B=new BigInt();B.digits[0]=1;for(var C=I.length-1;C>=D;C--){var E=I.charCodeAt(C);var F=charToHex(E);var G=biMultiplyDigit(B,F);J=biAdd(J,G);B=biMultiplyDigit(B,H)}J.isNeg=A;return J}function biDump(A){return(A.isNeg?"-":"")+A.digits.join(" ")}function biAdd(B,F){var A;if(B.isNeg!=F.isNeg){F.isNeg=!F.isNeg;A=biSubtract(B,F);F.isNeg=!F.isNeg}else{A=new BigInt();var E=0;var D;for(var C=0;C<B.digits.length;++C){D=B.digits[C]+F.digits[C]+E;A.digits[C]=D%biRadix;E=Number(D>=biRadix)}A.isNeg=B.isNeg}return A}function biSubtract(B,F){var A;if(B.isNeg!=F.isNeg){F.isNeg=!F.isNeg;A=biAdd(B,F);F.isNeg=!F.isNeg}else{A=new BigInt();var E,D;D=0;for(var C=0;C<B.digits.length;++C){E=B.digits[C]-F.digits[C]+D;A.digits[C]=E%biRadix;if(A.digits[C]<0){A.digits[C]+=biRadix}D=0-Number(E<0)}if(D==-1){D=0;for(var C=0;C<B.digits.length;++C){E=0-A.digits[C]+D;A.digits[C]=E%biRadix;if(A.digits[C]<0){A.digits[C]+=biRadix}D=0-Number(E<0)}A.isNeg=!B.isNeg}else{A.isNeg=B.isNeg}}return A}function biHighIndex(B){var A=B.digits.length-1;while(A>0&&B.digits[A]==0){--A}return A}function biNumBits(C){var E=biHighIndex(C);var D=C.digits[E];var B=(E+1)*bitsPerDigit;var A;for(A=B;A>B-bitsPerDigit;--A){if((D&32768)!=0){break}D<<=1}return A}function biMultiply(G,F){var J=new BigInt();var E;var B=biHighIndex(G);var I=biHighIndex(F);var H,A,C;for(var D=0;D<=I;++D){E=0;C=D;for(j=0;j<=B;++j,++C){A=J.digits[C]+G.digits[j]*F.digits[D]+E;J.digits[C]=A&maxDigitVal;E=A>>>biRadixBits}J.digits[D+B+1]=E}J.isNeg=G.isNeg!=F.isNeg;return J}function biMultiplyDigit(A,F){var E,D,C;result=new BigInt();E=biHighIndex(A);D=0;for(var B=0;B<=E;++B){C=result.digits[B]+A.digits[B]*F+D;result.digits[B]=C&maxDigitVal;D=C>>>biRadixBits}result.digits[1+E]=D;return result}function arrayCopy(E,H,C,G,F){var A=Math.min(H+F,E.length);for(var D=H,B=G;D<A;++D,++B){C[B]=E[D]}}var highBitMasks=new Array(0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535);function biShiftLeft(B,H){var D=Math.floor(H/bitsPerDigit);var A=new BigInt();arrayCopy(B.digits,0,A.digits,D,A.digits.length-D);var G=H%bitsPerDigit;var C=bitsPerDigit-G;for(var E=A.digits.length-1,F=E-1;E>0;--E,--F){A.digits[E]=((A.digits[E]<<G)&maxDigitVal)|((A.digits[F]&highBitMasks[G])>>>(C))}A.digits[0]=((A.digits[E]<<G)&maxDigitVal);A.isNeg=B.isNeg;return A}var lowBitMasks=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);function biShiftRight(B,H){var C=Math.floor(H/bitsPerDigit);var A=new BigInt();arrayCopy(B.digits,C,A.digits,0,B.digits.length-C);var F=H%bitsPerDigit;var G=bitsPerDigit-F;for(var D=0,E=D+1;D<A.digits.length-1;++D,++E){A.digits[D]=(A.digits[D]>>>F)|((A.digits[E]&lowBitMasks[F])<<G)}A.digits[A.digits.length-1]>>>=F;A.isNeg=B.isNeg;return A}function biMultiplyByRadixPower(B,C){var A=new BigInt();arrayCopy(B.digits,0,A.digits,C,A.digits.length-C);return A}function biDivideByRadixPower(B,C){var A=new BigInt();arrayCopy(B.digits,C,A.digits,0,A.digits.length-C);return A}function biModuloByRadixPower(B,C){var A=new BigInt();arrayCopy(B.digits,0,A.digits,0,C);return A}function biCompare(A,C){if(A.isNeg!=C.isNeg){return 1-2*Number(A.isNeg)}for(var B=A.digits.length-1;B>=0;--B){if(A.digits[B]!=C.digits[B]){if(A.isNeg){return 1-2*Number(A.digits[B]>C.digits[B])}else{return 1-2*Number(A.digits[B]<C.digits[B])}}}return 0}function biDivideModulo(F,E){var A=biNumBits(F);var D=biNumBits(E);var C=E.isNeg;var K,J;if(A<D){if(F.isNeg){K=biCopy(bigOne);K.isNeg=!E.isNeg;F.isNeg=false;E.isNeg=false;J=biSubtract(E,F);F.isNeg=true;E.isNeg=C}else{K=new BigInt();J=biCopy(F)}return new Array(K,J)}K=new BigInt();J=F;var H=Math.ceil(D/bitsPerDigit)-1;var G=0;while(E.digits[H]<biHalfRadix){E=biShiftLeft(E,1);++G;++D;H=Math.ceil(D/bitsPerDigit)-1}J=biShiftLeft(J,G);A+=G;var N=Math.ceil(A/bitsPerDigit)-1;var S=biMultiplyByRadixPower(E,N-H);while(biCompare(J,S)!=-1){++K.digits[N-H];J=biSubtract(J,S)}for(var Q=N;Q>H;--Q){var I=(Q>=J.digits.length)?0:J.digits[Q];var R=(Q-1>=J.digits.length)?0:J.digits[Q-1];var P=(Q-2>=J.digits.length)?0:J.digits[Q-2];var O=(H>=E.digits.length)?0:E.digits[H];var B=(H-1>=E.digits.length)?0:E.digits[H-1];if(I==O){K.digits[Q-H-1]=maxDigitVal}else{K.digits[Q-H-1]=Math.floor((I*biRadix+R)/O)}var M=K.digits[Q-H-1]*((O*biRadix)+B);var L=(I*biRadixSquared)+((R*biRadix)+P);while(M>L){--K.digits[Q-H-1];M=K.digits[Q-H-1]*((O*biRadix)|B);L=(I*biRadix*biRadix)+((R*biRadix)+P)}S=biMultiplyByRadixPower(E,Q-H-1);J=biSubtract(J,biMultiplyDigit(S,K.digits[Q-H-1]));if(J.isNeg){J=biAdd(J,S);--K.digits[Q-H-1]}}J=biShiftRight(J,G);K.isNeg=F.isNeg!=C;if(F.isNeg){if(C){K=biAdd(K,bigOne)}else{K=biSubtract(K,bigOne)}E=biShiftRight(E,G);J=biSubtract(E,J)}if(J.digits[0]==0&&biHighIndex(J)==0){J.isNeg=false}return new Array(K,J)}function biDivide(A,B){return biDivideModulo(A,B)[0]}function biModulo(A,B){return biDivideModulo(A,B)[1]}function biMultiplyMod(B,C,A){return biModulo(biMultiply(B,C),A)}function biPow(B,D){var A=bigOne;var C=B;while(true){if((D&1)!=0){A=biMultiply(A,C)}D>>=1;if(D==0){break}C=biMultiply(C,C)}return A}function biPowMod(C,F,B){var A=bigOne;var D=C;var E=F;while(true){if((E.digits[0]&1)!=0){A=biMultiplyMod(A,D,B)}E=biShiftRight(E,1);if(E.digits[0]==0&&biHighIndex(E)==0){break}D=biMultiplyMod(D,D,B)}return A}function RSAKeyPair(B,C,A){this.e=biFromHex(B);this.d=biFromHex(C);this.m=biFromHex(A);this.digitSize=2*biHighIndex(this.m)+2;this.chunkSize=this.digitSize-11;this.radix=16;this.barrett=new BarrettMu(this.m)}function BarrettMu(A){this.modulus=biCopy(A);this.k=biHighIndex(this.modulus)+1;var B=new BigInt();B.digits[2*this.k]=1;this.mu=biDivide(B,this.modulus);this.bkplus1=new BigInt();this.bkplus1.digits[this.k+1]=1;this.modulo=BarrettMu_modulo;this.multiplyMod=BarrettMu_multiplyMod;this.powMod=BarrettMu_powMod}function BarrettMu_modulo(H){var G=biDivideByRadixPower(H,this.k-1);var E=biMultiply(G,this.mu);var D=biDivideByRadixPower(E,this.k+1);var C=biModuloByRadixPower(H,this.k+1);var I=biMultiply(D,this.modulus);var B=biModuloByRadixPower(I,this.k+1);var A=biSubtract(C,B);if(A.isNeg){A=biAdd(A,this.bkplus1)}var F=biCompare(A,this.modulus)>=0;while(F){A=biSubtract(A,this.modulus);F=biCompare(A,this.modulus)>=0}return A}function BarrettMu_multiplyMod(A,C){var B=biMultiply(A,C);return this.modulo(B)}function BarrettMu_powMod(B,E){var A=new BigInt();A.digits[0]=1;var C=B;var D=E;while(true){if((D.digits[0]&1)!=0){A=this.multiplyMod(A,C)}D=biShiftRight(D,1);if(D.digits[0]==0&&biHighIndex(D)==0){break}C=this.multiplyMod(C,C)}return A}function twoDigit(A){return(A<10?"0":"")+String(A)}function encryptedString(L,O){if(L.chunkSize>L.digitSize-11){return"Error"}var K=new Array();var A=O.length;var E=0;while(E<A){K[E]=O.charCodeAt(E);E++}var F=K.length;var P="";var D,C,B;for(E=0;E<F;E+=L.chunkSize){B=new BigInt();D=0;var J;var I=(E+L.chunkSize)>F?F%L.chunkSize:L.chunkSize;var G=new Array();for(J=0;J<I;J++){G[J]=K[E+I-1-J]}G[I]=0;var H=Math.max(8,L.digitSize-3-I);for(J=0;J<H;J++){G[I+1+J]=Math.floor(Math.random()*254)+1}G[L.digitSize-2]=2;G[L.digitSize-1]=0;for(C=0;C<L.digitSize;++D){B.digits[D]=G[C++];B.digits[D]+=G[C++]<<8}var N=L.barrett.powMod(B,L.e);var M=L.radix==16?biToHex(N):biToString(N,L.radix);P+=M+" "}return P.substring(0,P.length-1)}function decryptedString(E,F){var H=F.split(" ");var A="";var D,C,G;for(D=0;D<H.length;++D){var B;if(E.radix==16){B=biFromHex(H[D])}else{B=biFromString(H[D],E.radix)}G=E.barrett.powMod(B,E.d);for(C=0;C<=biHighIndex(G);++C){A+=String.fromCharCode(G.digits[C]&255,G.digits[C]>>8)}}if(A.charCodeAt(A.length-1)==0){A=A.substring(0,A.length-1)}return A}function base64encode(I){var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var G=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);var D,F,H;var E,C,B;H=I.length;F=0;D="";while(F<H){E=I.charCodeAt(F++)&255;if(F==H){D+=A.charAt(E>>2);D+=A.charAt((E&3)<<4);D+="==";break}C=I.charCodeAt(F++);if(F==H){D+=A.charAt(E>>2);D+=A.charAt(((E&3)<<4)|((C&240)>>4));D+=A.charAt((C&15)<<2);D+="=";break}B=I.charCodeAt(F++);D+=A.charAt(E>>2);D+=A.charAt(((E&3)<<4)|((C&240)>>4));D+=A.charAt(((C&15)<<2)|((B&192)>>6));D+=A.charAt(B&63)}return D}var RSATYPE={MODULES:"E39EC2AFF31F49DCD1CEA3FCD5016EDE204DA5986A2EC9081215983C0DAAA0462E386D14FD979DAD1AF5FED4EE496468776FF9AE0005F9D5D5CCAA941D7EF6966D7729C5325D3B9696761F08F2431F15535BE51E217E9E72BBB10F8F1AC24C74B7109344B942EF16F8F053A627CA9CD775141F3242D86FB4A1DF558479080C05",ENCRYPTEX:"010001"};var RsaSecurityHelper={encrypt:function(A){setMaxDigits(130);var B=new RSAKeyPair(RSATYPE.ENCRYPTEX,"",RSATYPE.MODULES);return encryptedString(B,base64encode(A))}
};

var MailClientService=function(){
    MailClientService.initializeBase(this);
    this._timeout=0;
    this._userContext=null;
    this._succeeded=null;
    this._failed=null
};
MailClientService.prototype={
    GetServerConfigNote:function(D,B,C,A,E){
        return this._invoke(MailClientService.get_path(),"GetServerConfigNote",true,{flakeId:D,accountType:B},C,A,E)
    },
    DeleteAll:function(C,B,A,D){
        return this._invoke(MailClientService.get_path(),"DeleteAll",false,{flakeId:C},B,A,D)
    },
    UpdateStatus:function(E,A,B,D,C,G){
        return this._invoke(MailClientService.get_path(),"UpdateStatus",false,{flakeId:E,status:A,mailIds:B},D,C,G)
    },
    GetList:function(G,B,D,I,A,E,C,H){return this._invoke(MailClientService.get_path(),"GetList",false,{flakeId:G,checkNew:B,setting:D,start:I,max:A},E,C,H)
    },
    Send:function(B,I,A,D,G,C,K,J,H,E){return this._invoke(MailClientService.get_path(),"Send",false,{flakeId:B,to:I,cc:A,bcc:D,subject:G,body:C,setting:K},J,H,E)}
};
MailClientService.registerClass("MailClientService",Sys.Net.WebServiceProxy);
MailClientService._staticInstance=new MailClientService();
MailClientService.set_path=function(A){
    MailClientService._staticInstance._path=A
};
MailClientService.get_path=function(){
    return MailClientService._staticInstance._path
};
MailClientService.set_timeout=function(A){MailClientService._staticInstance._timeout=A};
MailClientService.get_timeout=function(){return MailClientService._staticInstance._timeout};
MailClientService.set_defaultUserContext=function(A){MailClientService._staticInstance._userContext=A};
MailClientService.get_defaultUserContext=function(){return MailClientService._staticInstance._userContext};
MailClientService.set_defaultSucceededCallback=function(A){MailClientService._staticInstance._succeeded=A};
MailClientService.get_defaultSucceededCallback=function(){return MailClientService._staticInstance._succeeded};
MailClientService.set_defaultFailedCallback=function(A){MailClientService._staticInstance._failed=A};
MailClientService.get_defaultFailedCallback=function(){return MailClientService._staticInstance._failed};
MailClientService.set_path(SITE_PREFIX+"flakes/amit/mailclient/MailClientService.soap");
MailClientService.GetServerConfigNote=function(C,B,D,A,E){MailClientService._staticInstance.GetServerConfigNote(C,B,D,A,E)};
MailClientService.DeleteAll=function(B,C,A,D){MailClientService._staticInstance.DeleteAll(B,C,A,D)};
MailClientService.UpdateStatus=function(D,A,B,E,C,G){MailClientService._staticInstance.UpdateStatus(D,A,B,E,C,G)};
MailClientService.GetList=function(E,B,D,I,A,G,C,H){MailClientService._staticInstance.GetList(E,B,D,I,A,G,C,H)};
MailClientService.Send=function(B,J,A,E,I,D,K,H,C,G){MailClientService._staticInstance.Send(B,J,A,E,I,D,K,H,C,G)};var gtc=Sys.Net.WebServiceProxy._generateTypedConstructor;if(typeof(MailClientAccountSetting)==="undefined"){var MailClientAccountSetting=gtc("MailClientAccountSetting");
MailClientAccountSetting.registerClass("MailClientAccountSetting")}if(typeof(MailClientMailHeaderPagedResult)==="undefined"){var MailClientMailHeaderPagedResult=gtc("MailClientMailHeaderPagedResult");
MailClientMailHeaderPagedResult.registerClass("MailClientMailHeaderPagedResult")}

function MailClientFlake(f){
    var Ae="flakes/amit/MailClient/";
    var AE;
    var Az;
    var W;
    var d;
    var o;
    var q;
    var C;
    var c;
    var Am;
    var Ap;
    var D;
    var y;
    var E;
    var O;
    var Aj;
    var N;
    var Al;
    var t;
    var U;
    var s;
    var Ao;
    var Ar;
    var r;
    var i;
    var AD;
    var Ac;
    var AI;
    var AH;var n;var Av;var P;
    var Q;var p;var As;var k;var Au;
    var Ab;var Af;var m;var AG;var T;
    var Ah;var g;var Ag;var u;var Aa;
    var Ad;var X;var AB;var AA;var Ai;
    var AF;var B;var J;var z;var R;
    var I;var a;var h;var K;var Y;
    var Aq;var G;var Ax;var H;
    var An;var M;var V;var AC;
    var Aw;var w;var x;var Ak;
    var Z=0;var b=0;var l=0;
    var Ay=0;var v=new Array();
    var A=new Array();var j;
    var S=false;var L=false;var e;
    var At=this;
    
    this.load=function(AJ){
        var AK=window.IMAGE_PREFIX;
        AJ.body.innerHTML='<div> <div id="'+f+'content"> <div id="'+f+'divInitMessage" style="display:none"> <table border="0" cellpadding="2" cellspacing="0">  <tbody>  <tr>  <td style="width:50%"></td>  <td style="text-align:center;vertical-align:middle">  <img src="'+AK+'flakes/amit/MailClient/Images/email.gif" alt="" />  </td>  <td style="text-align:center;vertical-align:middle;white-space:nowrap">  <a id="'+f+'lnkInitMessage" href="javascript:void(0)">Please configure your email account</a>  </td>  <td style="width:50%"></td>  </tr>  </tbody> </table> </div> <div id="'+f+'divContent" style="display:none"> <div id="'+f+'divBlueBar" style="background-color:#ecf2f1;margin-top:-10px;margin-bottom: 3px;margin-left:-8px;margin-right:-8px;padding-top:2px;padding-bottom:2px;display:none">  <img alt="" src="'+AK+'flakes/amit/MailClient/Images/back.gif" />  <a id="'+f+'lnkBack" href="javascript:void(0)">Back to Inbox</a> </div> <div id="'+f+'divInbox" style="display:none">  <table border="0" cellspacing="0" cellpadding="0" style="width:100%">  <tbody>  <tr>  <td style="text-align:left;vertical-align:bottom;padding-left:8px;padding-top:2px">   <div style="background-color:#f1eded;border-right:solid 3px #ffffff;border-bottom:solid 0px #f1eded;float:left;padding-top:1px;padding-left:16px;padding-right:16px;padding-bottom:2px;text-align:center;white-space:nowrap;font-weight:bold">Inbox</div>  </td>  <td style="text-align:right;vertical-align:middle;padding-right:4px;padding-top:2px;padding-bottom:2px;width:100%">   <img src="'+AK+'flakes/amit/MailClient/Images/compose.gif" alt="" />   <a id="'+f+'lnkComponseMail" href="javascript:void(0)">Compose mail</a>  </td>  </tr>  </tbody>  </table>  <table border="0" cellspacing="0" cellpadding="0" style="width:100%">  <tbody>  <tr>  <td colspan="2" style="text-align:left;vertical-align:top;background-color:#f1eded">   <div id="'+f+'divInboxMessage" style="padding:4px;display:none"></div>   <div id="'+f+'divInboxList" style="padding-top:2px;display:none"></div>   <div id="'+f+'divReading" style="padding-top:2px;display:none"></div>  </td>  </tr>  </tbody>  </table> </div> <div id="'+f+'divWriting" style="background-color:#e4ecf4;padding:8px;display:none">  <table border="0" cellpadding="3" cellspacing="0" style="width:100%">  <tbody>  <tr>  <td style="text-align:left;vertical-align:middle">   <strong>Write mail</strong>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle">   <table border="0" cellpadding="1" cellspacing="0" style="width:100%">   <tbody>   <tr>   <td style="text-align:left;vertical-align:middle">    <label for="'+f+'txtTo">To</label>   </td>   </tr>   <tr>   <td style="text-align:left;vertical-align:middle">    <input id="'+f+'txtTo" type="text" maxlength="512" style="width:85%" />    <a id="'+f+'lnkCCBCC" href="javascript:void(0)">CC/BCC</a>    <div id="'+f+'divToMessage" style="padding-top:1px;display:none"></div>   </td>   </tr>   </tbody>   </table>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle">   <table id="'+f+'tblCC" border="0" cellpadding="1" cellspacing="0" style="width:100%;display:none">   <tbody>   <tr>   <td style="text-align:left;vertical-align:middle">    <label for="'+f+'txtCC">CC</label>   </td>   </tr>   <tr>   <td style="text-align:left;vertical-align:middle">    <input id="'+f+'txtCC" type="text" maxlength="512" style="width:85%" />    <div id="'+f+'divCCMessage" style="padding-top:1px;display:none"></div>   </td>   </tr>   </tbody>   </table>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle">   <table id="'+f+'tblBCC" border="0" cellpadding="1" cellspacing="0" style="width:100%">   <tbody>   <tr>   <td style="text-align:left;vertical-align:middle">    <label for="'+f+'txtBCC">BCC</label>   </td>   </tr>   <tr>   <td style="text-align:left;vertical-align:middle">    <input id="'+f+'txtBCC" type="text" maxlength="512" style="width:85%" />    <div id="'+f+'divBCCMessage" style="padding-top:1px;display:none"></div>   </td>   </tr>   </tbody>   </table>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle">   <table border="0" cellpadding="1" cellspacing="0" style="width:100%">   <tbody>   <tr>   <td style="text-align:left;vertical-align:middle">    <label for="'+f+'txtSubject">Subject</label>   </td>   </tr>   <tr>   <td style="text-align:left;vertical-align:middle">    <input id="'+f+'txtSubject" type="text" maxlength="512" style="width:85%" />   </td>   </tr>   </tbody>   </table>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle">   <table border="0" cellpadding="1" cellspacing="0" style="width:100%">   <tbody>   <tr>   <td style="text-align:left;vertical-align:middle">    <textarea id="'+f+'txtBody" cols="6" rows="16" style="width:95%"></textarea>   </td>   </tr>   </tbody>   </table>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle">   <table border="0" cellpadding="1" cellspacing="0" style="width:100%">   <tbody>   <tr>   <td style="text-align:left;vertical-align:middle">    <div id="'+f+'divWritingMessage" style="padding:3px;display:none"></div>   </td>   </tr>   </tbody>   </table>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle">   <table border="0" cellpadding="1" cellspacing="0" style="width:100%">   <tbody>   <tr>   <td style="text-align:left;vertical-align:middle">    <input id="'+f+'btnMailSend" class="button" type="button" value="Send" />&nbsp;    <input id="'+f+'btnMailCancel" class="button cancel" type="button" value="Cancel" />   </td>   </tr>   </tbody>   </table>  </td>  </tr>  </tbody>  </table> </div> </div> </div> </div>';AJ.setEditArea('<div id="'+f+'divConfigError" style="background-color:#ffffcc;margin-bottom:10px;padding-top:2px;padding-bottom:5px;display:none">  <table cellpadding="1" cellspacing="2" border="0" style="font-size:8pt">  <tr>  <td><img alt="" src="'+AK+'flakes/amit/MailClient/Images/error.gif" style="padding-left:2px;margin-top:1px" /></td>  <td><span style="color:#c00000"><strong>Problem accessing your mailbox</strong></span></td>  </tr>  <tr>  <td>&nbsp;</td>  <td><div id="'+f+'divConfigErrorMessage"></div></td>  </tr> </table> </div> <table border="0" cellpadding="2" cellspacing="0"> <tbody>  <tr>  <td style="width:99px">  <strong><label for="'+f+'ddlAccountType">Account Type:</label></strong>  </td>  <td style="text-align:left">  <select id="'+f+'ddlAccountType">  <option value="1">GMail</option>  <option value="2">Yahoo! Mail PLUS</option>  <option value="3">WEB.DE</option>  <option value="4">Yahoo.de (German)</option>  <option value="5">GMX</option>  <option value="6">Freenet.de</option>  <option value="7">Yahoo Brazil</option>  <option value="8">Terra Brazil Premium</option>  <option value="9">BOL Brazil</option>  <option value="10">iG Brazil</option>  <option value="11">AOL Mail</option>  <option value="0">any POP3 account</option>  </select>  </td>  </tr>  <tr>  <td style="width:99px">  <label for="'+f+'txtFullName">Your Name</label>  </td>  <td style="text-align:left">  <input id="'+f+'txtFullName" type="text" maxlength="256" />  </td>  </tr>  <tr>  <td style="width:99px">  <label for="'+f+'txtEmail">Email Address</label>  </td>  <td style="text-align:left">  <input id="'+f+'txtEmail" type="text" maxlength="256" />  <span id="'+f+'spnEmail" style="color:#ff0000;visibility:hidden">*</span>  </td>  </tr> </tbody> </table> <table id="'+f+'tblGeneric" border="0" cellpadding="2" cellspacing="0" style="display:none;padding-left:2px"> <tbody>  <tr>  <td style="width:99px;text-align:left">  <label for="'+f+'txtPOP3Server">POP3 Server</label>  </td>  <td style="text-align:left;padding-left:2px">  <input id="'+f+'txtPOP3Server" type="text" maxlength="256" />  <span id="'+f+'spnPOP3Server" style="color:#ff0000;visibility:hidden">*</span>  </td>  </tr>  <tr>  <td style="width:99px;text-align:left">  <label for="'+f+'txtSMTPServer">SMTP Server</label>  </td>  <td style="text-align:left;padding-left:2px">  <input id="'+f+'txtSMTPServer" type="text" maxlength="256" />  <span id="'+f+'spnSMTPServer" style="color:#ff0000;visibility:hidden">*</span>  </td>  </tr>  <tr>  <td style="width:99px;text-align:left">  <label for="'+f+'txtUserName">User Name</label>  </td>  <td style="text-align:left;padding-left:2px">  <input id="'+f+'txtUserName" type="text" maxlength="256" />  <span id="'+f+'spnUserName" style="color:#ff0000;visibility:hidden">*</span>  </td>  </tr> </tbody> </table> <table border="0" cellpadding="2" cellspacing="0"> <tbody>  <tr>  <td style="width:99px">  <label for="'+f+'txtPassword">Password</label>  </td>  <td style="text-align:left">  <input id="'+f+'txtPassword" type="password" />  <span id="'+f+'spnPassword" style="color:#ff0000;visibility:hidden">*</span>  </td>  </tr> </tbody> </table> <table border="0" cellpadding="2" cellspacing="0" style="padding-top:4px"> <tbody>  <tr>  <td style="text-align:left">  <strong><a id="'+f+'lnkGeneral" href="javascript:void(0)">General Settings</a></strong>  <div id="'+f+'divGeneral" style="padding-top:2px;display:none">  <table border="0" cellpadding="2" cellspacing="0">   <tbody>   <tr>   <td colspan="2" style="text-align:left">   <label for="'+f+'ddlTimeZone">Time Zone</label>   </td>   </tr>   <tr>   <td colspan="2" style="text-align:left">   <select id="'+f+'ddlTimeZone" style="width:100%">    <option value="-1">[Choose a time zone]</option>    <option value="0">(GMT-12:00) International Date Line West</option>    <option value="1">(GMT-11:00) Midway Island, Samoa</option>    <option value="2">(GMT-10:00) Hawaii</option>    <option value="16387">(GMT-09:00) Alaska</option>    <option value="16388">(GMT-08:00) Pacific Time (US &amp; Canada), Tijuana</option>    <option value="15">(GMT-07:00) Arizona</option>    <option value="16397">(GMT-07:00) Chihuahua, La Paz, Mazatlan</option>    <option value="16394">(GMT-07:00) Mountain Time (US &amp; Canada)</option>    <option value="33">(GMT-06:00) Central America</option>    <option value="16404">(GMT-06:00) Central Time (US &amp; Canada)</option>    <option value="16414">(GMT-06:00) Guadalajara, Mexico City, Monterrey</option>    <option value="25">(GMT-06:00) Saskatchewan</option>    <option value="45">(GMT-05:00) Bogota, Lima, Quito</option>    <option value="16419">(GMT-05:00) Eastern Time (US &amp; Canada)</option>    <option value="40">(GMT-05:00) Indiana (East)</option>    <option value="16434">(GMT-04:00) Atlantic Time (Canada)</option>    <option value="55">(GMT-04:00) Caracas, La Paz</option>    <option value="16440">(GMT-04:00) Santiago</option>    <option value="16444">(GMT-03:30) Newfoundland</option>    <option value="16449">(GMT-03:00) Brasilia</option>    <option value="70">(GMT-03:00) Buenos Aires, Georgetown</option>    <option value="16457">(GMT-03:00) Greenland</option>    <option value="16459">(GMT-02:00) Mid-Atlantic</option>    <option value="16464">(GMT-01:00) Azores</option>    <option value="83">(GMT-01:00) Cape Verde Is.</option>    <option value="90">(GMT) Casablanca, Monrovia</option>    <option value="16469">(GMT) Greenwich Mean Time : Dublin, Edinburgh,</option>    <option value="16494">(GMT+01:00) Amsterdam, Berlin, Bern, Rome,</option>    <option value="16479">(GMT+01:00) Belgrade, Bratislava, Budapest,</option>    <option value="16489">(GMT+01:00) Brussels, Copenhagen, Madrid, Paris</option>    <option value="16484">(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb</option>    <option value="113">(GMT+01:00) West Central Africa</option>    <option value="16514">(GMT+02:00) Athens, Beirut, Istanbul, Minsk</option>    <option value="16499">(GMT+02:00) Bucharest</option>    <option value="16504">(GMT+02:00) Cairo</option>    <option value="140">(GMT+02:00) Harare, Pretoria</option>    <option value="16509">(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn,</option>    <option value="135">(GMT+02:00) Jerusalem</option>    <option value="16542">(GMT+03:00) Baghdad</option>    <option value="150">(GMT+03:00) Kuwait, Riyadh</option>    <option value="16529">(GMT+03:00) Moscow, St. Petersburg, Volgograd</option>    <option value="155">(GMT+03:00) Nairobi</option>    <option value="16544">(GMT+03:30) Tehran</option>    <option value="165">(GMT+04:00) Abu Dhabi, Muscat</option>    <option value="16554">(GMT+04:00) Baku, Tbilisi, Yerevan</option>    <option value="175">(GMT+04:30) Kabul</option>    <option value="16564">(GMT+05:00) Ekaterinburg</option>    <option value="185">(GMT+05:00) Islamabad, Karachi, Tashkent</option>    <option value="190">(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi</option>    <option value="193">(GMT+05:45) Kathmandu</option>    <option value="16585">(GMT+06:00) Almaty, Novosibirsk</option>    <option value="195">(GMT+06:00) Astana, Dhaka</option>    <option value="200">(GMT+06:00) Sri Jayawardenepura</option>    <option value="203">(GMT+06:30) Rangoon</option>    <option value="205">(GMT+07:00) Bangkok, Hanoi, Jakarta</option>    <option value="16591">(GMT+07:00) Krasnoyarsk</option>    <option value="210">(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi</option>    <option value="16611">(GMT+08:00) Irkutsk, Ulaan Bataar</option>    <option value="215">(GMT+08:00) Kuala Lumpur, Singapore</option>    <option value="225">(GMT+08:00) Perth</option>    <option value="220">(GMT+08:00) Taipei</option>    <option value="235">(GMT+09:00) Osaka, Sapporo, Tokyo</option>    <option value="230">(GMT+09:00) Seoul</option>    <option value="16624">(GMT+09:00) Yakutsk</option>    <option value="16634">(GMT+09:30) Adelaide</option>    <option value="245">(GMT+09:30) Darwin</option>    <option value="260">(GMT+10:00) Brisbane</option>    <option value="16639">(GMT+10:00) Canberra, Melbourne, Sydney</option>    <option value="275">(GMT+10:00) Guam, Port Moresby</option>    <option value="16649">(GMT+10:00) Hobart</option>    <option value="16654">(GMT+10:00) Vladivostok</option>    <option value="280">(GMT+11:00) Magadan, Solomon Is., New Caledonia</option>    <option value="16674">(GMT+12:00) Auckland, Wellington</option>    <option value="285">(GMT+12:00) Fiji, Kamchatka, Marshall Is.</option>    <option value="300">(GMT+13:00) Nuku\'alofa</option>   </select>   </td>   </tr>   <tr>   <td style="width:99px">   <label for="'+f+'ddlPageSize">Display</label>   </td>   <td style="text-align:left">   <select id="'+f+'ddlPageSize">    <option value="5">5 mails</option>    <option value="10">10 mails</option>    <option value="20">20 mails</option>    <option value="25">25 mails</option>   </select>   </td>   </tr>   <tr>   <td style="width:99px">   <label for="'+f+'ddlRefreshInterval">Refresh Interval</label>   </td>   <td style="text-align:left">   <select id="'+f+'ddlRefreshInterval">    <option value="0">Do not auto refresh</option>    <option value="5" selected="selected">5 minutes</option>    <option value="10">10 minutes</option>    <option value="15">15 minutes</option>    <option value="20">20 minutes</option>    <option value="25">25 minutes</option>   </select>   </td>   </tr>   </tbody>  </table>  </div>  </td>  </tr> </tbody> </table> <table border="0" cellpadding="2" cellspacing="0" style="padding-top:4px"> <tbody>  <tr>  <td style="text-align:left">  <strong><a id="'+f+'lnkSignature" href="javascript:void(0)">Signature Settings</a></strong>  <div id="'+f+'divSignature" style="padding-top:2px;display:none">  <table border="0" cellpadding="2" cellspacing="0">   <tbody>   <tr>   <td>   <input id="'+f+'chkUseSignature" type="checkbox" checked="checked" />   </td>   <td style="text-align:left">   <label for="'+f+'chkUseSignature">Use Signature</label>   </td>   </tr>   <tr>   <td></td>   <td style="text-align:left">   <input id="'+f+'txtSignature" type="text" value="Sent from my www.Pageflakes.com startpage" style="width:90%" />   </td>   </tr>   </tbody>  </table>  </div>  </td>  </tr> </tbody> </table> <table id="'+f+'tblPOP3" border="0" cellpadding="2" cellspacing="0" style="padding-top:4px;display:none"> <tbody>  <tr>  <td style="text-align:left">  <strong><a id="'+f+'lnkPOP3Settings" href="javascript:void(0)">Advanced POP3 Settings</a></strong>  <div id="'+f+'divPOP3Settings" style="padding-top:2px;display:none">  <table border="0" cellpadding="2" cellspacing="0">   <tbody>   <tr>   <td style="width:99px">   <label for="'+f+'txtPOP3Port">Incoming port:</label>   </td>   <td style="text-align:left">   <input id="'+f+'txtPOP3Port" type="text" value="110" maxlength="3" size="3" />   <span id="'+f+'spnPOP3Port" style="color:#ff0000;visibility:hidden">*</span>   </td>   </tr>   <tr>   <td colspan="2">   <input id="'+f+'chkUseSSL" type="checkbox" />   <label for="'+f+'chkUseSSL">Use SSL</label>   </td>   </tr>   </tbody>  </table>  </div>  </td>  </tr> </tbody> </table> <table id="'+f+'tblSMTP" border="0" cellpadding="2" cellspacing="0" style="padding-top:4px;display:none"> <tbody>  <tr>  <td style="text-align:left">  <strong><a id="'+f+'lnkSMTPSettings" href="javascript:void(0)">Advanced SMTP Settings</a></strong>  <div id="'+f+'divSMTPSettings" style="padding-top:2px;display:none">  <table border="0" cellpadding="2" cellspacing="0">   <tbody>   <tr>   <td style="width:99px">   <label for="'+f+'txtSMTPPort">Outgoing port:</label>   </td>   <td style="text-align:left">   <input id="'+f+'txtSMTPPort" type="text" value="25" maxlength="3" size="3" />   <span id="'+f+'spnSMTPPort" style="color:#ff0000;visibility:hidden">*</span>   </td>   </tr>   <tr>   <td colspan="2">   <input id="'+f+'chkSecurePassword" type="checkbox" />   <label for="'+f+'chkSecurePassword">SSL</label>   </td>   </tr>   <tr>   <td colspan="2">   <input id="'+f+'chkSMTPrequiresAuth" type="checkbox" />   <label for="'+f+'chkSMTPrequiresAuth">SMTP requires Authentication</label>   </td>   </tr>   <tr>   <td colspan="2">   <table id="'+f+'tblSMTPRadioGroup" width="115%" border="0" cellpadding="2" cellspacing="0" style="padding-top:4px;display:none">    <tr>    <td colspan="2">    <input id="'+f+'radioSMTPGroupID" type="radio" name="'+f+'radioSMTPGroup" value="1" checked="checked" />Use POP3 settings    </td>    </tr>    <tr>    <td colspan="2">    <input id="'+f+'radioSMTPGroupID1" type="radio" name="'+f+'radioSMTPGroup" value="2" />Use this login data:    </td>    </tr>    <tr>    <td align="right">    <label for="'+f+'txtSMTPUserName">&nbsp;&nbsp;User name:</label>    </td>    <td>    <input id="'+f+'txtSMTPUserName" type="text" maxlength="25" size="13" />    <span id="'+f+'spnSMTPUserName" style="color:#ff0000;visibility:hidden">*</span>    </td>    </tr>    <tr>    <td align="right">    <label for="'+f+'\'txtSMTPPassword">&nbsp;&nbsp;Password:</label>    </td>    <td>    <input id="'+f+'txtSMTPPassword" type="password" maxlength="25" size="13" />    <span id="'+f+'spnSMTPPassword" style="color:#ff0000;visibility:hidden">*</span>    </td>    </tr>   </table>   </td>   </tr>   </tbody>  </table>  </div>  </td>  </tr> </tbody> </table> <table border="0" cellpadding="2" cellspacing="0" style="padding-top:4px"> <tbody>  <tr>  <td style="width:99px"></td>  <td style="text-align:left">  <input id="'+f+'btnSave" class="button" type="button" value="Save" />  <input id="'+f+'btnCancel" class="button cancel" type="button" value="Cancel" />  </td>  </tr> </tbody> </table> <div id="'+f+'divFootnote" style="padding-top:4px"></div>');e=AJ;e.setIcon(window.IMAGE_PREFIX+"images/flakes/GmailIcon.gif");AE=$(f+"divConfigError");Az=$(f+"divConfigErrorMessage");W=$(f+"ddlAccountType");d=$(f+"txtFullName");o=$(f+"txtEmail");q=$(f+"spnEmail");C=$(f+"tblGeneric");c=$(f+"txtPOP3Server");Am=$(f+"spnPOP3Server");Ap=$(f+"txtSMTPServer");D=$(f+"spnSMTPServer");y=$(f+"txtUserName");E=$(f+"spnUserName");O=$(f+"txtPassword");Aj=$(f+"spnPassword");N=$(f+"lnkGeneral");Al=$(f+"divGeneral");t=$(f+"ddlTimeZone");U=$(f+"ddlPageSize");s=$(f+"ddlRefreshInterval");Ao=$(f+"lnkSignature");Ar=$(f+"divSignature");r=$(f+"chkUseSignature");i=$(f+"txtSignature");AD=$(f+"tblPOP3");Ac=$(f+"lnkPOP3Settings");AI=$(f+"divPOP3Settings");AH=$(f+"txtPOP3Port");n=$(f+"spnPOP3Port");Av=$(f+"chkUseSSL");P=$(f+"tblSMTP");Q=$(f+"lnkSMTPSettings");p=$(f+"divSMTPSettings");As=$(f+"txtSMTPPort");k=$(f+"spnSMTPPort");Au=$(f+"chkSecurePassword");Ab=$(f+"chkSMTPrequiresAuth");Af=$(f+"tblSMTPRadioGroup");m=$(f+"txtSMTPUserName");AG=$(f+"spnSMTPUserName");T=$(f+"txtSMTPPassword");Ah=$(f+"spnSMTPPassword");Ag=$(f+"radioSMTPGroupID");u=$(f+"radioSMTPGroupID1");Aa=$(f+"btnSave");Ad=$(f+"btnCancel");X=$(f+"divFootnote");AB=$(f+"divInitMessage");AA=$(f+"lnkInitMessage");AF=$(f+"divBlueBar");B=$(f+"lnkBack");Ai=$(f+"divContent");J=$(f+"divInbox");z=$(f+"lnkComponseMail");R=$(f+"divInboxMessage");I=$(f+"divInboxList");a=$(f+"divReading");h=$(f+"divWriting");K=$(f+"txtTo");Y=$(f+"divToMessage");Aq=$(f+"lnkCCBCC");G=$(f+"txtSubject");Ax=$(f+"tblCC");H=$(f+"txtCC");An=$(f+"divCCMessage");M=$(f+"tblBCC");V=$(f+"txtBCC");AC=$(f+"divBCCMessage");Aw=$(f+"txtBody");w=$(f+"divWritingMessage");x=$(f+"btnMailSend");Ak=$(f+"btnMailCancel");
        e.beforeClose=function(){
            if(confirm("If you remove your mail, all your mail data will be lost. Are you sure that you want to remove your Mail Flake?")){
                if(e.page.CanChangeFlake){
                    MailClientService.DeleteAll(e.internalId,function(AL){},F(this,PageflakesUtility.dumpException))
                }
                return true
            }
        };
        W.onchange=function(AL){
            At.changeAccount()
        };
        O.onchange=function(AL){
            S=true
        };
        T.onchange=function(AL){
            L=true
        };
        AA.onclick=function(AL){
            e.showEditArea()
        };
        N.onclick=function(AL){
            At.toggleDisplay(Al)
        };
        Ao.onclick=function(AL){
            At.toggleDisplay(Ar)
        };
        Ac.onclick=function(AL){
            At.toggleDisplay(AI)
        };
        Q.onclick=function(AL){
            At.toggleDisplay(p)
        };
        Av.onclick=function(AL){
            AH.value=(this.checked)?"995":"110"
        };
        Ab.onclick=function(AL){
            if(this.checked){
                $display(Af)
            }
            else{
                $nodisplay(Af)
            }
        };
        Ag.onclick=function(AL){
            Ag.checked="checked";
            u.checked="";
            m.disabled=true;
            T.disabled=true
        };
        u.onclick=function(AL){
            Ag.checked="";
            u.checked="checked";
            m.disabled=false;
            T.disabled=false
        };
        AA.onclick=function(AL){
            e.showEditArea()
        };
        Aa.onclick=function(AL){
            At.saveSetting()
        };
        Ad.onclick=function(AL){
            At.loadSetting();
            e.hideEditArea()
        };
        B.onclick=function(AL){
            At.showInbox()
        };
        z.onclick=function(AL){
            At.composeMail("","","","","");
            $focus(K)
        };
        Aq.onclick=function(AL){
            At.toggleDisplay(Ax);
            At.toggleDisplay(M)
        };
        x.onclick=function(AL){
            At.sendMail()
        };
        Ak.onclick=function(AL){
            At.showInbox()
        };
        if(ie){
            d.onkeydown=this.onIEEditKeyDown;
            o.onkeydown=this.onIEEditKeyDown;
            c.onkeydown=this.onIEEditKeyDown;
            Ap.onkeydown=this.onIEEditKeyDown;
            y.onkeydown=this.onIEEditKeyDown;
            O.onkeydown=this.onIEEditKeyDown;
            i.onkeydown=this.onIEEditKeyDown;
            AH.onkeydown=this.onIEEditKeyDown;
            As.onkeydown=this.onIEEditKeyDown;
            m.onkeydown=this.onIEEditKeyDown;
            T.onkeydown=this.onIEEditKeyDown
        }
        else{
            d.onkeydown=this.onMozillaEditKeyDown;
            o.onkeydown=this.onMozillaEditKeyDown;
            c.onkeydown=this.onMozillaEditKeyDown;
            Ap.onkeydown=this.onMozillaEditKeyDown;
            y.onkeydown=this.onMozillaEditKeyDown;
            O.onkeydown=this.onMozillaEditKeyDown;
            i.onkeydown=this.onMozillaEditKeyDown;
            AH.onkeydown=this.onMozillaEditKeyDown;
            As.onkeydown=this.onMozillaEditKeyDown;
            m.onkeydown=this.onMozillaEditKeyDown;
            T.onkeydown=this.onMozillaEditKeyDown
        }
        if(e.Profiles["ver1.5"]==null){
            if(e.PrivateProfiles.accountType!=null){
                this.importOldProfile()
            }
            else{
                $display(AB);
                $nodisplay(Ai);
                this.changeAccount()
            }
        }
        else{
            $nodisplay(AB);
            $display(Ai);
            this.loadSetting();
            this.loadInbox(true)
        }
        if(e.PrivateProfiles.smtprequiresauth=="True"){
            Ab.checked=true;
            $display(Af)
        }
        if(e.PrivateProfiles.smtpradiogroupvalue=="1"||e.PrivateProfiles.smtpradiogroupvalue==null){
            Ag.checked="checked";
            this.smtpTextBoxDisable(event)
        }
        else{
            u.checked="checked";
            this.smtpTextBoxEnable(event)
       }
};
this.smtpTextBoxDisable=function(AJ){m.disabled=true;T.disabled=true;m.style="background-color:Gray";T.style="background-color:Gray"};
this.smtpTextBoxEnable=function(AJ){m.disabled=false;T.disabled=false;m.style="display:none";T.style="display:none"};
this.importOldProfile=function(){var AL=e.PrivateProfiles.dummyPassword;var AN=e.PrivateProfiles.accountType;var A3=e.PrivateProfiles.fullname;var AX=e.PrivateProfiles.email;var AK=e.PrivateProfiles.password;var AQ=e.PrivateProfiles.userName;var A1=e.PrivateProfiles.pop3Server;var AM=parseInt(e.PrivateProfiles.pop3Port);var AO=e.PrivateProfiles.popSSL;var AP=e.PrivateProfiles.smtpServer;var A0=parseInt(e.PrivateProfiles.smtpPort);var AS=e.PrivateProfiles.smtpReq;var AZ=e.PrivateProfiles.pageSize;var AR=e.PrivateProfiles.refreshInterval;var AV=e.PrivateProfiles.checkboxUseSignature;var AU=e.PrivateProfiles.textboxSignature;var AW=e.PrivateProfiles.smtpusername;var AT=e.PrivateProfiles.smtppassword;var AJ=e.PrivateProfiles.smtprequiresauth;var AY=e.PrivateProfiles.smtpradiogroupvalue;for(var A2 in e.PrivateProfiles){e.PrivateProfiles[A2]=null}for(var A2 in e.PublicProfiles){e.PublicProfiles[A2]=null}for(var A2 in e.ProtectedProfiles){e.ProtectedProfiles[A2]=null}for(var A2 in e.Profiles){e.Profiles[A2]=null}e.save();if(AN=="0"){AN="1"}else{if(AN=="1"){AN="2"}else{if(AN=="2"){AN="3"}else{if(AN=="3"){AN="0"}}}}e.PrivateProfiles.accountType=parseInt(AN);e.PrivateProfiles.fullname=A3;e.PrivateProfiles.email=AX;e.PrivateProfiles.dummyPassword=AL;e.PrivateProfiles.password=AK;e.PrivateProfiles.pageSize=parseInt(AZ);e.PrivateProfiles.refreshInterval=parseInt(AR);e.PrivateProfiles.useSignature=AV?"1":"0";e.PrivateProfiles.signature=AU;if(AN=="0"){e.PrivateProfiles.userName=AQ;e.PrivateProfiles.pop3Server=A1;e.PrivateProfiles.pop3Port=parseInt(AM);e.PrivateProfiles.useSSL=AO;e.PrivateProfiles.smtpServer=AP;e.PrivateProfiles.smtpPort=parseInt(A0);e.PrivateProfiles.smtppassword=AT;e.PrivateProfiles.securePassword=AS;e.PrivateProfiles.smtprequiresauth=AJ}else{e.PrivateProfiles.userName="";e.PrivateProfiles.pop3Server="";e.PrivateProfiles.pop3Port="110";e.PrivateProfiles.useSSL="0";e.PrivateProfiles.smtpServer="";e.PrivateProfiles.smtpPort="110";e.PrivateProfiles.securePassword="0";e.PrivateProfiles.smtprequiresauth=false}this.loadSetting();this.saveSetting()};
this.getSetting=function(){var AJ=new MailClientAccountSetting();AJ.AccountType=parseInt(e.PrivateProfiles.accountType);AJ.FullName=e.PrivateProfiles.fullname;if(AJ.FullName==null){AJ.FullName=e.PrivateProfiles.fullname}AJ.Email=e.PrivateProfiles.email;AJ.Password=e.PrivateProfiles.password;AJ.TimeZone=-1;if(e.PrivateProfiles.timeZone!=null){AJ.TimeZone=parseInt(e.PrivateProfiles.timeZone)}if(this.isGenericPop3Account()){AJ.UserName=e.PrivateProfiles.userName;AJ.POP3Server=e.PrivateProfiles.pop3Server;AJ.POP3Port=parseInt(e.PrivateProfiles.pop3Port);AJ.POP3UseSSL=(e.PrivateProfiles.useSSL=="1")?true:false;AJ.SMTPServer=e.PrivateProfiles.smtpServer;AJ.SMTPPort=parseInt(e.PrivateProfiles.smtpPort);AJ.SMTPSecurePassword=(e.PrivateProfiles.securePassword=="1")?true:false;AJ.SMTPUserName=(e.PrivateProfiles.smtpusername);AJ.SMTPPassword=(e.PrivateProfiles.smtppassword);AJ.SMTPRequiresAuth=(e.PrivateProfiles.smtprequiresauth);AJ.SMTPRadioGroupValue=(e.PrivateProfiles.smtpradiogroupvalue)}else{if(this.isAOLAccount()){AJ.UserName=e.PrivateProfiles.userName;AJ.IMAPServer=e.PrivateProfiles.imapServer;AJ.IMAPPort=e.PrivateProfiles.imapPort;AJ.SMTPServer=e.PrivateProfiles.smtpServer;AJ.SMTPPort=parseInt(e.PrivateProfiles.smtpPort);AJ.SMTPUserName=(e.PrivateProfiles.smtpusername);AJ.SMTPPassword=(e.PrivateProfiles.smtppassword);AJ.SMTPSecurePassword=(e.PrivateProfiles.useSSL=="1"?true:false)}else{AJ.UserName="";AJ.POP3Server="";AJ.POP3Port=110;AJ.POP3UseSSL=false;AJ.SMTPServer="";AJ.SMTPPort=25;AJ.SMTPSecurePassword=false}}return AJ};
this.loadSetting=function(){this.selectListBoxByProfileKey(W,"accountType");this.changeAccount();this.loadTextBoxByProfileKey(d,"fullname","");this.loadTextBoxByProfileKey(o,"email","");this.loadTextBoxByProfileKey(O,"dummyPassword","");if(this.isGenericPop3Account()){this.loadTextBoxByProfileKey(y,"userName","");this.loadTextBoxByProfileKey(c,"pop3Server","");this.loadTextBoxByProfileKey(AH,"pop3Port","110");this.selectCheckBoxByProfileKey(Av,"useSSL",false);this.loadTextBoxByProfileKey(Ap,"smtpServer","");this.loadTextBoxByProfileKey(As,"smtpPort","25");this.selectCheckBoxByProfileKey(Au,"securePassword",false);this.loadTextBoxByProfileKey(m,"smtpusername","");this.loadTextBoxByProfileKey(T,"dummyPassword","")}else{y.value="";c.value="";AH.value="110";Av.checked=false;Ap.value="";As.value="25";Au.checked=false;Ab.checked=false}this.selectListBoxByProfileKey(t,"timeZone");this.selectListBoxByProfileKey(U,"pageSize");this.selectListBoxByProfileKey(s,"refreshInterval");this.selectCheckBoxByProfileKey(r,"useSignature",true);this.loadTextBoxByProfileKey(i,"signature","Sent from my www.Pageflakes.com startpage")};
this.saveSetting=function(){$nodisplay(AE);q.style.visibility="hidden";Aj.style.visibility="hidden";Am.style.visibility="hidden";D.style.visibility="hidden";E.style.visibility="hidden";n.style.visibility="hidden";k.style.visibility="hidden";AG.style.visibility="hidden";Ah.style.visibility="hidden";q.title="";Aj.title="";Am.title="";D.title="";E.title="";n.title="";k.title="";AG.title="";Ah.title="";if(o.value.length==0){q.style.visibility="visible";q.title="Email address cannot be blank.";$focus(o);return false}if(!this.isValidEmail(o.value)){q.style.visibility="visible";q.title="Invalid email address.";$focus(o);return false}var AO=this.isGenericPop3Account();if(AO){if(c.value.length==0){Am.style.visibility="visible";Am.title="POP3 server cannot be blank.";$focus(c);return false}if(Ap.value.length==0){D.style.visibility="visible";D.title="SMTP server cannot be blank.";$focus(Ap);return false}if(y.value.length==0){E.style.visibility="visible";E.title="User name cannot be blank.";$focus(y);return false}if(O.value.length==0){Aj.style.visibility="visible";Aj.title="Password cannot be blank.";$focus(O);return false}if(AH.value.length==0){n.style.visibility="visible";n.title="POP3 port cannot be blank.";$display(AD);return false}if(!this.isPositiveInteger(AH.value)){n.style.visibility="visible";n.title="Invalid POP3 port.";$display(AD);return false}if(As.value.length==0){k.style.visibility="visible";k.title="SMTP port cannot be blank.";$display(P);return false}if(!this.isPositiveInteger(As.value)){k.style.visibility="visible";k.title="Invalid SMTP port.";$display(P);return false}if(Ab.checked){if(u.checked){if(m.value.length==0){AG.style.visibility="visible";AG.title="User name cannot be blank.";$focus(m);return false}if(T.value.length==0){Ah.style.visibility="visible";Ah.title="Password cannot be blank.";$focus(T);return false}}}}else{if(O.value.length==0){Aj.style.visibility="visible";Aj.title="Password cannot be blank.";$focus(O);return false}}var AL=parseInt(W.options[W.selectedIndex].value);var AM=parseInt(e.PrivateProfiles.accountType);var AS=(AL!=AM);var AV=o.value;var AR=e.PrivateProfiles.email;var AN=(AV!=AR);var AT=false;if(AO){var AP=y.value;var AK=e.PrivateProfiles.userName;AT=(AP!=AK)}if(AS||AN||AT){MailClientService.DeleteAll(e.internalId,function(AW){},F(this,PageflakesUtility.dumpException))}e.PrivateProfiles.accountType=W.options[W.selectedIndex].value;e.PrivateProfiles.fullname=d.value;e.PrivateProfiles.email=o.value;if(S){var AU=this.createDummyPassword(O.value);var AQ=RsaSecurityHelper.encrypt(O.value);e.PrivateProfiles.dummyPassword=AU;e.PrivateProfiles.password=AQ;S=false}e.PrivateProfiles.timeZone=t.options[t.selectedIndex].value;e.PrivateProfiles.pageSize=U.options[U.selectedIndex].value;e.PrivateProfiles.refreshInterval=s.options[s.selectedIndex].value;e.PrivateProfiles.useSignature=r.checked?"1":"0";e.PrivateProfiles.signature=i.value;if(AO){e.PrivateProfiles.userName=y.value;e.PrivateProfiles.pop3Server=c.value;e.PrivateProfiles.pop3Port=AH.value;e.PrivateProfiles.useSSL=Av.checked?"1":"0";e.PrivateProfiles.smtpServer=Ap.value;e.PrivateProfiles.smtpPort=As.value;e.PrivateProfiles.securePassword=Au.checked?"1":"0";e.PrivateProfiles.smtpusername=m.value;if(L){var AJ=RsaSecurityHelper.encrypt(T.value);e.PrivateProfiles.smtppassword=AJ}e.PrivateProfiles.smtprequiresauth=Ab.checked;if(Ag.checked==true){e.PrivateProfiles.smtpradiogroupvalue=1}else{e.PrivateProfiles.smtpradiogroupvalue=2}}else{if(this.isAOLAccount()){e.PrivateProfiles.userName=y.value;e.PrivateProfiles.imapServer="imap.aol.com";e.PrivateProfiles.imapPort="143";e.PrivateProfiles.smtpServer="smtp.aol.com";e.PrivateProfiles.smtpPort="465";e.PrivateProfiles.useSSL="1"}}this.stopAutoRefresh();e.Profiles["ver1.5"]=true;e.save();e.hideEditArea();this.refresh()};
this.createDummyPassword=function(AJ){var AL="";for(var AK=0;AK<AJ.length;AK++){AL+="x"}return AL};
this.onclose=function(){this.stopAutoRefresh()};
this.reset=function(){Z=0;b=0;l=0;Ay=0;v=new Array()};
this.refresh=function(){At.reset();At.loadInbox(true)};
this.isGenericPop3Account=function(){return(W.options[W.selectedIndex].value=="0")};
this.isAOLAccount=function(){return(W.options[W.selectedIndex].value=="11")};
this.changeAccount=function(){X.innerHTML="";if(this.isGenericPop3Account()){$display(C);$display(AD);$display(P)}else{$nodisplay(C);$nodisplay(AD);$nodisplay(P);MailClientService.GetServerConfigNote(e.internalId,W.options[W.selectedIndex].value,F(this,this.onChangeAccountSuccess),F(this,PageflakesUtility.dumpException))}};
this.onChangeAccountSuccess=function(AJ){X.innerHTML=AJ};
this.startAutoRefresh=function(){var AJ=0;if(e.PrivateProfiles.refreshInterval!=null){AJ=parseInt(e.PrivateProfiles.refreshInterval)}if(AJ>0){if(j==null){var AK=(AJ*(1000*60));j=setInterval(this.refresh,AK)}}};
this.stopAutoRefresh=function(){if(j!=null){clearInterval(j);j=null}};
this.loadInbox=function(AK){var AJ=parseInt(e.PrivateProfiles.pageSize);var AL=(Z*AJ);e.disableRefresh();$nodisplay(AB);$nodisplay(AF);$display(Ai);$display(J);R.innerHTML='<div><img alt="" src="indicator.gif">&nbsp;Loading List...</div>';$display(R);$display(I);$nodisplay(a);$nodisplay(h);App.startWork(e.id);MailClientService.GetList(e.internalId,AK,this.getSetting(),AL,AJ,F(this,this.onLoadInbox),F(this,this.onLoadInboxException))};
this.onLoadInboxException=function(AK){R.innerHTML="";$nodisplay(R);var AJ="";if(AK==null){AJ="An unexpected error has occurred while processing your request."}else{AJ=AK.get_message()}Az.innerHTML='<span style="color:#ff0000">'+AJ+"</span>";$display(AE);e.showEditArea();$display(AB);$nodisplay(Ai);PageflakesUtility.dumpException(AK);App.endWork(e.id)};
this.onLoadInbox=function(AK){R.innerHTML="";$nodisplay(R);if((AK==null)||(AK.Total==0)||(AK.Headers==null)||(AK.Headers.length==0)){this.reset()}else{for(var AJ=0;AJ<AK.Headers.length;AJ++){v.push(AK.Headers[AJ])}Ay=AK.Total}this.showInbox();App.endWork(e.id)};
this.showInbox=function(){if((v==null)||(v.length==0)){I.innerHTML='<table border="0" cellpadding="3" cellspacing="0" style="width:100%"><tbody><tr><td style="width:50%"></td><td style="text-align:center;vertical-align:middle;white-space:nowrap">Inbox is empty</td><td style="width:50%"></td></tr></tbody></table>'}else{var AU=parseInt(e.PrivateProfiles.pageSize);var AL=new Array();var AW=(b*AU);var AK=(AW+(AU-1));var AN;for(AN=0;AN<v.length;AN++){if((AN>=AW)&&(AN<=AK)){AL.push(v[AN]);if(AN==AK){break}}}var AP=new Sys.StringBuilder();A=new Array();AP.append('<table border="0" cellpadding="0" cellspacing="0" style="width:100%"><tbody>');for(AN=0;AN<AL.length;AN++){var AR=f+"chkSelect"+AL[AN].ID;var AM=(AL[AN].Status==1)?";font-weight:bold":"";var AT=(AN==AL.length-1)?"":";border-bottom:solid 1px #cccccc";var AJ=v.indexOf(AL[AN]);AP.append("<tr onmouseover=\"this.style.backgroundColor='#d8d8d8'\" onmouseout=\"this.style.backgroundColor='#f1eded'\">");AP.append('<td style="text-align:right;vertical-align:top;cursor:pointer'+AT+';width:1%">');AP.append('<input id="'+AR+'" type="checkbox"/>');AP.append("</td>");AP.append('<td onclick="'+f+".loadMail("+AL[AN].ID+", "+AJ+')" style="text-align:left;vertical-align:top;padding-left:2px;padding-right:2px;cursor:pointer'+AT+';width:75%">');AP.append('<div style="text-align:left">');AP.append(this.getNameOnly(AL[AN].From));AP.append("</div>");AP.append('<div style="text-align:left;padding-top:2px;padding-bottom:4px'+AM+'">');AP.append(this.wrapText(AL[AN].Subject,48));AP.append("</div>");AP.append("</td>");AP.append('<td onclick="'+f+".loadMail("+AL[AN].ID+", "+AJ+')" style="text-align:right;vertical-align:top;padding-right:4px;cursor:pointer'+AT+';white-space:nowrap;width:1%">');AP.append(this.formatDateTime(AL[AN].Received));AP.append("</td>");AP.append("</tr>");A.push(AR)}var AO=0;if(Ay>AU){if((Ay%AU)==0){AO=(Ay/AU)}else{AO=(Math.floor(Ay/AU)+1)}}else{AO=1}var AQ=(b>0)?"inline":"none";var AS=(b<(AO-1))?"inline":"none";var AV=window.IMAGE_PREFIX;AP.append("<tr style='background-color=#dcdcdc'>");AP.append("<td colspan='3' width='100%' style='text-align=left;padding-left=2px'>");AP.append("<table border='0' cellpadding='4' cellspacing='0' width=100%'><tbody>");AP.append("<tr>");AP.append("<td style='text-align:left;width:100%'>");AP.append("<select onchange='"+f+".performAction(this)'>");AP.append("<option value='0'>Select an action...</option>");AP.append("<option value='4'>Select all</option>");AP.append("<option value='5'>Deselect all</option>");AP.append("<option value='2'>Mark selected as read</option>");AP.append("<option value='1'>Mark selected as unread</option>");AP.append("<option value='3'>Delete selected</option>");AP.append("</select>");AP.append("</td>");AP.append("<td style='text-align:right;padding-right:4px;white-space:nowrap'>");AP.append("<img src='"+AV+"flakes/amit/MailClient/Images/previous.gif' alt='Previous' style='cursor:pointer;display:"+AQ+"' onclick='"+f+".listMovePrevious()' />");AP.append("<span style='font-weight:bold'> "+(b+1)+"</span>");AP.append("<span> of </span>");AP.append("<span style='font-weight:bold'>"+AO+" </span>");AP.append("<img src='"+AV+"flakes/amit/MailClient/Images/next.gif' alt='Next' style='cursor:pointer;display:"+AS+"' onclick='"+f+".listMoveNext()' />");AP.append("</td>");AP.append("</tr>");AP.append("</tbody></table>");AP.append("</td>");AP.append("</tr>");AP.append("</tbody></table>");I.innerHTML=AP.toString()}$nodisplay(AB);$nodisplay(AF);$display(Ai);$display(J);$nodisplay(R);$display(I);$nodisplay(a);$nodisplay(h);e.disableRefresh();this.startAutoRefresh();e.enableRefresh()};
this.listMovePrevious=function(){b-=1;this.showInbox()};
this.listMoveNext=function(){b+=1;var AJ=parseInt(e.PrivateProfiles.pageSize);var AK=((b+1)*AJ);if(v.length<AK){if(v.length<Ay){Z+=1;this.loadInbox(false)}else{this.showInbox()}}else{this.showInbox()}};
this.performAction=function(AJ){var AK=parseInt(AJ.options[AJ.selectedIndex].value);if(AK==0){}else{if(AK==4){At.selectChechBox(true)}else{if(AK==5){At.selectChechBox(false)}else{this.updateStatus(AK,this.getCheckedMails())}}}};
this.getCheckedMails=function(){var AJ=new Array();if((A!=null)&&(A.length)){for(var AL=0;AL<A.length;AL++){var AM=$(A[AL]);if((AM!=null)&&(AM.checked)){var AK=parseInt(this.replaceText(AM.id,f+"chkSelect",""));AJ.push(AK)}}}return AJ};
this.getMailHeader=function(AK){if((v==null)||(v.length==0)){return null}for(var AJ=0;AJ<v.length;AJ++){if(v[AJ].ID==AK){return v[AJ]}}return null};
this.updateStatus=function(AJ,AL){if(AL.length>0){App.startWork(e.id);if(AJ==3){At.reset();MailClientService.UpdateStatus(e.internalId,AJ,AL,function(AN){At.loadInbox(false)},F(this,this.onUpdateStatusException))}else{for(var AM=0;AM<v.length;AM++){for(var AK=0;AK<v.length;AK++){if(v[AM].ID==AL[AK]){v[AM].Status=AJ}}}this.showInbox();MethodQueue.add((f+"changeStatus"+(new Date()).toString()),100,true,function(){MailClientService.UpdateStatus(e.internalId,AJ,AL,function(AN){},F(this,this.onUpdateStatusException))})}}};
this.onUpdateStatusException=function(AJ){PageflakesUtility.dumpException(AJ);App.endWork(e.id)};
this.selectChechBox=function(AK){if((A==null)||(A.length==0)){return}for(var AJ=0;AJ<A.length;AJ++){$(A[AJ]).checked=AK}};
this.loadMail=function(AK,AL){l=AL;e.disableRefresh();$nodisplay(AB);$display(AF);$display(Ai);$display(J);R.innerHTML='<div><img alt="" src="indicator.gif">&nbsp;Loading Mail...</div>';$display(R);$nodisplay(I);$display(a);$nodisplay(h);var AJ=this.getMailHeader(AK);this.showMail(AJ);this.stopAutoRefresh()};
this.showMail=function(AJ){var AO=new Sys.StringBuilder();AO.append("<strong>From:</strong> "+this.getNameOnly(AJ.From)+"<br/>");AO.append("<strong>Subject:</strong> "+AJ.Subject+"<br/>");AO.append("<strong>To:</strong> "+this.getNameOnly(AJ.To)+"<br/>");if(AJ.CC!=null){if(AJ.CC.length>0){AO.append("<strong>Cc:</strong> "+AJ.CC+"<br/>")}}var AQ=(l>0)?"inline":"none";var AN=(l<(Ay-1))?"inline":"none";var AK="flakes/amit/MailClient/MailView.aspx?flakeId="+e.internalId+"&mailId="+AJ.ID;var AP=new Sys.StringBuilder();var AM=window.IMAGE_PREFIX;AP.append('<table border="0" cellpadding="0" cellspacing="0" style="width:100%">');AP.append("<tbody>");AP.append("<tr>");AP.append('<td style="text-align:left;padding-left:8px;padding-right:8px;padding-top:8px">');AP.append('<div style="border:solid 1px #cccccc;padding:4px;background-color:#ffffff">');AP.append(AO.toString());AP.append("</div>");AP.append("</td>");AP.append("</tr>");AP.append("<tr>");AP.append('<td style="text-align:left;padding-left:8px;padding-right:8px">');AP.append('<div style="background-color:#ffffff">');AP.append('<iframe id="'+f+'ifrMailView" scrolling="auto" frameborder="0" style="text-align:center;vertical-align:middle;border:none;margin:0px;width:100%;height:160px" src="'+AK+'" onload="'+f+'.onMailLoaded()"></iframe>');AP.append("</div>");AP.append("</td>");AP.append("</tr>");AP.append("<tr>");AP.append('<td style="text-align:left;padding-left:8px;padding-right:8px;padding-top:8px">');AP.append('<div style="background-color:#dcdcdc">');AP.append('<table border="0" cellpadding="0" cellspacing="0" style="width:100%">');AP.append("<tbody>");AP.append("<tr>");AP.append('<td style="text-align:left;padding:4px">');AP.append('<input id="'+f+'btnDelete" type="button" style="border:#999 1px solid;background:#f2f2f2 url("../common/button_back.gif") repeat-x" value="Delete" onclick="'+f+".deleteMail('"+AJ.ID+"')\"/>");AP.append("</td>");AP.append('<td style="text-align:right;padding-right:4px;width:100%">');AP.append('<img src="'+AM+'flakes/amit/MailClient/Images/previous.gif" alt="Previous" style="cursor:pointer;display:'+AQ+'" onclick="'+f+'.itemMovePrevious()"/>&nbsp;&nbsp;');AP.append('<img src="'+AM+'flakes/amit/MailClient/Images/next.gif" alt="Next" style="cursor:pointer;display:'+AN+'" onclick="'+f+'.itemMoveNext()"/>');AP.append("</td>");AP.append("</tr>");AP.append("</tbody>");AP.append("</table>");AP.append("<div>");AP.append("</td>");AP.append("</tr>");AP.append("<tr>");AP.append('<td style="text-align:left;padding-left:12px;padding-right:8px;padding-top:4px;padding-bottom:4px">');AP.append('<input id="'+f+'btnReply" type="button" class="button" value="Reply" onclick="'+f+".replyMail('"+AJ.ID+'\')" disabled="true"/>&nbsp;');AP.append('<input id="'+f+'btnForward" type="button" class="button" value="Forward" onclick="'+f+".forwardMail('"+AJ.ID+'\')" disabled="true"/>');AP.append("</td>");AP.append("</tr>");AP.append("</tbody>");AP.append("</table>");a.innerHTML=AP.toString();if(AJ.Status==1){AJ.Status=2;var AL=new Array();AL.push(AJ.ID);MethodQueue.add((f+AJ.ID+"readStatus"),1500,true,function(){MailClientService.UpdateStatus(e.internalId,AJ.Status,AL,function(AR){},F(this,this.onUpdateStatusException))})}
};
this.onMailLoaded=function(){R.innerHTML="";$nodisplay(R);$((f+"btnReply")).disabled=false;$((f+"btnForward")).disabled=false};
this.itemMovePrevious=function(){var AJ=(l-1);var AK=v[AJ].ID;this.loadMail(AK,AJ)};
this.itemMoveNext=function(){var AJ=(l+1);if(AJ<=(v.length-1)){var AK=v[AJ].ID;this.loadMail(AK,AJ)}else{l=AJ;MailClientService.GetList(e.internalId,false,this.getSetting(),v.length,parseInt(e.PrivateProfiles.pageSize),F(this,this.onGetListSuccess),F(this,this.onGetListException))}
};
this.onGetListSuccess=function(AL){for(var AK=0;AK<AL.Headers.length;AK++){v.push(AL.Headers[AK])}var AJ=v[l].ID;At.loadMail(AJ,l)};
this.onGetListException=function(AJ){R.innerHTML="";$nodisplay(R);Az.innerHTML=AJ.get_message();$display(AE);e.showEditArea();$display(AB);$nodisplay(Ai);PageflakesUtility.dumpException(AJ);App.endWork(e.id)};
this.deleteMail=function(AK){var AJ=new Array();AJ.push(AK);this.updateStatus(3,AJ)};
this.replyMail=function(AO){var AK=this.getMailHeader(AO);var AN=$((f+"ifrMailView")).contentWindow.document;var AM=AN.body.innerHTML;var AL="RE: "+AK.Subject;var AQ=this.getEmailPartOnly(AK.From);var AP="";if(AK.CC.length>0){AP=this.getEmailPartOnly(AK.CC)}var AJ=this.formatBodyForReplyOrForward(AM);
this.composeMail(AQ,AL,AP,"",AJ);$focus(Aw)};
this.forwardMail=function(AO){var AK=this.getMailHeader(AO);var AN=$((f+"ifrMailView")).contentWindow.document;var AM=AN.body.innerHTML;var AL="FW: "+AK.Subject;var AJ=this.formatBodyForReplyOrForward(AM);this.composeMail("",AL,"","",AJ);$focus(K)};
this.composeMail=function(AN,AL,AM,AK,AJ){e.disableRefresh();
this.stopAutoRefresh();$nodisplay(AB);$nodisplay(AF);$nodisplay(J);$display(h);Y.innerHTML="";$nodisplay(Y);$nodisplay(Ax);An.innerHTML="";$nodisplay(An);$nodisplay(M);AC.innerHTML="";$nodisplay(AC);w.innerHTML="";$nodisplay(w);Aw.value="";K.value="";G.value="";H.value="";V.value="";Aw.value="";if(AN.length>0){K.value=AN}if(AL.length>0){G.value=AL}if(AM.length>0){H.value=AM}if(AK.length>0){V.value=AK}if(AJ.length>0){Aw.value=AJ}};
this.sendMail=function(){Y.innerHTML="";$nodisplay(Y);An.innerHTML="";$nodisplay(An);AC.innerHTML="";$nodisplay(AC);w.innerHTML="";$nodisplay(w);if(K.value.trim().length==0){Y.innerHTML='<span style="color:#ff0000">At least one recipient must be specified.</span>';$display(Y);$focus(K);return}if(!this.validateEmailList(K,Y)){return}if(H.value.trim().length>0){try{if(!this.validateEmailList(H,An)){$display(Ax);return}}catch(AK){$display(Ax);return}}if(V.value.trim().length>0){try{if(!this.validateEmailList(V,AC)){$display(M);return}}catch(AK){$display(M);return}}w.innerHTML='<div><img alt="" src="indicator.gif">&nbsp;Sending mail...</div>';$display(w);x.disabled=true;Ak.disabled=true;App.startWork(e.id);var AJ=this.appendSignature(Aw.value.trim());MailClientService.Send(e.internalId,K.value.trim(),H.value.trim(),V.value.trim(),G.value.trim(),AJ,this.getSetting(),F(this,this.onSendSuccess),F(this,this.onSendException))};
this.onSendSuccess=function(AJ){At.showInbox();x.disabled=false;Ak.disabled=false};
this.onSendException=function(AJ){w.innerHTML="";$nodisplay(w);x.disabled=false;Ak.disabled=false;Az.innerHTML=AJ.get_message();$display(AE);e.showEditArea();$display(AB);$nodisplay(Ai);PageflakesUtility.dumpException(AJ);App.endWork(e.id)};
this.onIEEditKeyDown=function(){if(event.keyCode==13){event.returnValue=false;event.cancel=true;Aa.focus();Aa.click()}};
this.onMozillaEditKeyDown=function(AJ){if(AJ.which==13){AJ.returnValue=false;AJ.cancel=true;Aa.focus();Aa.click()}};
this.validateEmailList=function(AJ,AL){var AK=AJ.value.trim();if(AK.indexOf(";")>-1){if(!this.isValidEmailList(AK,";")){AL.innerHTML='<span style="color:#ff0000">One or more email address is not in valid format.</span>';$display(AL);AJ.select();$focus(AJ);return false}}else{if(AK.indexOf(",")>-1){if(!this.isValidEmailList(AK,",")){AL.innerHTML='<span style="color:#ff0000">One or more email address is not in valid format.</span>';$display(AL);AJ.select();$focus(AJ);return false}}else{if(AK.indexOf(" ")>-1){if(!this.isValidEmailList(AK," ")){AL.innerHTML='<span style="color:#ff0000">One or more email address is not in valid format.</span>';$display(AL);AJ.select();$focus(AJ);return false}}else{if(!this.isValidEmail(AK)){AL.innerHTML='<span style="color:#ff0000">Email address is not in valid format.</span>';$display(AL);AJ.select();$focus(AJ);return false}}}}return true};
this.appendSignature=function(AJ){if(e.PrivateProfiles.useSignature=="1"){AJ+="\r\n";AJ+="______________________________________";AJ+="\r\n";AJ+=e.PrivateProfiles.signature}return AJ};
this.convertHtmlToText=function(AJ){AJ=this.replaceText(AJ,"\r"," ");AJ=this.replaceText(AJ,"\n"," ");AJ=this.replaceText(AJ,"\t","");AJ=AJ.replace(/<br\/>/ig,"\r\n");AJ=AJ.replace(/<br>/ig,"\r\n");AJ=AJ.replace(/&nbsp;/ig," ");AJ=AJ.replace(/&quot;/ig,'"');AJ=AJ.replace(/&apos;/ig,"'");AJ=AJ.replace(/&#8217;/ig,"");AJ=AJ.replace(/&gt;/ig,">");AJ=AJ.replace(/&lt;/ig,"<");AJ=AJ.replace(/&amp;/ig,"&");return AJ};
this.convertTextToHtml=function(AJ){AJ=this.replaceText(AJ,"\r\n","<br/>");return AJ};
this.formatBodyForReplyOrForward=function(AN){AN=this.convertHtmlToText(AN);var AL=/<\S[^><]*>/g;AN=AN.replace(AL,"");var AK=new Array();AK=AN.split("\r\n");var AM=new String();AM="\r\n";for(var AJ=0;AJ<AK.length;AJ++){AM+=">"+AK[AJ]+"\r\n"}return"\r\n\r\n"+AM};
this.getEmailPartOnly=function(AM){var AL=AM.match(/<[^>]*>/g,AM);if(AL!=null){var AJ=new String();for(var AK=0;AK<AL.length;AK++){AJ+=AL[AK]}}else{AJ=AM}AJ=AJ.replace("<","");AJ=AJ.replace(">","");return AJ};
this.getNameOnly=function(AK){var AJ=AK.replace(/<[^>]*>/g,"");if(AJ==""){return this.getEmailPartOnly(AK)}AK=AJ.replace(/"/g,"");return AK};
this.formatDateTime=function(AM){var AL=new Date();var AJ=this.convertStringToDateTime(AM);var AN="";if((AL.getFullYear()==AJ.getFullYear())&&(AL.getMonth()==AJ.getMonth())&&(AL.getDate()==AJ.getDate())){AN=this.formatTime(AJ)}else{if(AL.getFullYear()!=AJ.getFullYear()){AN=this.getDayAbbr(AJ)+", "+this.getMonthAbbr(AJ)+" "+AJ.getDate().toString()+", "+AJ.getFullYear().toString()}else{var AK=((((1000*60)*60)*24)*7);if((AL.getTime()-AJ.getTime())>AK){AN=this.getDayAbbr(AJ)+", "+this.getMonthAbbr(AJ)+" "+AJ.getDate().toString()}else{AN=this.getDayAbbr(AJ)+", "+this.formatTime(AJ)}}}return AN};
this.formatTime=function(AL){var AJ=AL.getHours();var AM=AL.getMinutes();var AK="AM";if(AJ>11){AJ-=12;AK="PM"}if(AJ==0){AJ=12}AJ=AJ.toString();AM=AM.toString();if(AM.length==1){AM="0"+AM}return AJ+":"+AM+" "+AK};
this.convertStringToDateTime=function(AN){var AP=0;var AO=0;var AR=0;var AL=0;var AK=0;var AJ=0;var AT=AN.split(" ");var AS=AT[0].split("/");var AQ=AT[1].split(":");AP=parseInt(AS[0],10);AO=parseInt(AS[1],10);AR=parseInt(AS[2],10);AL=parseInt(AQ[0],10);AK=parseInt(AQ[1],10);AJ=parseInt(AQ[2],10);var AM=new Date(AP,(AO-1),AR,AL,AK,AJ,0);return AM};
this.getMonthAbbr=function(AJ){var AK=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");return AK[AJ.getMonth()]};
this.getDayAbbr=function(AK){var AJ=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat");return AJ[AK.getDay()]};
this.toggleDisplay=function(AJ){if(AJ.style.display=="none"){AJ.style.display=""}else{AJ.style.display="none"}};
this.selectCheckBoxByProfileKey=function(AL,AK,AJ){if(AJ!=null){AL.checked=AJ}if(e.PrivateProfiles[AK]!=null){AL.checked=(e.PrivateProfiles[AK]=="1")?true:false}};
this.selectListBoxByProfileKey=function(AK,AJ){if(e.PrivateProfiles[AJ]!=null){this.selectListBoxByValue(AK,e.PrivateProfiles[AJ])}};
this.loadTextBoxByProfileKey=function(AL,AK,AJ){AL.value=AJ;if(e.PrivateProfiles[AK]!=null){AL.value=e.PrivateProfiles[AK]}};
this.selectListBoxByValue=function(AL,AK){AL.selectedIndex=0;for(var AJ=0;AJ<AL.options.length;AJ++){if(AL.options[AJ].value==AK){AL.selectedIndex=AJ;break}}};
this.isPositiveInteger=function(AK){if(AK==null){return false}var AJ=parseInt(AK);if(isNaN(AJ)){return false}return(AJ>0)};
this.replaceText=function(AM,AJ,AL){var AK=AM.split(AJ);AK=AK.join(AL);return AK};
this.wrapText=function(AK,AJ){AK=AK.trim();if(AJ==null){AJ=48}if(AK.length>AJ){AK=AK.substring(0,(AJ-3));AK+="..."}return AK};
this.isValidEmailList=function(AL,AK){var AM=AL.trim().split(AK);if((AM!=null)&&(AM.length>0)){for(var AJ=0;AJ<AM.length;AJ++){if(AM[AJ].trim().length>0){if(!this.isValidEmail(AM[AJ].trim())){return false}}}}return true};
this.isValidEmail=function(AK){var AJ=/^([a-zA-Z0-9_\-\.\:]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;return AJ.test(AK)}};
var CalendarEventService=function(){CalendarEventService.initializeBase(this);this._timeout=0;this._userContext=null;this._succeeded=null;this._failed=null};CalendarEventService.prototype={IsValidiCals:function(C,D,B,A,E){return this._invoke(CalendarEventService.get_path(),"IsValidiCals",true,{flakeId:C,urls:D},B,A,E)},Create:function(E,C,B,D,A,F){return this._invoke(CalendarEventService.get_path(),"Create",false,{flakeId:E,calendarEvent:C,setting:B},D,A,F)},Update:function(E,C,B,D,A,F){return this._invoke(CalendarEventService.get_path(),"Update",false,{flakeId:E,calendarEvent:C,setting:B},D,A,F)},Delete:function(C,E,B,A,D){return this._invoke(CalendarEventService.get_path(),"Delete",false,{flakeId:C,id:E},B,A,D)},DeleteAll:function(C,B,A,D){return this._invoke(CalendarEventService.get_path(),"DeleteAll",false,{flakeId:C},B,A,D)},GetById:function(D,A,F,C,B,E){return this._invoke(CalendarEventService.get_path(),"GetById",true,{flakeId:D,timeZone:A,id:F},C,B,E)},GetView:function(E,B,A,F,D,C,G){return this._invoke(CalendarEventService.get_path(),"GetView",true,{flakeId:E,timeZone:B,startDate:A,endDate:F},D,C,G)}};CalendarEventService.registerClass("CalendarEventService",Sys.Net.WebServiceProxy);CalendarEventService._staticInstance=new CalendarEventService();CalendarEventService.set_path=function(A){CalendarEventService._staticInstance._path=A};CalendarEventService.get_path=function(){return CalendarEventService._staticInstance._path};CalendarEventService.set_timeout=function(A){CalendarEventService._staticInstance._timeout=A};CalendarEventService.get_timeout=function(){return CalendarEventService._staticInstance._timeout};CalendarEventService.set_defaultUserContext=function(A){CalendarEventService._staticInstance._userContext=A};CalendarEventService.get_defaultUserContext=function(){return CalendarEventService._staticInstance._userContext};CalendarEventService.set_defaultSucceededCallback=function(A){CalendarEventService._staticInstance._succeeded=A};CalendarEventService.get_defaultSucceededCallback=function(){return CalendarEventService._staticInstance._succeeded};CalendarEventService.set_defaultFailedCallback=function(A){CalendarEventService._staticInstance._failed=A};CalendarEventService.get_defaultFailedCallback=function(){return CalendarEventService._staticInstance._failed};CalendarEventService.set_path(SITE_PREFIX+"flakes/amit/Calendarevent/CalendarEventService.soap");CalendarEventService.IsValidiCals=function(B,C,D,A,E){CalendarEventService._staticInstance.IsValidiCals(B,C,D,A,E)};CalendarEventService.Create=function(D,C,B,E,A,F){CalendarEventService._staticInstance.Create(D,C,B,E,A,F)};CalendarEventService.Update=function(D,C,B,E,A,F){CalendarEventService._staticInstance.Update(D,C,B,E,A,F)};CalendarEventService.Delete=function(B,E,C,A,D){CalendarEventService._staticInstance.Delete(B,E,C,A,D)};CalendarEventService.DeleteAll=function(B,C,A,D){CalendarEventService._staticInstance.DeleteAll(B,C,A,D)};CalendarEventService.GetById=function(C,A,F,D,B,E){CalendarEventService._staticInstance.GetById(C,A,F,D,B,E)};CalendarEventService.GetView=function(D,B,A,E,F,C,G){CalendarEventService._staticInstance.GetView(D,B,A,E,F,C,G)};var gtc=Sys.Net.WebServiceProxy._generateTypedConstructor;if(typeof(CalendarEvent)==="undefined"){var CalendarEvent=gtc("CalendarEvent");CalendarEvent.registerClass("CalendarEvent")}if(typeof(CalendarEventReminderSetting)==="undefined"){var CalendarEventReminderSetting=gtc("CalendarEventReminderSetting");CalendarEventReminderSetting.registerClass("CalendarEventReminderSetting")}if(typeof(CalendarView)==="undefined"){var CalendarView=gtc("CalendarView");CalendarView.registerClass("CalendarView")}function CalendarEventFlake(a){var x="flakes/amit/CalendarEvent/";var Am=window.IMAGE_PREFIX+x+"Images/";var Ab={MONTHVIEW:Am+"MonthView.png",DAYVIEW:Am+"DayView.png",EDITOR:Am+"AddEvent.png"};var D={MONTHVIEW:Am+"MonthViewPressed.png",DAYVIEW:Am+"DayViewPressed.png",EDITOR:Am+"AddEvent.png"};var o={PREVIOUS:Am+"previous.gif",NEXT:Am+"next.gif"};var e={MONTHVIEW:0,DAYVIEW:1,EDITOR:2};var C="timeZone";var Ap="email";var Ao=new Array(new Array("No tag",""),new Array("Birthday","Birthday"),new Array("Business meeting","Business meeting"),new Array("Deadline","Deadline"),new Array("Private event","Private event"));var c;var n;var v;var g;var Y;var V;var Z;var s;var l;var m;var Q;var y;var Ac;var Aj;var M;var N;var An;var W;var h;var Ag;var J;var u;var X;var I;var B;var b;var E;var Ad;var R;var d;var k;var S;var Aq;var r;var z;var H;var i;var q;var j;var f;var Ae;var Aa;var F;var P;var K;var L;var G;var Af;var Al;var A;var t;var w;var As;var T=0;var Av="";var U="";var O="";var Au="";
var Ah=0;
var Ai;
var p=e.MONTHVIEW;
var At=new Date;
var Ar=this;
this.load=function(Aw){
    var Ax=window.IMAGE_PREFIX;Aw.body.innerHTML='<div class="flake_body"> <div style="background-color:#ffffff"> <div id="'+a+'divToolbar" style="background-color:#646464;padding:3px;display:block"> <table border="0" cellpadding="0" cellspacing="0" width="100%"> <tbody>  <tr>  <td style="text-align:left;vertical-align:middle;white-space:nowrap">  <img id="'+a+'imgMonthView" alt="Month view" title="Month view" src="'+Ax+'flakes/amit/CalendarEvent/Images/MonthViewPressed.png" style="cursor:pointer" />  </td>  <td style="text-align:left;vertical-align:middle;white-space:nowrap">  <img id="'+a+'imgDayView" alt="Day view" title="Day view" src="'+Ax+'flakes/amit/CalendarEvent/Images/DayView.png" style="cursor:pointer" />  </td>  <td style="text-align:right;vertical-align:middle;width:100%">  <img id="'+a+'imgEventSep" alt="" src="'+Ax+'flakes/amit/CalendarEvent/Images/sep.png" />  <img id="'+a+'imgEventEditor" alt="Add event" title="Add event" src="'+Ax+'flakes/amit/CalendarEvent/Images/AddEvent.png" style="cursor:pointer" />  </td>  </tr> </tbody> </table> </div> <div id="'+a+'divWorkspace"> <div id="'+a+'divMonthView" style="padding:8px;display:none"> <div id="'+a+'divMonthViewTitle" style="background-color:#e6e6e6;width:100%">  <table>  <tbody>  <tr>  <td style="text-align:left;vertical-align:middle;padding-left:4px">   <img id="'+a+'imgMonthPrevious" alt="Previous" src="'+Ax+'flakes/amit/CalendarEvent/Images/previous.gif" style="cursor:pointer" title="Previous Month" />  </td>  <td style="text-align:center;vertical-align:middle;width:100%">   <span id="'+a+'spnMonthTitle"></span>  </td>  <td style="text-align:right;vertical-align:middle;padding-right:4px">   <img id="'+a+'imgMonthNext" alt="Next" src="'+Ax+'flakes/amit/CalendarEvent/Images/next.gif" style="cursor:pointer" title="Next Month" />  </td>  </tr>  </tbody>  </table> </div> <div id="'+a+'divMonthViewContent" style="text-align:center;vertical-align:middle;padding-top:3px;height:140px;width:100%"></div> </div> <div id="'+a+'divDayView" style="padding:8px;display:none"> <div id="'+a+'divDayViewTitle" style="background-color:#e6e6e6;width:100%">  <table>  <tbody>  <tr>  <td style="text-align:left;vertical-align:middle;padding-left:4px">   <img id="'+a+'imgDayPrevious" alt="Previous" src="'+Ax+'flakes/amit/CalendarEvent/Images/previous.gif" style="cursor:pointer" title="Previous Day" />  </td>  <td style="text-align:center;vertical-align:middle;width:100%">   <span id="'+a+'spnDayTitle"></span>  </td>  <td style="text-align:right;vertical-align:middle;padding-right:4px">   <img id="'+a+'imgDayNext" alt="Next" src="'+Ax+'flakes/amit/CalendarEvent/Images/next.gif" style="cursor:pointer" title="Next Day" />  </td>  </tr>  </tbody>  </table> </div> <div id="'+a+'divDayViewContent" style="text-align:center;vertical-align:middle;padding-top:2px;height:140px;width:100%"></div> </div> <div id="'+a+'divEditor" style="display:none" class="add"> <h2 id="'+a+'divEditorTitle">Event</h2> <div id="'+a+'divEditorContent">  <table border="0" cellpadding="2" cellspacing="0" style="width:100%">  <tbody>  <tr>  <td style="text-align:left;vertical-align:top" width="20%">   <label for="'+a+'txtTitle" class="calendarAddLabel">Title:</label>  </td>  <td style="text-align:left;vertical-align:middle;">   <input id="'+a+'hidId" type="hidden" />   <input id="'+a+'txtTitle" class="calendarAddInput" type="text" size="32" maxlength="256" style="width:95%" />  </td>  </tr>  <tr>  <td></td>  <td style="text-align:left;vertical-align:middle;width:100%">   <span id="'+a+'spnTitleMessage" style="color:#ff0000;visibility:hidden"></span>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:top" width="20%">   <label for="'+a+'txtDescription" class="calendarAddLabel">Description:</label>  </td>  <td style="text-align:left;vertical-align:middle;">   <textarea id="'+a+'txtDescription" class="calendarAddInput" rows="6" cols="20" style="width:95%"></textarea>  </td>  </tr>  <tr>  <td colspan="2"></td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle" width="20%">   <label for="'+a+'ddlMonth" class="calendarAddLabel">Date:</label>  </td>  <td style="text-align:left;vertical-align:middle;">   <select id="'+a+'ddlMonth" class="calendarAddSelect">   <option value="1">January</option>   <option value="2">February</option>   <option value="3">March</option>   <option value="4">April</option>   <option value="5">May</option>   <option value="6">June</option>   <option value="7">July</option>   <option value="8">August</option>   <option value="9">September</option>   <option value="10">October</option>   <option value="11">November</option>   <option value="12">December</option>   </select>   <select id="'+a+'ddlDay" class="calendarAddSelect">   <option value="1">1</option>   <option value="2">2</option>   <option value="3">3</option>   <option value="4">4</option>   <option value="5">5</option>   <option value="6">6</option>   <option value="7">7</option>   <option value="8">8</option>   <option value="9">9</option>   <option value="10">10</option>   <option value="11">11</option>   <option value="12">12</option>   <option value="13">13</option>   <option value="14">14</option>   <option value="15">15</option>   <option value="16">16</option>   <option value="17">17</option>   <option value="18">18</option>   <option value="19">19</option>   <option value="20">20</option>   <option value="21">21</option>   <option value="22">22</option>   <option value="23">23</option>   <option value="24">24</option>   <option value="25">25</option>   <option value="26">26</option>   <option value="27">27</option>   <option value="28">28</option>   <option value="29">29</option>   <option value="30">30</option>   <option value="31">31</option>   </select>   <select id="'+a+'ddlYear" class="calendarAddSelect">   <option value="2006">2006</option>   <option value="2007">2007</option>   <option value="2008">2008</option>   <option value="2009">2009</option>   <option value="2010">2010</option>   </select>  </td>  </tr>  <tr>  <td></td>  <td style="text-align:left;vertical-align:middle;width:100%">   <span id="'+a+'spnDateMessage" style="color:#ff0000;visibility:hidden"></span>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:middle" width="20%">   <label for="'+a+'ddlHour" class="calendarAddLabel">Start Time:</label>  </td>  <td style="text-align:left;vertical-align:middle;">   <select id="'+a+'ddlHour" class="calendarAddSelect">   <option value="">--</option>   <option value="1">1</option>   <option value="2">2</option>   <option value="3">3</option>   <option value="4">4</option>   <option value="5">5</option>   <option value="6">6</option>   <option value="7">7</option>   <option value="8">8</option>   <option value="9">9</option>   <option value="10">10</option>   <option value="11">11</option>   <option value="12">12</option>   </select>   <select id="'+a+'ddlMinute" class="calendarAddSelect">   <option value="">--</option>   <option value="0">00</option>   <option value="5">05</option>   <option value="10">10</option>   <option value="15">15</option>   <option value="20">20</option>   <option value="25">25</option>   <option value="30">30</option>   <option value="35">35</option>   <option value="40">40</option>   <option value="45">45</option>   <option value="50">50</option>   <option value="55">55</option>   </select>   <select id="'+a+'ddlAmPm" class="calendarAddSelect">   <option value="">--</option>   <option value="am">AM</option>   <option value="pm">PM</option>   </select>  </td>  </tr>  <tr>  <td></td>  <td style="text-align:left;vertical-align:middle;width:100%">   <span id="'+a+'spnTimeMessage" style="color:#ff0000;visibility:hidden"></span>  </td>  </tr>  <tr>  <td style="text-align:left;vertical-align:top" width="20%">   <label for="'+a+'ddlTag" class="calendarAddLabel">Tag:</label>  </td>  <td style="text-align:left;vertical-align:middle;">   <select id="'+a+'ddlTag" class="calendarAddSelect"></select>  </td>  </tr>  <tr>  <td colspan="2"></td>  </tr>  <tr>  <td style="text-align:left;vertical-align:top">   <label for="'+a+'chkReminder" class="calendarAddLabel">Reminder:</label>  </td>  <td style="text-align:left;vertical-align:middle;width:100%">   <label for="'+a+'chkReminder" class="calendarAddLabel"><input id="'+a+'chkReminder" type="checkbox" class="calendarAddInput" /> Send reminder</label>   <div id="'+a+'divReminder" style="text-align:left;vertical-align:top;display:none; clear:left;">   <input id="'+a+'hidReminderRefID" type="hidden" />   <select id="'+a+'ddlReminderHour" class="calendarAddSelect">   <option value="0">0 hours</option>   <option value="1">1 hours</option>   <option value="2">2 hours</option>   <option value="3">3 hours</option>   <option value="4">4 hours</option>   <option value="5">5 hours</option>   <option value="6">6 hours</option>   <option value="7">7 hours</option>   <option value="8">8 hours</option>   <option value="9">9 hours</option>   <option value="10">10 hours</option>   <option value="11">11 hours</option>   <option value="12">12 hours</option>   </select>   <select id="'+a+'ddlReminderMinute" class="calendarAddSelect">   <option value="0">00 min</option>   <option value="5" selected="selected">05 min</option>   <option value="10">10 min</option>   <option value="15">15 min</option>   <option value="20">20 min</option>   <option value="25">25 min</option>   <option value="30">30 min</option>   <option value="35">35 min</option>   <option value="40">40 min</option>   <option value="45">45 min</option>   <option value="50">50 min</option>   <option value="55">55 min</option>   </select>   <span class="calendarAddLabel">&nbsp;before event</span>   </div>   <div id="'+a+'divReminderMessage" style="text-align:left;vertical-align:top;color:#ff0000;display:none"></div>   <div id="'+a+'divReminderSettingMessage" style="text-align:left;vertical-align:top;display:none">   <a id="'+a+'lnkReminderMessage" href="javascript:void(0)" class="calendarAddLabel">Please select your time zone and enter your email address.</a>   </div>  </td>  </tr>  <tr>  <td colspan="2"></td>  </tr>  <tr>  <td></td>  <td style="text-align:left;vertical-align:middle;width:100%">   <span id="'+a+'spnEditorMessage" style="visibility:hidden"></span>  </td>  </tr>  <tr>  <td>  </td>  <td style="text-align:left;vertical-align:middle;width:100%">   <table border="0" cellpadding="0" cellspacing="0" width="100%">   <tbody>   <tr>   <td style="text-align:left;vertical-align:middle">    <input type="button" id="'+a+'btnSave" class="button" value="Save" />    <input type="button" id="'+a+'btnCancel" class="button cancel" value="Cancel" />   </td>   <td style="text-align:right;vertical-align:middle">    <img id="'+a+'imgDelete" alt="Delete" title="Delete event" style="cursor:pointer;visibility:hidden" src="'+Ax+'flakes/amit/CalendarEvent/Images/DeleteEvent.gif" />   </td>   </tr>   </tbody>   </table>  </td>  </tr>  </tbody>  </table> </div> </div> </div> </div> </div>';Aw.setEditArea('<div class="error" style="display:none;" id="'+a+'divEditEmailMessage"> <ul> <li><span id="'+a+'divEditEmailMessageError">There is a problem with something</span></li> </ul> </div> <div class="spacer">&nbsp;</div> <table border="0" cellpadding="1" cellspacing="1" style="width:100%"> <tbody> <tr>  <td style="text-align:left;vertical-align:top" colspan="3">  <strong><label for="'+a+'ddlTimeZone">Time Zone</label></strong>&nbsp;<span style="font-size:smaller">(Required to send email on correct due time)</span>  </td> </tr> <tr>  <td style="text-align:left;vertical-align:top" colspan="3">  <select id="'+a+'ddlTimeZone" style="width:100%">  <option selected="selected" value="-1">[Choose a time zone]</option>  <option value="0">(GMT-12:00) International Date Line West</option>  <option value="1">(GMT-11:00) Midway Island, Samoa</option>  <option value="2">(GMT-10:00) Hawaii</option>  <option value="16387">(GMT-09:00) Alaska</option>  <option value="16388">(GMT-08:00) Pacific Time (US &amp; Canada), Tijuana</option>  <option value="15">(GMT-07:00) Arizona</option>  <option value="16397">(GMT-07:00) Chihuahua, La Paz, Mazatlan</option>  <option value="16394">(GMT-07:00) Mountain Time (US &amp; Canada)</option>  <option value="33">(GMT-06:00) Central America</option>  <option value="16404">(GMT-06:00) Central Time (US &amp; Canada)</option>  <option value="16414">(GMT-06:00) Guadalajara, Mexico City, Monterrey</option>  <option value="25">(GMT-06:00) Saskatchewan</option>  <option value="45">(GMT-05:00) Bogota, Lima, Quito</option>  <option value="16419">(GMT-05:00) Eastern Time (US &amp; Canada)</option>  <option value="40">(GMT-05:00) Indiana (East)</option>  <option value="16434">(GMT-04:00) Atlantic Time (Canada)</option>  <option value="55">(GMT-04:00) Caracas, La Paz</option>  <option value="16440">(GMT-04:00) Santiago</option>  <option value="16444">(GMT-03:30) Newfoundland</option>  <option value="16449">(GMT-03:00) Brasilia</option>  <option value="70">(GMT-03:00) Buenos Aires, Georgetown</option>  <option value="16457">(GMT-03:00) Greenland</option>  <option value="16459">(GMT-02:00) Mid-Atlantic</option>  <option value="16464">(GMT-01:00) Azores</option>  <option value="83">(GMT-01:00) Cape Verde Is.</option>  <option value="90">(GMT) Casablanca, Monrovia</option>  <option value="16469">(GMT) Greenwich Mean Time : Dublin, Edinburgh,</option>  <option value="16494">(GMT+01:00) Amsterdam, Berlin, Bern, Rome,</option>  <option value="16479">(GMT+01:00) Belgrade, Bratislava, Budapest,</option>  <option value="16489">(GMT+01:00) Brussels, Copenhagen, Madrid, Paris</option>  <option value="16484">(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb</option>  <option value="113">(GMT+01:00) West Central Africa</option>  <option value="16514">(GMT+02:00) Athens, Beirut, Istanbul, Minsk</option>  <option value="16499">(GMT+02:00) Bucharest</option>  <option value="16504">(GMT+02:00) Cairo</option>  <option value="140">(GMT+02:00) Harare, Pretoria</option>  <option value="16509">(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn,</option>  <option value="135">(GMT+02:00) Jerusalem</option>  <option value="16542">(GMT+03:00) Baghdad</option>  <option value="150">(GMT+03:00) Kuwait, Riyadh</option>  <option value="16529">(GMT+03:00) Moscow, St. Petersburg, Volgograd</option>  <option value="155">(GMT+03:00) Nairobi</option>  <option value="16544">(GMT+03:30) Tehran</option>  <option value="165">(GMT+04:00) Abu Dhabi, Muscat</option>  <option value="16554">(GMT+04:00) Baku, Tbilisi, Yerevan</option>  <option value="175">(GMT+04:30) Kabul</option>  <option value="16564">(GMT+05:00) Ekaterinburg</option>  <option value="185">(GMT+05:00) Islamabad, Karachi, Tashkent</option>  <option value="190">(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi</option>  <option value="193">(GMT+05:45) Kathmandu</option>  <option value="16585">(GMT+06:00) Almaty, Novosibirsk</option>  <option value="195">(GMT+06:00) Astana, Dhaka</option>  <option value="200">(GMT+06:00) Sri Jayawardenepura</option>  <option value="203">(GMT+06:30) Rangoon</option>  <option value="205">(GMT+07:00) Bangkok, Hanoi, Jakarta</option>  <option value="16591">(GMT+07:00) Krasnoyarsk</option>  <option value="210">(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi</option>  <option value="16611">(GMT+08:00) Irkutsk, Ulaan Bataar</option>  <option value="215">(GMT+08:00) Kuala Lumpur, Singapore</option>  <option value="225">(GMT+08:00) Perth</option>  <option value="220">(GMT+08:00) Taipei</option>  <option value="235">(GMT+09:00) Osaka, Sapporo, Tokyo</option>  <option value="230">(GMT+09:00) Seoul</option>  <option value="16624">(GMT+09:00) Yakutsk</option>  <option value="16634">(GMT+09:30) Adelaide</option>  <option value="245">(GMT+09:30) Darwin</option>  <option value="260">(GMT+10:00) Brisbane</option>  <option value="16639">(GMT+10:00) Canberra, Melbourne, Sydney</option>  <option value="275">(GMT+10:00) Guam, Port Moresby</option>  <option value="16649">(GMT+10:00) Hobart</option>  <option value="16654">(GMT+10:00) Vladivostok</option>  <option value="280">(GMT+11:00) Magadan, Solomon Is., New Caledonia</option>  <option value="16674">(GMT+12:00) Auckland, Wellington</option>  <option value="285">(GMT+12:00) Fiji, Kamchatka, Marshall Is.</option>  <option value="300">(GMT+13:00) Nuku\'alofa</option>  </select>  <div id="'+a+'divEditTimeZoneMessage" style="text-align:left;vertical-align:top;padding-top:2px;display:none">  <span style="color:#ff0000">Please choose a time zone.</span>  </div>  </td> </tr> <tr>  <td colspan="3"><div class="spacer">&nbsp;</div></td> </tr> <tr>  <td style="text-align:left;vertical-align:top" colspan="3">  <strong><label for="'+a+'txtEmail">Email Reminder</label></strong>&nbsp;<span style="font-size:smaller">(can be turned on/off for every event, seperate by comma)</span>  </td> </tr> <tr>  <td width="25%"><label for="'+a+'txtEmail">Email address:</label></td>  <td width="65%" style="text-align:left;vertical-align:middle;width:95%;"><input id="'+a+'txtEmail" type="text" style="width:95%;" /></td>  <td width="5%"><div style="width:16px; height:16px;">&nbsp;</div></td> </tr> <tr>  <td colspan="3"><div class="spacer">&nbsp;</div></td> </tr> </tbody> </table> <table border="0" cellpadding="1" cellspacing="1" style="width:100%"> <tbody> <tr>  <td style="text-align:left;vertical-align:top" colspan="2">  <strong>iCal Subscriptions</strong>  </td> </tr> </tbody> </table> <div id="'+a+'iCals" style="width: 100%;"></div> <table border="0" cellpadding="1" cellspacing="1" style="width:100%"> <tbody> <tr> <td width="25%">&nbsp;</td> <td width="65%" style="text-align:left;vertical-align:middle">&nbsp;</td> <td width="5%" align="right"><img src="'+Ax+'flakes/amit/CalendarEvent/Images/add.png" style="cursor:pointer; margin-bottom:-3px;" onClick="'+a+'.addNewiCal();" title="Add new iCal subscription" /></td> </tr> <tr> <td colspan="3">Tip: Hundreds of <a href="http://en.wikipedia.org/wiki/ICalendar" target="_blank">iCal web calendars</a> can be found at <a href="http://www.icalshare.com" target="_blank">Calshare</a> and <a href="http://www.datedex.com" target="_blank">DateDex</a>.</td> </tr> </tbody> </table> <div id="'+a+'saveWait" align="center" style="display:none; text-align:center; font-weight:bold; margin:5px 0 5px 0;">Please wait while we validate iCal sources...<img src="'+Ax+'indicator.gif" /></div> <table border="0" cellpadding="1" cellspacing="1" style="width:100%"> <tbody> <tr> <td colspan="3" align="center"> <input type="button" id="'+a+'btnSaveSetting" class="button" value="Save" /> <input type="button" id="'+a+'btnCancelSetting" class="button cancel" value="Cancel" /> </td> </tr> </tbody> </table>');c=Aw;c.body.style.padding="0px";c.setIcon(window.IMAGE_PREFIX+"images/flakes/iCalIcon.gif");n=$(a+"ddlTimeZone");v=$(a+"divEditTimeZoneMessage");g=$(a+"txtEmail");Y=$(a+"divEditEmailMessage");_divEditEmailMessageError=$(a+"divEditEmailMessageError");V=$(a+"btnSaveSetting");Z=$(a+"btnCancelSetting");s=$(a+"iCals");Ai=$(a+"saveWait");l=$(a+"divToolbar");m=$(a+"imgMonthView");Q=$(a+"imgDayView");y=$(a+"imgEventSep");Ac=$(a+"imgEventEditor");Aj=$(a+"divMonthView");M=$(a+"divMonthViewTitle");N=$(a+"imgMonthPrevious");An=$(a+"spnMonthTitle");W=$(a+"imgMonthNext");h=$(a+"divMonthViewContent");Ag=$(a+"divDayView");J=$(a+"divDayViewTitle");u=$(a+"imgDayPrevious");X=$(a+"spnDayTitle");I=$(a+"imgDayNext");B=$(a+"divDayViewContent");b=$(a+"divEditor");E=$(a+"divEditorTitle");Ad=$(a+"divEditorContent");R=$(a+"spnEditorMessage");d=$(a+"hidId");k=$(a+"txtTitle");S=$(a+"spnTitleMessage");Aq=$(a+"txtDescription");r=$(a+"ddlYear");z=$(a+"ddlMonth");H=$(a+"ddlDay");i=$(a+"spnDateMessage");q=$(a+"ddlHour");j=$(a+"ddlMinute");f=$(a+"ddlAmPm");Ae=$(a+"spnTimeMessage");Aa=$(a+"ddlTag");F=$(a+"chkReminder");P=$(a+"divReminder");K=$(a+"hidReminderRefID");L=$(a+"ddlReminderHour");G=$(a+"ddlReminderMinute");Af=$(a+"divReminderMessage");Al=$(a+"divReminderSettingMessage");A=$(a+"lnkReminderMessage");t=$(a+"btnSave");w=$(a+"btnCancel");As=$(a+"imgDelete");setTimeout(a+".refreshCalArea()",500);if(c.title=="Calender"){c.setTitle("Calendar");c.save()}if(!c.page.CanChangeFlake){y.style.visibility="hidden";Ac.style.visibility="hidden"}c.beforeClose=function(){TooltipManager.hideTooltip();if(confirm("If you remove your calendar, all your events data will be lost. Are you sure that you want to remove your Calendar Flake?")){if(c.page.CanChangeFlake){CalendarEventService.DeleteAll(c.internalId,function(Ay){},function(Ay){PageflakesUtility.dumpException(Ay)})}return true}};n.onchange=function(Ay){if(this.selectedIndex==0){v.style.display="block"}else{v.style.display="none"}};g.onchange=function(Ay){if((Ar.trimText(this.value)).length==0){}else{Ar.showErrorMsg("",false)}};g.onblur=function(Az){if((Ar.trimText(this.value)).length==0){}else{var AA=Ar.trimText(this.value);var Ay=false;if(AA.indexOf(";")>-1){Ay=Ar.isValidEmailList(AA,";")}else{if(AA.indexOf(",")>-1){Ay=Ar.isValidEmailList(AA,",")}else{if(AA.indexOf(" ")>-1){Ay=Ar.isValidEmailList(AA," ")}else{Ay=Ar.isValidEmail(AA)}}}if(!Ay){Ar.showErrorMsg("One of your specified reminder emails is not valid.",true)}else{Ar.showErrorMsg("",false)}}};V.onclick=function(Ay){Ar.saveSetting()};Z.onclick=function(Ay){Ar.cancelSetting()};m.onclick=function(Ay){TooltipManager.hideTooltip();if(p==e.MONTHVIEW){return}Ar.showMonthView(At)};Q.onclick=function(Ay){TooltipManager.hideTooltip();if(p==e.DAYVIEW){return}Ar.showDayView(At)};Ac.onclick=function(Ay){TooltipManager.hideTooltip();Ar.showEditor(0)};N.onclick=function(Az){TooltipManager.hideTooltip();var Ay=new Date(At.getFullYear(),At.getMonth(),At.getDate());Ay.setDate(1);Ay.setMonth(Ay.getMonth()-1);var AA=Ar.getDaysInMonth(Ay.getFullYear(),(Ay.getMonth()+1));At.setDate(1);At.setMonth(At.getMonth()-1);At.setDate(AA);Ar.showMonthView(At)};W.onclick=function(Ay){TooltipManager.hideTooltip();At.setDate(1);At.setMonth(At.getMonth()+1);Ar.showMonthView(At)};u.onclick=function(Ay){TooltipManager.hideTooltip();At.setDate(At.getDate()-1);Ar.showDayView(At)};I.onclick=function(Ay){TooltipManager.hideTooltip();At.setDate(At.getDate()+1);Ar.showDayView(At)};k.onchange=function(Ay){if(Ar.trimText(this.value).length>0){Ar.setText(S,"");S.style.visibility="hidden"}};r.onchange=function(Ay){Ar.loadDayDropDownList();Ar.clearDateErrorsIfValid()};z.onchange=function(Ay){Ar.loadDayDropDownList();Ar.clearDateErrorsIfValid()};H.onchange=function(Ay){Ar.clearDateErrorsIfValid()};q.onchange=function(Ay){Ar.clearTimeErrorsIfValid()};j.onchange=function(Ay){Ar.clearTimeErrorsIfValid()};f.onchange=function(Ay){Ar.clearTimeErrorsIfValid()};F.onclick=function(Ay){P.style.display="none";Af.style.display="none";Al.style.display="none";if(this.checked){if(Ar.canHaveReminder()){P.style.display="block";Ar.clearReminderErrorsIfValid()}else{Al.style.display="block"}}};A.onclick=function(Ay){c.showEditArea();n.focus()};L.onchange=function(Ay){Ar.clearReminderErrorsIfValid()};L.onchange=function(Ay){Ar.clearReminderErrorsIfValid()};t.onclick=function(Ay){Ar.save()};w.onclick=function(Ay){if(p==e.MONTHVIEW){m.src=D.MONTHVIEW;Q.src=Ab.DAYVIEW;Ac.src=Ab.EDITOR;l.style.display="block";Aj.style.display="block";Ag.style.display="none";b.style.display="none"}else{if(p==e.DAYVIEW){m.src=Ab.MONTHVIEW;Q.src=D.DAYVIEW;Ac.src=Ab.EDITOR;l.style.display="block";Aj.style.display="none";Ag.style.display="block";b.style.display="none"}}c.enableRefresh()};As.onclick=function(Ay){Ar.remove()};if(ie){k.onkeydown=this.onIESaveKeyDown;r.onkeydown=this.onIESaveKeyDown;z.onkeydown=this.onIESaveKeyDown;H.onkeydown=this.onIESaveKeyDown;q.onkeydown=this.onIESaveKeyDown;j.onkeydown=this.onIESaveKeyDown;f.onkeydown=this.onIESaveKeyDown;Aa.onkeydown=this.onIESaveKeyDown;F.onkeydown=this.onIESaveKeyDown;L.onkeydown=this.onIESaveKeyDown;G.onkeydown=this.onIESaveKeyDown;n.onkeydown=this.onIESaveSettingKeyDown;g.onkeydown=this.onIESaveSettingKeyDown}else{k.onkeydown=this.onMozillaSaveKeyDown;r.onkeydown=this.onMozillaSaveKeyDown;z.onkeydown=this.onMozillaSaveKeyDown;H.onkeydown=this.onMozillaSaveKeyDown;q.onkeydown=this.onMozillaSaveKeyDown;j.onkeydown=this.onMozillaSaveKeyDown;f.onkeydown=this.onMozillaSaveKeyDown;Aa.onkeydown=this.onMozillaSaveKeyDown;F.onkeydown=this.onMozillaSaveKeyDown;L.onkeydown=this.onMozillaSaveKeyDown;G.onkeydown=this.onMozillaSaveKeyDown;n.onkeydown=this.onMozillaSaveSettingKeyDown;g.onkeydown=this.onMozillaSaveSettingKeyDown}if(c.ProtectedProfiles[C]!=null){T=parseInt(c.ProtectedProfiles[C],10)}else{if(c.page.CanChangeFlake){if(App.My.TimeZone!=null){T=App.My.Timezone}else{T=0}c.ProtectedProfiles[C]=T;if(c.page.IsOwner){c.Profiles[C]=T}c.save()}else{if(c.Profiles[C]!=null){T=c.Profiles[C]}}}if(c.Profiles[Ap]!=null){Av=c.Profiles[Ap]}this.selectListBoxByValue(n,T.toString());g.value=Av;this.loadDayDropDownList();this.loadTagDropDownList();this.loadiCals();if(p==e.MONTHVIEW){Ar.showMonthView(At)}else{if(p==e.DAYVIEW){Ar.showDayView(At)}}};
    this.loadiCals=function(){if(c.Profiles.urls!=null){U=c.Profiles.urls;O=c.Profiles.colors;Au=c.Profiles.show}else{U="";O="#0000ff";Au="1"}Ar.showCals(50)};
    this.showCals=function(AC){var Ay=new Sys.StringBuilder();var AA=U.split("|");var Ax=O.split("|");var Az=Au.split("|");var Aw=new Array("#0000ff","#ff0000","#00cc00","#ff9900","#999999");for(var AB=0;AB<AA.length;AB++){Ay.append(Ar.getCalArea(AB,AA[AB],Ax[AB],Az[AB]))}s.innerHTML=Ay.toString();Ah=AA.length};
    this.addNewiCal=function(){Ar.refreshCalValues();U+="|";O+="|#0000ff";Au+="|1";Ar.showCals(50)};
    this.removeiCal=function(Az){Ar.refreshCalValues();var Ay=U.split("|");var Aw=O.split("|");var Ax=Au.split("|");Ay=Ar.selectNotIndexed(Ay,Az);Aw=Ar.selectNotIndexed(Aw,Az);Ax=Ar.selectNotIndexed(Ax,Az);U=Ay.join("|");O=Aw.join("|");Au=Ax.join("|");Ar.showCals(50)};
    this.refreshCalValues=function(){var Ax=new Array();var Aw=new Array();for(var Ay=0;Ay<Ah;Ay++){Ax.push($(a+"txtiCalURL"+Ay).value);Aw.push(($(a+"chkiCalShow"+Ay).checked==true)?"1":"0")}U=Ax.join("|");Au=Aw.join("|")};
    this.loadCalValues=function(){var Aw=U.split("|");for(var Ax=0;Ax<Ah;Ax++){$(a+"txtiCalURL"+Ax).value=Aw[Ax]}Ar.refreshCalArea()};
    this.refreshCalArea=function(){var Az=0;var Aw=U.split("|");if(c==null){return}if(c.div==null){return}switch(c.div.offsetWidth){case 975:case 979:Az=666;break;case 482:case 484:Az=315;break;case 285:case 291:Az=165;break;case 679:case 678:Az=453;break;case 319:case 320:Az=196;break;case 236:case 240:Az=140;break;case 483:case 479:Az=315;break;case 237:Az=140;break;default:Az=c.div.offsetWidth*0.625}for(var Ax=0;Ax<Ah;Ax++){var Ay=$(a+"txtiCalURL"+Ax);if(Ay!=null){Ay.style.width=Az}}g.style.width=Az;setTimeout(a+".refreshCalArea()",500)};
    this.chooseCalColor=function(AA,Ay){var Az;var Ax=O.split("|");var Aw=new Array("#0000ff","#ff0000","#00cc00","#ff9900","#999999");for(var AB=0;AB<Aw.length;AB++){Az=$(a+"btnColor"+AA+AB);if(Aw[AB]!=Ay){Az.style.border="none";Az.style.width="16px";Az.style.height="16px"}else{Az.style.border="2px solid #000000";Az.style.width="18px";Az.style.height="18px"}}Ax[AA]=Ay;O=Ax.join("|")};
    this.selectNotIndexed=function(Aw,Ay){var Ax=[];for(var Az=0;Az<Aw.length;Az++){if(Az!=Ay){Ax.push(Aw[Az])}}return Ax};
    this.getCalArea=function(AC,AB,Az,Ay){var Ax=new Sys.StringBuilder();var AD="";var Aw=new Array("#0000ff","#ff0000","#00cc00","#ff9900","#999999");Ax.append('<table border="0" cellpadding="1" cellspacing="1" style="width:100%">');Ax.append("<tbody>");Ax.append("<tr>");Ax.append('<td width="25%" style="text-align:left;vertical-align:middle;white-space:nowrap">');Ax.append('<label for="'+a+"txtiCalURL"+AC+'">iCal URL:</label>');Ax.append("</td>");Ax.append('<td width="65%" style="text-align:left;vertical-align:middle;width:95%">');Ax.append('<input id="'+a+"txtiCalURL"+AC+'" type="text" style="width:240px" value="'+AB+'"/>');Ax.append("</td>");Ax.append('<td width="5%" style="text-align:left;vertical-align:middle">');if(AC>0){Ax.append('<img src="'+window.IMAGE_PREFIX+'flakes/amit/CalendarEvent/Images/delete.png" style="cursor:pointer" onclick="'+a+".removeiCal("+AC+')" title="Remove this iCal subscription" />')}else{Ax.append('<div style="height:16px;width:16px;">&nbsp;</div>')}Ax.append("</td>");Ax.append("</tr>");Ax.append("<tr>");Ax.append('<td width="25%" style="text-align:left;vertical-align:middle;white-space:nowrap">Color:</td>');Ax.append('<td width="65%" style="text-align:left;vertical-align:middle;width:100%">');for(var AA=0;AA<Aw.length;AA++){if(Aw[AA]==Az){Ax.append('<input type="button" id="'+a+"btnColor"+AC+AA+'" style="width:18px;height:18px;border:2px solid #000000;background-color:'+Aw[AA]+';cursor: pointer" onclick="'+a+".chooseCalColor("+AC+", '"+Aw[AA]+"')\" />&nbsp;")}else{Ax.append('<input type="button" id="'+a+"btnColor"+AC+AA+'" style="width:16px;height:16px;border:0px;background-color:'+Aw[AA]+';cursor:pointer" onclick="'+a+".chooseCalColor("+AC+", '"+Aw[AA]+"')\"/>&nbsp;")}}Ax.append("</td>");Ax.append('<td width="5%"><div style="height:16px;width:16px;">&nbsp;</div></td>');Ax.append("</tr>");Ax.append("<tr>");Ax.append('<td width="25%" style="text-align:left;vertical-align:middle;;white-space:nowrap"><label for="'+a+"chkiCalShow"+AC+'">Show:</label></td>');AD=(Ay==1)?' checked="checked"':"";Ax.append('<td width="65%" style="text-align:left;vertical-align:middle;width:100%"><input id="'+a+"chkiCalShow"+AC+'" type="checkbox"'+AD+' style="margin-left:0px;@margin-left:-4px;"/></td>');Ax.append('<td width="5%"><div style="height:16px;width:16px;">&nbsp;</div></td>');Ax.append("</tr>");Ax.append("</tbody>");Ax.append("</table>");Ax.append('<hr class="my_settings_break"/><div class="spacer">&nbsp;</div>');return Ax.toString()};
    this.refresh=function(){if(p==e.MONTHVIEW){this.showMonthView(At)}else{if(p==e.DAYVIEW){this.showDayView(At)}}};
    this.onIESaveKeyDown=function(){if(event.keyCode==13){event.returnValue=false;event.cancel=true;t.focus();t.click()}};
    this.onMozillaSaveKeyDown=function(Aw){if(Aw.which==13){Aw.returnValue=false;Aw.cancel=true;t.focus();t.click()}};
    this.onIESaveSettingKeyDown=function(){if(event.keyCode==13){event.returnValue=false;event.cancel=true;V.focus();V.click()}};
    this.onMozillaSaveSettingKeyDown=function(Aw){if(Aw.which==13){Aw.returnValue=false;Aw.cancel=true;V.focus();V.click()}};
    this.loadTagDropDownList=function(){this.clearListBox(Aa);for(var Aw=0;Aw<Ao.length;Aw++){this.addListBoxItem(Aa,Ao[Aw][0],Ao[Aw][1])}Aa.selectedIndex=0};
    this.loadDayDropDownList=function(){var Az=parseInt(r.options[r.selectedIndex].value,10);var Ay=parseInt(z.options[z.selectedIndex].value,10);var AA=0;if(H.selectedIndex>-1){AA=parseInt(H.options[H.selectedIndex].value,10)}var Aw=(this.getDaysInMonth(Az,Ay)+1);this.clearListBox(H);for(var Ax=1;Ax<Aw;Ax++){this.addListBoxItem(H,Ax.toString(),Ax.toString())}if(AA>0){this.selectListBoxByValue(H,AA.toString())}};
    this.showMonthView=function(AD){TooltipManager.hideTooltip();c.enableRefresh();m.src=D.MONTHVIEW;Q.src=Ab.DAYVIEW;Ac.src=Ab.EDITOR;p=e.MONTHVIEW;var AE=this.getMonthName(AD)+" "+AD.getFullYear().toString();this.setText(An,AE);h.innerHTML='<div style="text-align:left;vertical-align:middle">Loading...<div>';h.style.height="140px";Aj.style.display="block";Ag.style.display="none";b.style.display="none";l.style.display="block";var Ay=new Date(AD.getFullYear(),AD.getMonth(),1);var Az=Ay.getDay();Ay.setDate(Ay.getDate()-Az);var Ax=Ar.getDaysInMonth(AD.getFullYear(),(AD.getMonth()+1));var AF=Math.ceil((Az+Ax)/7);var AB=Ar.addDays(Ay,(7*(AF-1)));var AC=Ar.addDays(AB,6);var Aw=this.getStartDateTime(Ay);var AA=this.getEndDateTime(AC);App.startWork(c.id);CalendarEventService.GetView(c.internalId,T,Aw,AA,function(AG){Ar.onShowMonthViewSuccess(AG)},function(AG){h.innerHTML='<span style="color:#ff0000">An unexpected error has occurred while retrieving your calendar.</span>';App.endWork(c.id);PageflakesUtility.dumpException(AG)})};
    this.onShowMonthViewSuccess=function(AF){var Ay=new Date(At.getFullYear(),At.getMonth(),1);var AD=Ay.getDay();var AJ=new Array();var Az=new Array();Ay.setDate(Ay.getDate()-AD);var AO=Ar.getDaysInMonth(At.getFullYear(),(At.getMonth()+1));var AE=Math.ceil((AD+AO)/7);var AG=new Sys.StringBuilder();AG.append('<table border="0" cellpadding="2" cellspacing="0" style="width:100%"><tbody><tr>');for(var AL=0;AL<7;AL++){AG.append('<td style="text-align:center;vertical-align:middle;background-color:#f1f6fc;padding:2px;font-weight:bold;width:14%">');AG.append(Ar.getDayAbbr(Ar.addDays(Ay,AL)));AG.append("</td>")}AG.append("</tr>");var AN=new Date;for(var AA=0;AA<AE;AA++){AG.append("<tr>");var AM=Ar.addDays(Ay,(7*AA));for(var Ax=0;Ax<7;Ax++){var AH=Ar.addDays(AM,Ax);AG.append('<td onmouseover="this.style.backgroundColor=\'#d9d2d1\'" style="cursor:pointer;text-align:right;vertical-align:top;border:solid 1px #f1f6fc;padding-right:1px;');if((AH.getDate()==AN.getDate())&&(AH.getMonth()==AN.getMonth())&&(AH.getFullYear()==AN.getFullYear())){AG.append('background-color:#ffffcc"');AG.append(" onmouseout=\"this.style.backgroundColor='#ffffcc'\"")}else{AG.append('background-color:#ffffff"');AG.append(" onmouseout=\"this.style.backgroundColor='#ffffff'\"")}AG.append(' onclick="'+a+".showDayViewFromMonthView("+AH.getFullYear().toString()+", "+AH.getMonth().toString()+", "+AH.getDate().toString()+')">');var Aw=Ar.getEvents(AF,AH);if((Aw!=null)&&(Aw.length>0)){var AK="";var AC="";if(Aw.length>6){AG.append('<div style="float:left"><table cellpadding="0" cellspacing="1" style="margin-top:2px;width:15px"><tbody>');for(var AL=0;AL<6;AL++){AC="tdEvt"+a+Aw[AL].ID.toString();AK=Aw[AL].Color;AG.append("<tr>");AG.append('<td id="'+AC+'" style="height:2px;background-color:'+AK+'"></td>');AJ.push(AC);Az.push(Ar.buildTip(Aw[AL],true));if(Aw.length>(AL+6)){AC="tdEvt"+a+Aw[AL+6].ID.toString();AK=Aw[AL+6].Color;AG.append('<td id="'+AC+'" style="height:2px;background-color:'+AK+'"></td>');AJ.push(AC);Az.push(Ar.buildTip(Aw[AL+6]),true)}else{AG.append("<td>")}AG.append("</td>");AG.append("</tr>")}AG.append("</tbody></table></div>")}else{var AI="4px";if(Aw.length>4){AI="2px"}AG.append('<div style="float:left"><table cellpadding="0" cellspacing="1" style="margin-top:2px;width:15px"><tbody>');for(var AL=0;AL<Aw.length;AL++){AG.append("<tr>");AC="tdEvt"+a+Aw[AL].ID.toString();AK=Aw[AL].Color;AG.append('<td id="'+AC+'" style="height:'+AI+";background-color:"+AK+'"></td>');AG.append("</tr>");AJ.push(AC);Az.push(Ar.buildTip(Aw[AL],true))}AG.append("</tbody></table></div>")}}AG.append('<div style="float:right;text-align:right;vertical-align:top">');AG.append('<a href="javascript:void(0)" style="text-decoration:none;width:100%;color:');if(At.getMonth()==AH.getMonth()){AG.append('#333333"')}else{AG.append('#999999"')}AG.append(' onclick="'+a+".showDayViewFromMonthView("+AH.getFullYear().toString()+", "+AH.getMonth().toString()+", "+AH.getDate().toString()+')"<a>');AG.append(AH.getDate().toString());AG.append("</a>");AG.append("</div>");AG.append("</td>")}AG.append("</tr>")}AG.append("<tbody></table>");h.innerHTML=AG.toString();h.style.height="";for(var AL=0;AL<AJ.length;AL++){var AB=$(AJ[AL]);if(AB!=null){if(Az[AL].length>0){TooltipManager.setTooltip(AB,Az[AL])}}}App.endWork(c.id)};
    this.getTagColor=function(Aw){var Ay=new Array("#0000ff","#ff0000","#00cc00","#ff9900","#999999");for(var Ax=0;Ax<Ao.length;Ax++){if(Ao[Ax][1]==Aw){return Ay[Ax]}}};
    this.buildTip=function(AC,Ay){var AB;var AA="";var Aw=Aw=AC.Tag;if(AC.Description.length>0){AA=this.wrapText(AC.Description,255)}var AD=new Sys.StringBuilder();AD.append('<div style="text-align:left;vertical-align:top">');if(Ay){AD.append('<div style="text-align:left;vertical-align:top"><span style="font-weight:bold">'+this.wrapText(AC.Title,64)+"</span></div>");AB=true}if(AA.length>0){AD.append('<div style="text-align:left;vertical-align:top"><span>'+AA+"</span></div>");AB=true}if(Aw.length>0){AD.append('<div style="text-align:left;vertical-align:top"><span style="font-weight:bold">Tag: </span><span>'+Aw+"</span></div>");AB=true}if(AC.Due.indexOf("00:00:00")==-1){var Ax=Ar.convertStringToDateTime(AC.Due);var Az=Ar.formatEventTime(Ax);AD.append('<div style="text-align:left;vertical-align:top"><span style="font-weight:bold">Time: </span><span>'+Az+"</span></div>");AB=true}AD.append("</div>");if(AB){return AD.toString()}else{return""}};
    this.getEvents=function(AB,Az){if(AB==null){return null}var AF=((AB.BaseEvents==null)||(AB.BaseEvents.length==0));var Ay=((AB.iCals==null)||(AB.iCals.length==0));if(AF&&Ay){return null}var AA=new Array();var AE;if(!AF){for(var Ax=0;Ax<AB.BaseEvents.length;Ax++){AE=this.convertStringToDateTime(AB.BaseEvents[Ax].Due);if((AE.getDate()==Az.getDate())&&(AE.getMonth()==Az.getMonth())&&(AE.getFullYear()==Az.getFullYear())){var AD=new Ak();AD.ID=AB.BaseEvents[Ax].ID;AD.Title=AB.BaseEvents[Ax].Title;AD.Description=AB.BaseEvents[Ax].Description;AD.Due=AB.BaseEvents[Ax].Due;AD.Tag=AB.BaseEvents[Ax].Tag;AD.Color=this.getTagColor(AB.BaseEvents[Ax].Tag);AD.CanEdit=true;AA.push(AD)}}}if(!Ay){for(var Ax=0;Ax<AB.iCals.length;Ax++){var AC=AB.iCals[Ax];if(AC!=null){if((AC.Events!=null)&&(AC.Events.length>0)){for(var Aw=0;Aw<AC.Events.length;Aw++){AE=this.convertStringToDateTime(AC.Events[Aw].Due);if((AE.getDate()==Az.getDate())&&(AE.getMonth()==Az.getMonth())&&(AE.getFullYear()==Az.getFullYear())){var AD=new Ak();AD.ID=AC.Events[Aw].ID;AD.Title=AC.Events[Aw].Title;AD.Description="";AD.Due=AC.Events[Aw].Due;AD.Tag="";AD.Color=AC.Color;AD.CanEdit=false;AA.push(AD)}}}}}}return AA};
    this.showDayViewFromMonthView=function(Ax,Ay,Aw){At=new Date(Ax,Ay,Aw,At.getHours(),At.getMinutes(),0);this.showDayView(At)};
    this.showDayView=function(Ax){TooltipManager.hideTooltip();c.enableRefresh();m.src=Ab.MONTHVIEW;Q.src=D.DAYVIEW;Ac.src=Ab.EDITOR;l.style.display="block";p=e.DAYVIEW;var Ay=this.getDayName(Ax)+", "+this.getMonthName(Ax)+" "+Ax.getDate().toString()+", "+Ax.getFullYear().toString();this.setText(X,Ay);B.innerHTML='<div style="text-align:left;vertical-align:middle">Loading...<div>';B.style.height="140px";Aj.style.display="none";Ag.style.display="block";b.style.display="none";var Az=this.getStartDateTime(Ax);var Aw=this.getEndDateTime(Ax);App.startWork(c.id);CalendarEventService.GetView(c.internalId,T,Az,Aw,function(AA){Ar.onShowDayViewSuccess(AA)},function(AA){B.innerHTML='<span style="color:#ff0000">An unexpected error has occurred while retrieving your events.</span>';App.endWork(c.id);PageflakesUtility.dumpException(AA)})};
    this.onShowDayViewSuccess=function(AF){var AL=Ar.getEvents(AF,At);if((AL==null)||(AL.length==0)){if(c.page.CanChangeFlake){B.innerHTML='<div style="text-align:middle;vertical-align:center"><p><span style="color:#666666">No events on this day.</span></p><p><a href="javascript:void(0)" onclick="'+a+'.showEditor(0)">Add an event</a></p></div>'}else{B.innerHTML='<div style="text-align:middle;vertical-align:center"><p><span style="color:#666666">No events on this day.</span></p></div>'}B.style.height="140px"}else{var Ay=c.page.CanChangeFlake;var Ax=new Date;var AC=new Sys.StringBuilder();AC.append('<table border="0" cellpadding="2" cellspacing="0" style="width:100%"><tbody>');for(var AA=0;AA<AL.length;AA++){var AH=Ar.convertStringToDateTime(AL[AA].Due);var Aw=false;if(!((AH.getHours()==0)&&(AH.getMinutes()==0))){if((Ax.getFullYear()==AH.getFullYear())&&(Ax.getMonth()==AH.getMonth())&&(Ax.getDate()==AH.getDate())){if((AH.getHours()==Ax.getHours())&&(AH.getMinutes()==Ax.getMinutes())){Aw=true}else{if(AA<(AL.length-1)){if((AH.getHours()<Ax.getHours())||((AH.getHours()==Ax.getHours())&&(AH.getMinutes()<Ax.getMinutes()))){var AD=false;for(var Az=(AA+1);Az<AL.length;Az++){var AB=Ar.convertStringToDateTime(AL[Az].Due);if((AB.getHours()<Ax.getHours())||((AB.getHours()==Ax.getHours())&&(AB.getMinutes()<Ax.getMinutes()))){AD=true;break}}if(!AD){Aw=true}}}}}}var AG="";if(Aw){AG="#ffffee"}else{AG="#ffffff"}var AJ='<span id="spnTitle'+a+AL[AA].ID+'" style="color:#333333">'+Ar.wrapText(AL[AA].Title,36)+"</span>";var AK=(Ay&&AL[AA].CanEdit)?('onclick="'+a+".showEditor("+AL[AA].ID+')"'):"";var AI=(Ay&&AL[AA].CanEdit)?"cursor:pointer;":"";AC.append('<tr><td style="text-align:left;vertical-align:middle;width:100%;border:solid 1px #d4d2cc"><table border="0" cellpadding="1" cellspacing="3" style="width:100%;'+AI+"background-color:"+AG+'" onmouseout="this.style.backgroundColor=\''+AG+"'\" onmouseover=\"this.style.backgroundColor='#d9d2d1'\""+AK+'><tbody></tr><td style="text-align:right;vertical-align:middle;white-space:nowrap;width:20%"><strong><span style="color:#333333">'+Ar.formatEventTime(AH)+'</span></strong></td><td style="text-align:left;vertical-align:middle;width:80%">'+AJ+"</td></tr></tbody></table></td></tr>")}AC.append("</tbody></table>");B.innerHTML=AC.toString();for(var AA=0;AA<AL.length;AA++){if((AL[AA].Description.length>0)||(AL[AA].Tag.length>0)){var AE=$("spnTitle"+a+AL[AA].ID);if(AE!=null){TooltipManager.setTooltip(AE,Ar.buildTip(AL[AA],false))}}}B.style.height=""}App.endWork(c.id)};
    this.formatEventTime=function(Ay){var Aw=Ay.getHours();var Az=Ay.getMinutes();var Ax="am";if(Aw>11){Aw-=12;Ax="pm"}if(Aw==0){Aw=12}if((Ax=="am")&&(Aw==12)&&(Az==0)){return""}Aw=Aw.toString();Az=Az.toString();if(Az.length==1){Az="0"+Az}return Aw+":"+Az+Ax};
    this.getStartDateTime=function(Ax){var Aw=new Date(Ax.getFullYear(),Ax.getMonth(),Ax.getDate(),0,0,0);return this.convertDateTimeToString(Aw)};
    this.getEndDateTime=function(Ax){var Aw=new Date(Ax.getFullYear(),Ax.getMonth(),Ax.getDate(),23,59,59);return this.convertDateTimeToString(Aw)};
    this.showEditor=function(Ax){TooltipManager.hideTooltip();c.disableRefresh();this.setText(R,"");this.setText(S,"");this.setText(i,"");this.setText(Ae,"");Af.innerHTML="";R.visibility="hidden";S.visibility="hidden";i.visibility="hidden";Ae.visibility="hidden";Af.style.display="none";Al.style.display="none";P.style.display="none";R.style.color="#000000";d.value="";k.value="";Aq.value="";r.selectedIndex=0;z.selectedIndex=0;H.selectedIndex=0;q.selectedIndex=0;j.selectedIndex=0;f.selectedIndex=0;Aa.selectedIndex=0;F.checked=false;K.value="";L.selectedIndex=0;G.selectedIndex=1;t.disabled=false;w.disabled=false;if(Ax>0){App.startWork(c.id);CalendarEventService.GetById(c.internalId,T,Ax,function(Ay){Ar.onShowEditorSuccess(Ay)},function(Ay){B.innerHTML='<span style="color:#ff0000">An unexpected error has occurred while retrieving this event.</span>';App.endWork(c.id);PageflakesUtility.dumpException(Ay)})}else{m.src=Ab.MONTHVIEW;Q.src=Ab.DAYVIEW;Ac.src=D.EDITOR;l.style.display="none";this.setText(E,"Add Event");As.style.visibility="hidden";var Aw=new Date();At.setHours(Aw.getHours(),Aw.getMinutes(),Aw.getSeconds());this.setSelectedDate(At);this.loadDayDropDownList();Aj.style.display="none";Ag.style.display="none";b.style.display="block";k.focus()}};
    this.onShowEditorSuccess=function(Az){m.src=Ab.MONTHVIEW;Q.src=Ab.DAYVIEW;Ac.src=D.EDITOR;l.style.display="none";Ar.setText(E,"Edit Event");As.style.visibility="visible";var Ax=Ar.convertStringToDateTime(Az.Due);d.value=Az.ID;k.value=Az.Title;Aq.value=Az.Description;Ar.setSelectedDate(Ax);var Aw=Ax.getHours();var AA=Ax.getMinutes();if((Aw==0)&&(AA==0)){Ar.selectListBoxByValue(q,"");Ar.selectListBoxByValue(j,"");Ar.selectListBoxByValue(f,"")}else{var Ay="am";if(Aw>11){Aw-=12;Ay="pm"}if(Aw==0){Aw=12}Ar.selectListBoxByValue(q,Aw.toString());Ar.selectListBoxByValue(j,AA.toString());Ar.selectListBoxByValue(f,Ay)}Ar.selectListBoxByValue(Aa,Az.Tag);K.value=Az.ReminderRefID;if((Az.ReminderHour>0)||(Az.ReminderMinute>0)){F.checked=true;Ar.selectListBoxByValue(L,Az.ReminderHour.toString());Ar.selectListBoxByValue(G,Az.ReminderMinute.toString());P.style.display="block"}Aj.style.display="none";Ag.style.display="none";b.style.display="block";k.select();k.focus();App.endWork(c.id)};
    this.setSelectedDate=function(Az){var AB=Az.getFullYear();var Ay=(Az.getMonth()+1);var AC=Az.getDate();var Aw=Az.getHours();var Ax=Az.getMinutes();if((Aw==0)&&(Ax==0)){q.selectedIndex=0;j.selectedIndex=0;f.selectedIndex=0}else{var AA=Az.getMinutes();if(AA>=55){var AE=(60-AA);Az.setMinutes(AA+AE);AB=Az.getFullYear();Ay=(Az.getMonth()+1);AC=Az.getDate();Aw=Az.getHours();Ax=Az.getMinutes()}var AD="am";if(Aw>11){AD="pm";Aw=(Aw-12)}if(Aw==0){Aw=12}if(Ax>=50){Ax=55}else{if(Ax>=45){Ax=50}else{if(Ax>=40){Ax=45}else{if(Ax>=35){Ax=40}else{if(Ax>=30){Ax=35}else{if(Ax>=25){Ax=30}else{if(Ax>=20){Ax=25}else{if(Ax>=15){Ax=20}else{if(Ax>=10){Ax=15}else{if(Ax>=5){Ax=10}else{if(Ax>=0){Ax=5}else{Ax=0}}}}}}}}}}}this.selectListBoxByValue(q,Aw.toString());this.selectListBoxByValue(j,Ax.toString());this.selectListBoxByValue(f,AD)}this.selectListBoxByValue(r,AB.toString());this.selectListBoxByValue(z,Ay.toString());this.loadDayDropDownList();this.selectListBoxByValue(H,AC.toString())};
    this.getSelectedDate=function(){var AE=parseInt(r.options[r.selectedIndex].value,10);var AA=parseInt(z.options[z.selectedIndex].value,10);var Az=parseInt(H.options[H.selectedIndex].value,10);var AD=q.options[q.selectedIndex].value;var Ay=j.options[j.selectedIndex].value;var Ax=f.options[f.selectedIndex].value;AA=(AA-1);var AC;if((AD.length>0)&&(Ay.length>0)&&(Ax.length>0)){var AB=parseInt(AD,10);var Aw=parseInt(Ay,10);if(Ax=="am"){if(AB==12){AB=0}}else{if(Ax=="pm"){if(AB!=12){AB=(AB+12)}}}AC=new Date(AE,AA,Az,AB,Aw,0,0)}else{AC=new Date(AE,AA,Az,0,0,0,0)}return AC};
    this.clearDateErrorsIfValid=function(){if(this.isValidDate()){this.setText(i,"");i.style.visibility="hidden"}};
    this.clearTimeErrorsIfValid=function(){if(this.isValidTime()){this.setText(Ae,"");Ae.style.visibility="hidden"}};
    this.clearReminderErrorsIfValid=function(){if(F.checked){if(!this.canHaveReminder()){return}}if(this.isValidReminder()){Af.innerHTML="";Af.style.display="none";Al.style.display="none"}};
    this.isValidDate=function(){if(this.isValidTime()){var Aw=new Date();var Ax=this.getSelectedDate();if(!(Ax<Aw)){return true}}return false};
    this.isValidTime=function(){var Aw=q.options[q.selectedIndex].value;var Ay=j.options[j.selectedIndex].value;var Ax=f.options[f.selectedIndex].value;if((Aw.length>0)||(Ay.length>0)||(Ax.length>0)){if(Aw.length==0){return false}if(Ay.length==0){return false}if(Ax.length==0){return false}}return true};
    this.isValidReminder=function(){if(F.checked){var Aw=parseInt(L.options[L.selectedIndex].value,10);var Ax=parseInt(G.options[G.selectedIndex].value,10);if((Aw==0)&&(Ax==0)){return false}}return true};
    this.canHaveReminder=function(){
    if((Av.length>0)&&(T>-1)){return true}return false};
    this.isValid=function(){var Aw=true;this.setText(S,"");this.setText(i,"");this.setText(Ae,"");Af.innerHTML="";S.style.visibility="hidden";i.style.visibility="hidden";Ae.style.visibility="hidden";Af.style.display="none";if(F.checked){if(!this.canHaveReminder()){Al.style.display="";Aw=false}else{if(!this.isValidReminder()){Af.innerHTML="Invalid reminder selection.";Af.style.display="";L.focus();Aw=false}}}if(!this.isValidTime()){this.setText(Ae,"Invalid time selection.");Ae.style.visibility="visible";q.focus();Aw=false}if(!this.isValidDate()){this.setText(i,"Cannot save an event which is in the past.");i.style.visibility="visible";z.focus();Aw=false}if(this.trimText(k.value).length==0){this.setText(S,"Title cannot be blank.");S.style.visibility="visible";k.focus();Aw=false}return Aw};
    this.save=function(){R.style.visibility="hidden";R.style.color="#000000";this.setText(R,"");if(this.isValid()){var Ax=new CalendarEvent();var Aw=new CalendarEventReminderSetting();Ax.ID=0;Ax.Title=this.trimText(k.value);Ax.Description=this.trimText(Aq.value);Ax.Due=this.convertDateTimeToString(this.getSelectedDate());Ax.Tag=Aa.options[Aa.selectedIndex].value;Ax.ReminderHour=0;Ax.ReminderMinute=0;if(this.trimText(d.value).length>0){Ax.ID=parseInt(this.trimText(d.value),10)}Ax.ReminderRefID=K.value;if(F.checked){Ax.ReminderHour=parseInt(L.options[L.selectedIndex].value,10);Ax.ReminderMinute=parseInt(G.options[G.selectedIndex].value,10)}Aw.Email=Av;Aw.TimeZone=T;App.startWork(c.id);R.style.visibility="visible";this.setText(R,"Saving...");t.disabled=true;w.disabled=true;if(Ax.ID>0){As.style.visibility="hidden";CalendarEventService.Update(c.internalId,Ax,Aw,this.onSaveSuccess,function(Ay){App.endWork(c.id);Ar.setText(R,"An unexpected error has occurred while updating this event.");R.style.color="#ff0000";R.style.visibility="visible";t.disabled=false;w.disabled=false;As.style.visibility="visible";PageflakesUtility.dumpException(Ay)})}else{CalendarEventService.Create(c.internalId,Ax,Aw,this.onSaveSuccess,function(Ay){App.endWork(c.id);Ar.setText(R,"An unexpected error has occurred while creating this event.");R.style.color="#ff0000";R.style.visibility="visible";t.disabled=false;w.disabled=false;PageflakesUtility.dumpException(Ay)})}}};
    this.onSaveSuccess=function(Aw){App.endWork(c.id);At=Ar.convertStringToDateTime(Aw.Due);if(p==e.MONTHVIEW){Ar.showMonthView(At)}else{if(p==e.DAYVIEW){Ar.showDayView(At)}}};
    this.remove=function(){this.setText(R,"");R.style.visibility="hidden";if(confirm("Would you like to delete this event? (Ok=Yes Cancel=No)")){var Aw=parseInt(this.trimText(d.value),10);App.startWork(c.id);R.style.visibility="visible";this.setText(R,"Deleting...");t.disabled=true;w.disabled=true;As.style.visibility="hidden";CalendarEventService.Delete(c.internalId,Aw,this.onRemoveSuccess,function(Ax){App.endWork(c.id);Ar.setText(R,"Request timeout.");R.style.color="#ff0000";R.style.visibility="visible";t.disabled=false;w.disabled=false;As.style.visibility="visible"},function(Ax){App.endWork(c.id);Ar.setText(R,"An unexpected error has occurred while deleting this event.");R.style.color="#ff0000";R.style.visibility="visible";t.disabled=false;w.disabled=false;As.style.visibility="visible";PageflakesUtility.dumpException(Ax)})}};
    this.onRemoveSuccess=function(Aw){App.endWork(c.id);if(p==e.MONTHVIEW){Ar.showMonthView(At)}else{if(p==e.DAYVIEW){Ar.showDayView(At)}}};
    this.saveSetting=function(){v.style.display="none";Ar.showErrorMsg("",false);if(n.selectedIndex==0){v.style.display="block";n.focus();return}if((this.trimText(g.value)).length>0){var AB=this.trimText(g.value);var AA=false;if(AB.indexOf(";")>-1){AA=this.isValidEmailList(AB,";")}else{if(AB.indexOf(",")>-1){AA=this.isValidEmailList(AB,",")}else{if(AB.indexOf(" ")>-1){AA=this.isValidEmailList(AB," ")}else{AA=this.isValidEmail(AB)}}}if(!AA){Ar.showErrorMsg("One of your specified reminder emails is not valid.",true);g.select();g.focus();return}}T=parseInt(n.options[n.selectedIndex].value,10);Av=this.trimText(g.value);var Az=false;if(parseInt(c.ProtectedProfiles[C])!=T){c.ProtectedProfiles[C]=T;Az=true}c.Profiles[Ap]=Av;if(c.page.IsOwner){c.Profiles[C]=T}Ar.refreshCalValues();if(U!=""){var Ax=U.split("|");for(var Ay=0;Ay<Ax.length;Ay++){if(!this.isValidiCalUrl(this.trimText(Ax[Ay]))){Ar.showErrorMsg("One of your iCal URLs does not seem to be valid.",true);$(a+"txtiCalURL"+Ay).select();$(a+"txtiCalURL"+Ay).focus();return}}var Aw=U.split("|");Aw.sort();for(var Ay=0;Ay<Aw.length-1;Ay++){if(Aw[Ay]==Aw[Ay+1]){Ar.showErrorMsg("You have duplicate iCal URLs in your list.",true);$(a+"txtiCalURL"+(Ay+1)).select();$(a+"txtiCalURL"+(Ay+1)).focus();return}}App.startWork(c.id);Ai.style.display="block";CalendarEventService.IsValidiCals(c.internalId,U,function(AC){for(var AD=0;AD<AC.length;AD++){if(!AC[AD]){Ar.showErrorMsg("One of your iCal URLs does not seem to be valid.",true);$(a+"txtiCalURL"+AD).select();$(a+"txtiCalURL"+AD).focus();Ai.style.display="none";return}}Ar.actualSave(Az)},function(AC){Ar.showErrorMsg('<span style="color:#ff0000">An unexpected error has occurred while retrieving this event.</span>',true);App.endWork(c.id);PageflakesUtility.dumpException(AC);Ai.style.display="none"});return}Ar.showErrorMsg("",false);Ar.actualSave(Az);Ai.style.display="none"};
    this.actualSave=function(Ax){var Aw=false;if(U==""||c.Profiles.urls!=U||c.Profiles.colors!=O||c.Profiles.show!=Au){Aw=true}c.Profiles.urls=U;c.Profiles.colors=(U!="")?O:"";c.Profiles.show=(U!="")?Au:"";c.save();c.hideEditArea();if(F.checked){P.style.display="block"}Af.innerHTML="";Af.style.display="none";Al.style.display="none";if(Ax||Aw){if(p==e.MONTHVIEW){this.showMonthView(At)}else{if(p==e.DAYVIEW){this.showDayView(At)}}Ar.refresh()}Ai.style.display="none"};
    this.cancelSetting=function(){c.hideEditArea()};
    this.showErrorMsg=function(Ax,Aw){_divEditEmailMessageError.innerHTML=Ax;Y.style.display=(Aw==true)?"block":"none"};
    
function Ak(){
    this.ID="";
    this.Title="";
    this.Description="";
    this.Due="";
    this.Tag="";
    this.Color="";
    this.CanEdit=false
}
    this.convertDateTimeToString=function(Ax){var Aw=Ax.getFullYear();var Ay=(Ax.getMonth()+1);return Aw.toString()+"-"+Ay.toString()+"-"+Ax.getDate().toString()+" "+Ax.getHours().toString()+":"+Ax.getMinutes().toString()+":"+Ax.getSeconds().toString()};
    this.convertStringToDateTime=function(AA){var AC=0;var AB=0;var AE=0;var Ay=0;var Ax=0;var Aw=0;var AG=AA.split(" ");var AF=AG[0].split("/");var AD=AG[1].split(":");AC=parseInt(AF[0],10);AB=parseInt(AF[1],10);AE=parseInt(AF[2],10);Ay=parseInt(AD[0],10);Ax=parseInt(AD[1],10);Aw=parseInt(AD[2],10);var Az=new Date(AC,(AB-1),AE,Ay,Ax,Aw,0);return Az};
    this.getMonthName=function(Aw){var Ax=new Array("January","February","March","April","May","June","July","August","September","October","November","December");return Ax[Aw.getMonth()]};
    this.getDayName=function(Ax){var Aw=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");return Aw[Ax.getDay()]};
    this.getDayAbbr=function(Ax){var Aw=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat");return Aw[Ax.getDay()]};
    this.isLeapYear=function(Aw){return(new Date(Aw,2-1,29).getDate()==29)};
    this.addDays=function(Aw,Ax){return new Date(Aw.getFullYear(),Aw.getMonth(),(Aw.getDate()+Ax))};
    this.addMonths=function(Ax,Aw){return new Date(Ax.getFullYear(),(Ax.getMonth()+1),Ax.getDate())};
    this.getDaysInMonth=function(Aw,Ax){return(32-new Date(Aw,Ax-1,32).getDate())};
    this.getText=function(Aw){if(typeof Aw.innerText!="undefined"){return this.trimText(Aw.innerText)}else{if(typeof Aw.textContent!="undefined"){return this.trimText(Aw.textContent)}}};
    this.setText=function(Aw,Ax){if(typeof Aw.innerText!="undefined"){Aw.innerText=this.trimText(Ax)}else{if(typeof Aw.textContent!="undefined"){Aw.textContent=this.trimText(Ax)}}};
    this.addListBoxItem=function(Ay,Az,Ax){var Aw=document.createElement("option");Ay.appendChild(Aw);this.setText(Aw,Az);if(Ax!=null){Aw.value=Ax}};
    this.clearListBox=function(Ax){for(var Aw=Ax.childNodes.length-1;Aw>-1;Aw--){Ax.removeChild(Ax.childNodes[Aw])}};
    this.selectListBoxByText=function(Ax,Ay){Ax.selectedIndex=0;for(var Aw=0;Aw<Ax.options.length;Aw++){if(Ax.options[Aw].text==this.trimText(Ay)){Ax.selectedIndex=Aw;break}}};
this.selectListBoxByValue=function(Ay,Ax){Ay.selectedIndex=0;for(var Aw=0;Aw<Ay.options.length;Aw++){if(Ay.options[Aw].value==this.trimText(Ax)){Ay.selectedIndex=Aw;break}}};
this.leftTrimText=function(Aw){while(Aw.substring(0,1)==" "){Aw=Aw.substring(1,Aw.length)}return Aw};
this.rightTrimText=function(Aw){while(Aw.substring(Aw.length-1,Aw.length)==" "){Aw=Aw.substring(0,Aw.length-1)}return Aw};
this.trimText=function(Aw){return this.rightTrimText(this.leftTrimText(Aw))};
this.replaceText=function(Az,Aw,Ay){var Ax=Az.split(Aw);Ax=Ax.join(Ay);return Ax};
this.encodeText=function(Ax){var Aw=Ax;Aw=this.replaceText(Aw,"&","&amp;");Aw=this.replaceText(Aw,"'","&apos;");Aw=this.replaceText(Aw,"<","&lt;");Aw=this.replaceText(Aw,">","&gt;");return Aw};
this.wrapText=function(Ax,Aw){Ax=this.trimText(Ax);if(Aw==null){Aw=255}if(Ax.length>Aw){Ax=Ax.substring(0,(Aw-3));Ax+="..."}return Ax};
this.isValidEmail=function(Ax){var Aw=/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;return Aw.test(Ax)};
this.isValidEmailList=function(Ay,Ax){var Az=Ay.trim().split(Ax);if((Az!=null)&&(Az.length>0)){for(var Aw=0;Aw<Az.length;Aw++){if(Az[Aw].trim().length>0){if(!this.isValidEmail(Az[Aw].trim())){return false}}}}return true};
this.isValidiCalUrl=function(Ax){var Aw=/(webcal|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return Aw.test(Ax)}};

var ToDoListWS=function(){ToDoListWS.initializeBase(this);this._timeout=0;this._userContext=null;this._succeeded=null;this._failed=null};ToDoListWS.prototype={SaveUserSettings:function(D,B,A,G,E,C,H){return this._invoke(ToDoListWS.get_path(),"SaveUserSettings",true,{moduleId:D,email:B,timeZone:A,userGuid:G},E,C,H)},GetUserSettings:function(B,D,C,A,E){return this._invoke(ToDoListWS.get_path(),"GetUserSettings",true,{moduleId:B,userGuid:D},C,A,E)},GetTotalListCount:function(B,D,C,A,E){return this._invoke(ToDoListWS.get_path(),"GetTotalListCount",true,{moduleId:B,userGuid:D},C,A,E)},GetFirstTaskListId:function(B,D,C,A,E){return this._invoke(ToDoListWS.get_path(),"GetFirstTaskListId",true,{moduleId:B,userGuid:D},C,A,E)},GetOverDueReminders:function(B,D,C,A,E){return this._invoke(ToDoListWS.get_path(),"GetOverDueReminders",true,{moduleId:B,userGuid:D},C,A,E)},SaveList:function(A,B,D,G,E,C,H){return this._invoke(ToDoListWS.get_path(),"SaveList",true,{listId:A,name:B,moduleId:D,userGuid:G},E,C,H)},GetListTabs:function(A,C,E,D,B,G){return this._invoke(ToDoListWS.get_path(),"GetListTabs",true,{selectedListId:A,moduleId:C,userGuid:E},D,B,G)},GetListByListId:function(A,C,E,D,B,G){return this._invoke(ToDoListWS.get_path(),"GetListByListId",true,{listId:A,moduleId:C,userGuid:E},D,B,G)},SaveTask:function(I,A,M,G,J,L,D,E,B,C,N,K,H){return this._invoke(ToDoListWS.get_path(),"SaveTask",true,{taskId:I,name:A,description:M,hasDueDate:G,strDueDate:J,hasReminder:L,remindTime:D,listId:E,moduleId:B,userGuid:C},N,K,H)},GetTaskByTaskId:function(B,C,E,D,A,G){return this._invoke(ToDoListWS.get_path(),"GetTaskByTaskId",true,{taskId:B,moduleId:C,userGuid:E},D,A,G)},GetTasksInList:function(A,C,E,D,B,G){return this._invoke(ToDoListWS.get_path(),"GetTasksInList",true,{taskListId:A,moduleId:C,userGuid:E},D,B,G)},DeleteTask:function(B,C,E,D,A,G){return this._invoke(ToDoListWS.get_path(),"DeleteTask",true,{taskId:B,moduleId:C,userGuid:E},D,A,G)},DeleteList:function(A,C,E,D,B,G){return this._invoke(ToDoListWS.get_path(),"DeleteList",true,{listId:A,moduleId:C,userGuid:E},D,B,G)},ToggleTaskStatus:function(B,C,E,D,A,G){return this._invoke(ToDoListWS.get_path(),"ToggleTaskStatus",true,{taskId:B,moduleId:C,userGuid:E},D,A,G)},SendAlert:function(B,A,C){return this._invoke(ToDoListWS.get_path(),"SendAlert",true,{},B,A,C)}};ToDoListWS.registerClass("ToDoListWS",Sys.Net.WebServiceProxy);ToDoListWS._staticInstance=new ToDoListWS();ToDoListWS.set_path=function(A){ToDoListWS._staticInstance._path=A};ToDoListWS.get_path=function(){return ToDoListWS._staticInstance._path};ToDoListWS.set_timeout=function(A){ToDoListWS._staticInstance._timeout=A};ToDoListWS.get_timeout=function(){return ToDoListWS._staticInstance._timeout};ToDoListWS.set_defaultUserContext=function(A){ToDoListWS._staticInstance._userContext=A};ToDoListWS.get_defaultUserContext=function(){return ToDoListWS._staticInstance._userContext};ToDoListWS.set_defaultSucceededCallback=function(A){ToDoListWS._staticInstance._succeeded=A};ToDoListWS.get_defaultSucceededCallback=function(){return ToDoListWS._staticInstance._succeeded};ToDoListWS.set_defaultFailedCallback=function(A){ToDoListWS._staticInstance._failed=A};ToDoListWS.get_defaultFailedCallback=function(){return ToDoListWS._staticInstance._failed};ToDoListWS.set_path("/todolistws.soap");ToDoListWS.SaveUserSettings=function(D,B,A,E,G,C,H){ToDoListWS._staticInstance.SaveUserSettings(D,B,A,E,G,C,H)};ToDoListWS.GetUserSettings=function(B,C,D,A,E){ToDoListWS._staticInstance.GetUserSettings(B,C,D,A,E)};ToDoListWS.GetTotalListCount=function(B,C,D,A,E){ToDoListWS._staticInstance.GetTotalListCount(B,C,D,A,E)};ToDoListWS.GetFirstTaskListId=function(B,C,D,A,E){ToDoListWS._staticInstance.GetFirstTaskListId(B,C,D,A,E)};ToDoListWS.GetOverDueReminders=function(B,C,D,A,E){ToDoListWS._staticInstance.GetOverDueReminders(B,C,D,A,E)};ToDoListWS.SaveList=function(A,B,D,E,G,C,H){ToDoListWS._staticInstance.SaveList(A,B,D,E,G,C,H)};ToDoListWS.GetListTabs=function(A,C,D,E,B,G){ToDoListWS._staticInstance.GetListTabs(A,C,D,E,B,G)};ToDoListWS.GetListByListId=function(A,C,D,E,B,G){ToDoListWS._staticInstance.GetListByListId(A,C,D,E,B,G)};ToDoListWS.SaveTask=function(K,A,N,H,L,M,E,G,B,D,J,C,I){ToDoListWS._staticInstance.SaveTask(K,A,N,H,L,M,E,G,B,D,J,C,I)};ToDoListWS.GetTaskByTaskId=function(B,C,D,E,A,G){ToDoListWS._staticInstance.GetTaskByTaskId(B,C,D,E,A,G)};ToDoListWS.GetTasksInList=function(A,C,D,E,B,G){ToDoListWS._staticInstance.GetTasksInList(A,C,D,E,B,G)};ToDoListWS.DeleteTask=function(B,C,D,E,A,G){ToDoListWS._staticInstance.DeleteTask(B,C,D,E,A,G)};ToDoListWS.DeleteList=function(A,C,D,E,B,G){ToDoListWS._staticInstance.DeleteList(A,C,D,E,B,G)};ToDoListWS.ToggleTaskStatus=function(B,C,D,E,A,G){ToDoListWS._staticInstance.ToggleTaskStatus(B,C,D,E,A,G)};ToDoListWS.SendAlert=function(B,A,C){ToDoListWS._staticInstance.SendAlert(B,A,C)};ToDoListWS.set_path("/ToDoListWS.soap");function Todolist(A){var H=null;var G=this;var J=A;var B=null;var I=null;var C=300000;var E="";var D=300000;

this.onclose=function(){if(I!=null){clearTimeout(I)}if(B!=null){clearTimeout(B)}};
this.showflakeBody=function(){var K=$(A+"flakeBody");if(K){$display(K)}};
this.load=function(K){K.setEditArea('<table width="100%" cellpadding="1" cellspacing="1"><tr><td><b>Time Zone </b><span style="color: dimgray">(Required to display correct due time)</span></td></tr><tr><td><select id="'+A+'TimeZone" style="width: 100%"> <option selected="selected" value="-16386">[Choose a time zone]</option> <option value="0">(GMT-12:00) International Date Line West</option> <option value="1">(GMT-11:00) Midway Island, Samoa</option> <option value="2">(GMT-10:00) Hawaii</option> <option value="16387">(GMT-09:00) Alaska</option> <option value="16388">(GMT-08:00) Pacific Time (US &amp; Canada), Tijuana</option> <option value="15">(GMT-07:00) Arizona</option> <option value="16397">(GMT-07:00) Chihuahua, La Paz, Mazatlan</option> <option value="16394">(GMT-07:00) Mountain Time (US &amp; Canada)</option> <option value="33">(GMT-06:00) Central America</option> <option value="16404">(GMT-06:00) Central Time (US &amp; Canada)</option> <option value="16414">(GMT-06:00) Guadalajara, Mexico City, Monterrey</option> <option value="25">(GMT-06:00) Saskatchewan</option> <option value="45">(GMT-05:00) Bogota, Lima, Quito</option> <option value="16419">(GMT-05:00) Eastern Time (US &amp; Canada)</option> <option value="40">(GMT-05:00) Indiana (East)</option> <option value="16434">(GMT-04:00) Atlantic Time (Canada)</option> <option value="55">(GMT-04:00) Caracas, La Paz</option> <option value="16440">(GMT-04:00) Santiago</option> <option value="16444">(GMT-03:30) Newfoundland</option> <option value="16449">(GMT-03:00) Brasilia</option> <option value="70">(GMT-03:00) Buenos Aires, Georgetown</option> <option value="16457">(GMT-03:00) Greenland</option> <option value="16459">(GMT-02:00) Mid-Atlantic</option> <option value="16464">(GMT-01:00) Azores</option> <option value="83">(GMT-01:00) Cape Verde Is.</option> <option value="90">(GMT) Casablanca, Monrovia</option> <option value="16469">(GMT) Greenwich Mean Time : Dublin, Edinburgh,</option> <option value="16494">(GMT+01:00) Amsterdam, Berlin, Bern, Rome,</option> <option value="16479">(GMT+01:00) Belgrade, Bratislava, Budapest,</option> <option value="16489">(GMT+01:00) Brussels, Copenhagen, Madrid, Paris</option> <option value="16484">(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb</option> <option value="113">(GMT+01:00) West Central Africa</option> <option value="16514">(GMT+02:00) Athens, Beirut, Istanbul, Minsk</option> <option value="16499">(GMT+02:00) Bucharest</option> <option value="16504">(GMT+02:00) Cairo</option> <option value="140">(GMT+02:00) Harare, Pretoria</option> <option value="16509">(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn,</option> <option value="135">(GMT+02:00) Jerusalem</option> <option value="16542">(GMT+03:00) Baghdad</option> <option value="150">(GMT+03:00) Kuwait, Riyadh</option> <option value="16529">(GMT+03:00) Moscow, St. Petersburg, Volgograd</option> <option value="155">(GMT+03:00) Nairobi</option> <option value="16544">(GMT+03:30) Tehran</option> <option value="165">(GMT+04:00) Abu Dhabi, Muscat</option> <option value="16554">(GMT+04:00) Baku, Tbilisi, Yerevan</option> <option value="175">(GMT+04:30) Kabul</option> <option value="16564">(GMT+05:00) Ekaterinburg</option> <option value="185">(GMT+05:00) Islamabad, Karachi, Tashkent</option> <option value="190">(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi</option> <option value="193">(GMT+05:45) Kathmandu</option> <option value="16585">(GMT+06:00) Almaty, Novosibirsk</option> <option value="195">(GMT+06:00) Astana, Dhaka</option> <option value="200">(GMT+06:00) Sri Jayawardenepura</option> <option value="203">(GMT+06:30) Rangoon</option> <option value="205">(GMT+07:00) Bangkok, Hanoi, Jakarta</option> <option value="16591">(GMT+07:00) Krasnoyarsk</option> <option value="210">(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi</option> <option value="16611">(GMT+08:00) Irkutsk, Ulaan Bataar</option> <option value="215">(GMT+08:00) Kuala Lumpur, Singapore</option> <option value="225">(GMT+08:00) Perth</option> <option value="220">(GMT+08:00) Taipei</option> <option value="235">(GMT+09:00) Osaka, Sapporo, Tokyo</option> <option value="230">(GMT+09:00) Seoul</option> <option value="16624">(GMT+09:00) Yakutsk</option> <option value="16634">(GMT+09:30) Adelaide</option> <option value="245">(GMT+09:30) Darwin</option> <option value="260">(GMT+10:00) Brisbane</option> <option value="16639">(GMT+10:00) Canberra, Melbourne, Sydney</option> <option value="275">(GMT+10:00) Guam, Port Moresby</option> <option value="16649">(GMT+10:00) Hobart</option> <option value="16654">(GMT+10:00) Vladivostok</option> <option value="280">(GMT+11:00) Magadan, Solomon Is., New Caledonia</option> <option value="16674">(GMT+12:00) Auckland, Wellington</option> <option value="285">(GMT+12:00) Fiji, Kamchatka, Marshall Is.</option> <option value="300">(GMT+13:00) Nuku\'alofa</option> </select></td></tr><tr><td valign="middle"><table border="0" cellpadding="2" cellspacing="1" style="width: 100%"><tr><td style="height: 11px"><hr /></td></tr></table></td></tr><tr><td valign="middle"><b>&nbsp;Popup Reminder</b></td></tr><tr><td><table border="0" cellpadding="0" cellspacing="0" style="width: 100%"><tr><td style="width: 2px"></td><td><table border="0" cellpadding="1" cellspacing="1" style="width: 100%"><tr><td style="width: 5px"><input id="'+A+'chkShowPopupForOverDue" type="checkbox" onclick="'+A+'.OnchkPopupClick();" style="padding-right: 1px; float: left; margin-left: -0.5em" /></td><td>Show popup for over due task</td></tr><tr><td></td><td><table border="0" cellpadding="0" cellspacing="0" style="width: 100%"><tr><td style="width: 75px" valign="middle">Repeat every</td><td><select id="'+A+'drpPopupInterval"> <option value="1">1 minute</option> <option value="5" selected="selected">5 minutes</option> <option value="10">10 minutes</option> <option value="15">15 minutes</option> <option value="30">30 minutes</option> <option value="45">45 minutes</option> <option value="60">1 hour</option> <option value="120">2 hours</option> <option value="180">3 hours</option> <option value="240">4 hours</option> <option value="300">5 hours</option> <option value="360">6 hours</option> <option value="1440">1 day</option> <option value="2880">2 days</option> <option value="4320">3 days</option> </select></td></tr></table></td></tr></table></td></tr><tr><td></td><td valign="middle"><table border="0" cellpadding="2" cellspacing="1" style="width: 100%"><tr><td style="height: 15px"><hr /></td></tr></table></td></tr></table><span style="color: gray"></span></td></tr><tr><td><b>&nbsp;Email Reminder</b> <span style="color: dimgray">(can be turned on/off for every task)</span></td></tr><tr><td></td></tr><tr><td><table border="0" cellpadding="1" cellspacing="1" style="width: 100%"><tr><td style="width: 73px">&nbsp;Email address:</td><td><input id="'+A+'txtEmailAddress" style="width: 80%" type="text" onkeypress="if(event.keyCode == 13) '+A+'.saveUserSettings();" /></td><td style="width: 5px"></td></tr></table><table border="0" cellpadding="2" cellspacing="1" style="width: 100%"><tr><td style="height: 15px"><hr /></td></tr></table><input id="'+A+'SaveProfile" type="button" class="button" value="Save" onclick="'+A+'.saveUserSettings();" /> <input id="'+A+'CancelEdit" type="button" class="button cancel" value="Cancel" onclick="'+A+'.cancelSettings();" /></tr><tr><td></td></tr></table>');var L=window.IMAGE_PREFIX;K.body.innerHTML='<div id="'+A+'flakeBody" style="display: none"><div id="'+A+'Header" class="Header"><table width="100%" cellpadding="0" cellspacing="0"><tr><td><div id="'+A+'TaskListTabs" class="Header">&nbsp;</div></td><td style="width: 50px" align="right"><img alt="Add list" title="Add new list" src="'+L+'images/ToDoListflake/addList.png" class="linkImage" onclick="'+A+'.addNewTaskList()" id="'+A+'imgAddNewList" /></td></tr></table></div><div id="'+A+'TasksInListBorder" class="BorderDiv"><div id="'+A+'TasksInList" class="ListDetail"></div></div><div id="'+A+'ManageTaskList" class="ManageList"><table border="0" cellpadding="0" cellspacing="0" style="width: 100%"><tr><td style="width: 100px"><div id="'+A+'ManageListTitle" class="PageTitle">Add new list</div></td></tr><tr><td><table cellpadding="3" cellspacing="3" width="100%"><tr><td style="width: 60px">Name</td><td><input id="'+A+'ListName" type="text" class="Input" onkeypress="if(event.keyCode == 13) '+A+'.saveTaskList()" style="width: 80%" /></td></tr><tr><td></td><td><input id="'+A+'SaveTaskList" type="button" class="button" value="Save" onclick="'+A+'.saveTaskList()" /> <input id="'+A+'CancelListSave" type="button" class="button cancel" value="Cancel" onclick="'+A+'.cancelListSave();" /> <input id="'+A+'ListId" type="hidden" /> <input id="'+A+'ListId2" type="hidden" /></td></tr></table></td></tr></table></div><div class="ManageTask" id="'+A+'ManageTask"><table border="0" cellpadding="1" cellspacing="1" style="width: 100%"><tr><td style="width: 100px"><div id="'+A+'ManageTaskTitle" class="PageTitle">Add Task</div></td></tr><tr><td><table cellpadding="3" cellspacing="3" width="100%"><tr><td style="width: 70px">Name</td><td><input id="'+A+'TaskName" type="text" class="Input" size="" style="width: 80%" /> <input id="'+A+'TaskId" type="hidden" value="0" /></td></tr><tr><td valign="top">Description</td><td><textarea id="'+A+'TaskDescription" class="Input" cols="16" rows="4" style="width: 80%"></textarea></td></tr><tr><td valign="top">Due</td><td><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><input id="'+A+'isDue" type="checkbox" onclick="'+A+'.onIsDueClicked();" checked="CHECKED" /> Enter due date</td></tr><tr><td><div id="'+A+'DueDiv" style="width: 100%"><table border="0" cellpadding="1" cellspacing="1" width="100%"><tr><td><select id="'+A+'Date"> <option selected="selected" value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> <option value="6">6</option> <option value="7">7</option> <option value="8">8</option> <option value="9">9</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> <option value="13">13</option> <option value="14">14</option> <option value="15">15</option> <option value="16">16</option> <option value="17">17</option> <option value="18">18</option> <option value="19">19</option> <option value="20">20</option> <option value="21">21</option> <option value="22">22</option> <option value="23">23</option> <option value="24">24</option> <option value="25">25</option> <option value="26">26</option> <option value="27">27</option> <option value="28">28</option> <option value="29">29</option> <option value="30">30</option> <option value="31">31</option> </select> <select id="'+A+'Month"> <option value="0" selected="selected">January</option> <option value="1">February</option> <option value="2">March</option> <option value="3">April</option> <option value="4">May</option> <option value="5">June</option> <option value="6">July</option> <option value="7">August</option> <option value="8">September</option> <option value="9">October</option> <option value="10">November</option> <option value="11">December</option> </select> <select id="'+A+'Year"> <option value="2006" selected="selected">2006</option> <option value="2007">2007</option> <option value="2008">2008</option> <option value="2009">2009</option> <option value="2010">2010</option> </select></td></tr><tr><td><select id="'+A+'Hour"> <option value="0" selected="selected">12 am &nbsp;(00:00)</option> <option value="1">1 am &nbsp;&nbsp; (01:00)</option> <option value="2">2 am &nbsp;&nbsp; (02:00)</option> <option value="3">3 am &nbsp;&nbsp; (03:00)</option> <option value="4">4 am &nbsp;&nbsp; (04:00)</option> <option value="5">5 am &nbsp;&nbsp; (05:00)</option> <option value="6">6 am &nbsp;&nbsp; (06:00)</option> <option value="7">7 am &nbsp;&nbsp; (07:00)</option> <option value="8">8 am &nbsp;&nbsp; (08:00)</option> <option value="9">9 am &nbsp;&nbsp; (09:00)</option> <option value="10">10 am &nbsp;(10:00)</option> <option value="11">11 am &nbsp;(11:00)</option> <option value="12">12 pm &nbsp;(12:00)</option> <option value="13">1 pm &nbsp;&nbsp; (13:00)</option> <option value="14">2 pm &nbsp;&nbsp; (14:00)</option> <option value="15">3 pm &nbsp;&nbsp; (15:00)</option> <option value="16">4 pm &nbsp;&nbsp; (16:00)</option> <option value="17">5 pm &nbsp;&nbsp; (17:00)</option> <option value="18">6 pm &nbsp;&nbsp; (18:00)</option> <option value="19">7 pm &nbsp;&nbsp; (19:00)</option> <option value="20">8 pm &nbsp;&nbsp; (20:00)</option> <option value="21">9 pm &nbsp;&nbsp; (21:00)</option> <option value="22">10 pm &nbsp;(22:00)</option> <option value="23">11 pm &nbsp;(23:00)</option> </select> <select id="'+A+'Minute"> <option value="0" selected="selected">0</option> <option value="10">10</option> <option value="20">20</option> <option value="30">30</option> <option value="40">40</option> <option value="50">50</option> </select></td></tr></table></div></td></tr></table></td></tr><tr><td valign="top">Reminder</td><td><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td style="height: 20px"><input id="'+A+'HasReminder" type="checkbox" checked="CHECKED" onclick="'+A+'.toggleVisibility(\'ReminderDiv\')" /> Send reminder</td></tr><tr><td><div style="padding-left: 1px; width: 100%;" id="'+A+'ReminderDiv"><table border="0" cellpadding="0" cellspacing="0"><tr><td><select id="'+A+'RemindTime"> <option value="1">1 minute</option> <option value="5" selected="selected">5 minutes</option> <option value="10">10 minutes</option> <option value="15">15 minutes</option> <option value="30">30 minutes</option> <option value="45">45 minutes</option> <option value="60">1 hour</option> <option value="120">2 hours</option> <option value="180">3 hours</option> <option value="240">4 hours</option> <option value="300">5 hours</option> <option value="360">6 hours</option> <option value="1440">1 day</option> <option value="2880">2 days</option> <option value="4320">3 days</option> </select></td></tr><tr><td>before it\'s due. <br /> <a id="'+A+'LinkToEdit" style="display: none" href="javascript:void(0)" onclick="'+A+'.showEditDiv();">Please enter your email address</a></td></tr></table></div></td></tr></table></td></tr><tr><td></td><td></td></tr><tr><td></td><td><input id="'+A+'SaveTask" type="button" class="button" value="Save" onclick="'+A+'.saveTask()" /> <input id="'+A+'CancelTaskSave" type="button" class="button cancel" value="Cancel" onclick="'+A+'.cancelTaskSave();" /></td></tr></table></td></tr></table></div><a id="'+A+'NotifyUserToSelectTimeZone" href="javascript:void(0)" onclick="'+A+'.showEditDiv()" style="margin-bottom: 0em">Please select your time zone</a></div>';H=K;H.setIcon(window.IMAGE_PREFIX+"images/flakes/TodolistIcon.gif");K.beforeClose=function(){return confirm("Removing the Todo List will remove your tasks permanently. Are you really sure that you want to do this?")};$(A+"SaveTaskList").disabled=!H.page.CanChangeFlake;$(A+"SaveTask").disabled=!H.page.CanChangeFlake;$(A+"SaveProfile").disabled=!H.page.CanChangeFlake;if(H.page.CanChangeFlake){$(A+"imgAddNewList").style.display=""}else{$nodisplay($(A+"imgAddNewList"))}G.showflakeBody();G.reload()};
this.cancelSettings=function(){G.loadUserSettings();H.toggleEdit()};
this.reload=function(){try{G.showDiv("TaskListTabs|Header");ToDoListWS.GetFirstTaskListId(A,App.UserGUID,F(G,G.reloadSuccess));B=setTimeout(G.autoRefresh,D);G.loadUserSettings();G.showReminder()}catch(K){alert("loading error: "+K.message)}};
this.reloadSuccess=function(K){if(K!=0){G.showTasksInList(K)}else{G.addNewTaskList()}};
this.refreshTabs=function(K){ToDoListWS.GetListTabs(K,A,App.UserGUID,F(G,G.refreshTabsSuccess))};
this.refreshTabsSuccess=function(L){var K=$(A+"TaskListTabs");if(K!=null){K.innerHTML=L;$display(K)}};
this.addNewTaskList=function(){var K=$(A+"ManageListTitle");K.innerHTML="Add new task list";var L=$(A+"ListId");var N=$(A+"ListId2");N.value=L.value;L.value="0";var M=$(A+"ListName");M.value="";G.showDiv("ManageTaskList");M.focus()};
this.editList=function(L){var K=$(A+"ManageListTitle");K.innerHTML="Edit task list";var M=$(A+"ListId");M.value=L;ToDoListWS.GetListByListId(L,A,App.UserGUID,F(G,G.editListSuccess));G.showDiv("ManageTaskList")};
this.editListSuccess=function(K){var L=$(A+"ListName");L.value=K[1]};
this.deleteList=function(){try{doyou=confirm("Would you like to delete this task list? (OK = Yes   Cancel = No)");if(doyou===true){var L=$(A+"ListId");ToDoListWS.DeleteList(L.value,A,App.UserGUID,F(G,G.deleteListSuccess))}}catch(K){alert(K.message)}};
this.deleteListSuccess=function(K){if(K){G.reload()}};
this.editTask=function(M){if(!H.page.CanChangeFlake){alert("You are not allowed to edit this task");return}var K=$(A+"ManageTaskTitle");K.innerHTML="Edit task";G.showDiv("ManageTask");try{ToDoListWS.GetTaskByTaskId(M,A,App.UserGUID,F(G,G.editTaskSuccess))}catch(L){alert(L.message)}};
this.editTaskSuccess=function(L){var O=$(A+"TaskId");O.value=L[0];var K=$(A+"TaskName");K.value=L[1];var N=$(A+"TaskDescription");N.value=L[2];var M=$(A+"isDue");if(L[3]=="True"||L[3]=="true"){G.setDueDateOption(true)}else{G.setDueDateOption(false)}var Q=L[4].split("-");G.setDrpSelectedValue(Q[0],A+"Date");G.setDrpSelectedValue(parseInt(Q[1])-1,A+"Month");G.setDrpSelectedValue(Q[2],A+"Year");G.setDrpSelectedValue(Q[3],A+"Hour");G.setDrpSelectedValue(Q[4],A+"Minute");var R=$(A+"HasReminder");if(L[5]=="True"||L[5]=="true"){R.checked="Checked";$display($(A+"ReminderDiv"))}else{R.checked="";$nodisplay($(A+"ReminderDiv"))}var P=L[6];G.setDrpSelectedValue(P,A+"RemindTime")};
this.setDrpSelectedValue=function(N,M){var K=$(M);var L;for(L=0;L<K.options.length;L++){if(K.options[L].value==N){K.selectedIndex=L}}};
this.deleteTask=function(K){if(!H.page.CanChangeFlake){alert("You are not allowed to delete this task");return}doyou=confirm("Would you like to delete this task? (OK = Yes   Cancel = No)");if(doyou===true){ToDoListWS.DeleteTask(K,A,App.UserGUID,F(G,G.setDrpSelectedValueSuccess))}};
this.setDrpSelectedValueSuccess=function(K){var L=$(A+"ListId");G.showTasksInList(L.value)};
this.toggleTaskStatus=function(K){ToDoListWS.ToggleTaskStatus(K,A,App.UserGUID,F(G,G.toggleTaskStatusSuccess))};
this.toggleTaskStatusSuccess=function(K){var L=$(A+"ListId");G.showTasksInList(L.value)};
this.saveTaskList=function(){var K=$(A+"ListId");var L=$(A+"ListName");ToDoListWS.SaveList(K.value,L.value,A,App.UserGUID,F(G,G.saveTaskListSuccess))};
this.saveTaskListSuccess=function(K){if(K>0){G.showTasksInList(K)}};
this.cancelTaskSave=function(){var K=$(A+"ListId");G.showTasksInList(K.value);G.refreshTabs(K.value)};
this.cancelListSave=function(){var K=$(A+"ListId");if(K.value=="0"){var L=$(A+"ListId2");G.showTasksInList(L.value);G.refreshTabs(L.value)}else{G.showTasksInList(K.value);G.refreshTabs(K.value)}};
this.showReminder=function(){if(I!=null){clearTimeout(I)}if(H.Profiles.showPopupForOverDue=="True"){I=setTimeout(G.showReminder,C);ToDoListWS.GetOverDueReminders(A,App.UserGUID,F(G,G.showReminderSuccess))}};
this.showReminderSuccess=function(K){if(K.length>0){alert(K)}};
this.autoRefresh=function(){var L=$(A+"TasksInList");if(L!=null){if(L.style.display=="block"){var K=$(A+"ListId");G.showTasksInList(K.value)}}if(B!=null){clearTimeout(B)}B=setTimeout(G.autoRefresh,D)};
this.showAddTaskForm=function(T){var S=$(A+"ManageTaskTitle");S.innerHTML="Add new task";var W=$(A+"TaskId");W.value="0";var N=$(A+"TaskName");N.value="";var O=$(A+"TaskDescription");O.value="";var U=$(A+"isDue");var Y=$(A+"HasReminder");var M=$(A+"ListId");M.value=T;var L=new Date();var P=$(A+"Date");G.setDrpSelectedValue(L.getDate(),A+"Date");var V=$(A+"Month");G.setDrpSelectedValue(L.getMonth(),A+"Month");var X=$(A+"Year");G.setDrpSelectedValue(L.getFullYear(),A+"Year");var R=$(A+"Hour");if(L.getMinutes()>49){G.setDrpSelectedValue(L.getHours()+1,A+"Hour");G.setDrpSelectedValue(0,A+"Minute")}else{G.setDrpSelectedValue(L.getHours(),A+"Hour");var Q=$(A+"Minute");var K=0;if((L.getMinutes()/10)<1){K=10}else{K=Math.ceil(L.getMinutes()/10)*10}G.setDrpSelectedValue(K,A+"Minute")}G.showDiv("ManageTask");N.focus();G.setDueDateOption(true);if($(A+"txtEmailAddress").value){G.setReminderOption(true)}};
this.saveTask=function(){try{var Q=$(A+"ListId");var U=$(A+"TaskId");var L=$(A+"TaskName");var M=$(A+"TaskDescription");var S=$(A+"isDue");var V=$(A+"HasReminder");var P=$(A+"RemindTime");var W=new Date();if(!L.value){alert("Task must have a name");return}if(!S.checked){W.setMonth(1);W.setFullYear(2000);W.setDate(1)}else{var Y=$(A+"Date");var R=$(A+"Month");var O=$(A+"Year");var K=$(A+"Hour");var X=$(A+"Minute");W.setDate(Y.value);W.setMonth(R.value);W.setYear(O.value);W.setHours(K.value);W.setMinutes(X.value)}var N=W.getDate()+"-"+W.getMonth()+"-"+W.getFullYear()+"-"+W.getHours()+"-"+W.getMinutes();$(A+"SaveTask").disabled=true;$(A+"SaveTask").value="Saving...";ToDoListWS.SaveTask(parseInt(U.value),L.value,M.value,S.checked,N,V.checked,P.value,Q.value,A,App.UserGUID,F(G,G.saveTaskSuccess),F(G,G.saveTaskFailure))}catch(T){alert(T.message)}};
this.saveTaskSuccess=function(K){if(K>0){var M=$(A+"TaskId");M.value=K;var L=$(A+"ListId");G.showTasksInList(L.value)}else{alert("Failed to save")}$(A+"SaveTask").disabled=false;$(A+"SaveTask").value="Save"};
this.saveTaskFailure=function(K){$(A+"SaveTask").disabled=false;$(A+"SaveTask").value="Save"};
this.showTasksInList=function(K){try{var M=$(A+"ListId");M.value=K;G.showDiv("Header|TaskListTabs|TasksInList|TasksInListBorder");G.refreshTabs(K);ToDoListWS.GetTasksInList(K,A,App.UserGUID,F(G,G.showTasksInListSuccess))}catch(L){alert(L.message)}};
this.showTasksInListSuccess=function(K){var L=$(A+"TasksInList");L.innerHTML=K};
this.showDiv=function(S){var M=$(A+"TasksInListBorder");$nodisplay(M);var Q=$(A+"Header");$nodisplay(Q);var N=$(A+"TaskListTabs");$nodisplay(N);var L=$(A+"TasksInList");$nodisplay(L);var T=$(A+"ManageTaskList");$nodisplay(T);var K=$(A+"ManageTask");$nodisplay(K);var O=new Array();O=S.split("|");var P;var R=$(A+O[0]);if(R!=null){$display(R)}R=$(A+O[1]);if(R!=null){$display(R)}R=$(A+O[2]);if(R!=null){$display(R)}R=$(A+O[3]);if(R!=null){$display(R)}};
this.saveUserSettings=function(){var K=$(A+"TimeZone");var M=$(A+"chkShowPopupForOverDue");var O=$(A+"drpPopupInterval");var N=$(A+"txtEmailAddress");H.Profiles.showPopupForOverDue=(M.checked)?"True":"False";H.Profiles.reminderInterval=O.value;C=O.value*1000*60;H.save();try{ToDoListWS.SaveUserSettings(A,N.value,parseInt(K.value),App.UserGUID,function(){})}catch(L){alert(L.message)}H.toggleEdit();G.showflakeBody();G.loadUserSettings();G.autoRefresh()};
this.loadUserSettings=function(){var K=$(A+"TimeZone");var L=$(A+"chkShowPopupForOverDue");var N=$(A+"drpPopupInterval");var M=$(A+"txtEmailAddress");ToDoListWS.GetUserSettings(A,App.UserGUID,F(G,G.loadUserSettingsSuccess));if(H.Profiles.reminderInterval!=null){N.value=H.Profiles.reminderInterval;C=H.Profiles.reminderInterval*60*1000}else{N.value="5";H.Profiles.reminderInterval="5";C=5*60*1000}if(I!=null){clearTimeout(I)}if(H.Profiles.showPopupForOverDue=="True"){I=setTimeout(G.showReminder,C);L.checked="Checked"}else{L.checked=""}G.OnchkPopupClick();G.refreshEditEmailLinkStatus()};
this.loadUserSettingsSuccess=function(K){var L=$(A+"TimeZone");var M=$(A+"txtEmailAddress");if(K.length>0){tokens=new Array();tokens=K.split("|");M.value=tokens[0];G.refreshEditEmailLinkStatus();L.value=tokens[1];if(L.value=="-16386"&&Boolean(H.page.CanChangeFlake)){$display($(A+"NotifyUserToSelectTimeZone"))}else{$nodisplay($(A+"NotifyUserToSelectTimeZone"))}}else{if(Boolean(H.page.CanChangeFlake)){$display($(A+"NotifyUserToSelectTimeZone"))}else{$nodisplay($(A+"NotifyUserToSelectTimeZone"))}}};
this.OnchkPopupClick=function(){var K=$(A+"chkShowPopupForOverDue");var L=$(A+"drpPopupInterval");if(Boolean(K.checked)){L.disabled=false}else{L.disabled=true}};
this.toggleVisibility=function(K){var L=$(A+K);if(L!=null){if(L.style.display=="block"||L.style.display==""){$nodisplay(L)}else{$display(L)}}if(K="ReminderDiv"){G.refreshEditEmailLinkStatus()}};
this.refreshEditEmailLinkStatus=function(){if($(A+"txtEmailAddress").value==""){$(A+"LinkToEdit").style.display=""}else{$nodisplay($(A+"LinkToEdit"))}};
this.showEditDiv=function(){H.toggleEdit()};
this.onIsDueClicked=function(){var K=$(A+"isDue");if(K.checked){G.setDueDateOption(true)}else{G.setDueDateOption(false)}};
this.setDueDateOption=function(K){var N=$(A+"isDue");var M=$(A+"DueDiv");var L=$(A+"HasReminder");if(K){N.checked="Checked";$display(M);L.disabled=false}else{N.checked="";$nodisplay(M);G.setReminderOption(false);L.disabled=true}};
this.setReminderOption=function(L){var M=$(A+"HasReminder");var K=$(A+"ReminderDiv");if(L){M.checked="Checked";$display(K)}else{M.checked="";$nodisplay(K)}}};
g=function(){var Al=c.getFlakeMode();if(Al==L.UniversalNewsSearch||Al==L.TechnoratiBlogSearch){var Am="Pageflakes";if(Y.Profiles[o]!=null){Am=Y.Profiles[o]}else{Y.Profiles[o]=Am}}else{Y.enableRefresh()}};
this.load2=function(Al){if(Al!=null){a=Al.ID;F=Al;c.showFeeds(false);c.loadFavicon(Al)}else{c.showInvalidFeedMsg()}};
this.loadEditArea=function(){var Al=c.getFlakeMode();if(Al==L.UniversalNewsSearch||Al==L.TechnoratiBlogSearch){Y.setEditArea('<table><tr><td>Show:</td><td><select id="'+v+'drpViewMode" onchange="'+v+'.settingChanged()"><option value="'+y+'">Headline only</option><option value="'+d+'">Summary</option><option selected="selected" value="'+K+'">Thumbnail</option><option value="'+k+'">Multiple thumbnails</option></select></td</tr><tr><td width="100px">Open post in:</td><td><select id="'+v+'drpShowPostIn" onchange="'+v+'.settingChanged();"> <option selected="selected" value="NewBrowser">original site (new browser window)</option> <option value="ThisBrowser">original site (Pageflakes browser)</option> <option value="CurrentBrowser">original site (this browser window)</option> </select> <input id="'+v+'txtUrl" style="display: none;" type="text" onkeypress="if( event.keyCode == 13 ) document.getElementById(\''+v+'btnSave\').click()" /></td></tr><tr><td>No of posts:</td><td><select id="'+v+'drpItemCount" onchange="'+v+'.settingChanged()"> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> <option value="6">6</option> <option value="7">7</option> <option value="8">8</option> <option value="9">9</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> <option value="13">13</option> <option value="14">14</option> <option value="15">15</option> <option value="16">16</option> <option value="17">17</option> <option value="18">18</option> <option value="19">19</option> <option value="20">20</option> <option value="25">25</option> </select></td></tr><tr><td>Show tooltip:</td><td><input id="'+v+'chkShowTooltip" type="checkbox" checked="CHECKED" onclick="'+v+'.settingChanged()" /></td><tr><td>Older postings:</td><td><input id="'+v+'chkShowNavigation" checked="CHECKED" type="checkbox" onclick="'+v+'.settingChanged()"/></td></tr></tr><tr><td></td><td><input type="button" id="'+v+'btnSave" class="button" value="Save" onclick="'+v+'.save();" />&nbsp;<input type="button" id="'+v+'btnSave" class="button cancel" value="Cancel" onclick="'+v+'.cancelSave();" /></td></tr></table></div>');if(Al==L.UniversalNewsSearch){Y.setTitle("Universal News Search")}else{Y.setTitle("Universal Blog Search")}}else{if(Al==L.LocalEvent){Events.OnLocationChange.add(this);Y.setEditArea('<table><tr><td style="vertical-align:top">Location: </td><td><table><tr><td><input id="'+v+'defaultLocation" type="radio" check="checked" name="'+v+'location" onclick="'+v+'.onLocationOptionChange()"/></td><td>My location (<span id="'+v+'profileLoc" ></span>)</td></tr><tr><td style="vertical-align:top"><input id="'+v+'customLocation" onclick="'+v+'.onLocationOptionChange()" type="radio" name="'+v+'location" /></td><td>This location:<input type="text" class="Location_Box_Relative" id="'+v+'txtLoc" onkeypress="'+v+'.settingChanged();"/></td></tr></table></td></tr><tr><td>Show:</td><td><select id="'+v+'drpViewMode" onchange="'+v+'.settingChanged()"><option value="'+y+'">Headline only</option><option value="'+d+'">Summary</option><option selected="selected" value="'+K+'">Thumbnail</option><option value="'+k+'">Multiple thumbnails</option></select></td</tr><tr><td width="100px">Open post in:</td><td><select id="'+v+'drpShowPostIn" onchange="'+v+'.settingChanged();"> <option selected="selected" value="NewBrowser">original site (new browser window)</option> <option value="ThisBrowser">original site (Pageflakes browser)</option> <option value="CurrentBrowser">original site (this browser window)</option> </select> <input id="'+v+'txtUrl" style="display: none;" type="text" onkeypress="if( event.keyCode == 13 ) document.getElementById(\''+v+'btnSave\').click()" /></td></tr><tr><td>No of posts:</td><td><select id="'+v+'drpItemCount" onchange="'+v+'.settingChanged()"> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> <option value="6">6</option> <option value="7">7</option> <option value="8">8</option> <option value="9">9</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option> <option value="13">13</option> <option value="14">14</option> <option value="15">15</option> <option value="16">16</option> <option value="17">17</option> <option value="18">18</option> <option value="19">19</option> <option value="20">20</option> <option value="25">25</option> </select></td></tr><tr><td>Show tooltip:</td><td><input id="'+v+'chkShowTooltip" type="checkbox" checked="CHECKED" onclick="'+v+'.settingChanged()" /></td><tr><td>Older postings:</td><td><input id="'+v+'chkShowNavigation" checked="CHECKED" type="checkbox" onclick="'+v+'.settingChanged()"/></td></tr></tr><tr><td></td><td><input type="button" id="'+v+'btnSave" class="button" value="Save" onclick="'+v+'.save();" />&nbsp;<input type="button" id="'+v+'btnSave" class="button cancel" value="Cancel" onclick="'+v+'.cancelSave();" /></td></tr></table></div>');if(typeof GeoLocation!="undefined"){Ag=new GeoLocation($(v+"txtLoc"),false,RenderMode.TABULAR,false)}$DC(function(){var Am=c.getProfileLocationTitle();$(v+"profileLoc").innerHTML=Am})}else{Y.setEditArea('<table><tr><td>Feed URL:</td><td><input type="text" id="'+v+'customUrl" onfocus="this.select();" onkeyup="'+v+'.settingChanged();" value="'+c.getFeedUrl()+'" style="width:200px";/></td></tr><tr><td>Show:</td><td><select id="'+v+'drpViewMode" onchange="'+v+'.settingChanged()"><option value="'+y+'">Headline only</option><option value="'+d+'">Summary</option><option value="'+K+'">Thumbnail</option><option value="'+k+'">Multiple thumbnails</option><option value="'+M+'">4x3 Grid view</option></select></td</tr><tr><td width="100px">Open post in:</td><td><select id="'+v+'drpShowPostIn" onchange="'+v+'.settingChanged();"><option value="RssReader">RSS Reader</option><option selected="selected" value="NewBrowser">original site (new browser window)</option><option value="ThisBrowser">original site (Pageflakes browser)</option><option value="CurrentBrowser">original site (this browser window)</option></select><input id="'+v+'txtUrl" style="display: none;" type="text" onkeypress="if( event.keyCode == 13 ) document.getElementById(\''+v+'btnSave\').click()" /></td></tr><tr><td>Play audio/video in:</td><td><select id="'+v+'drpMediaTarget" onchange="'+v+'.settingChanged()"><option value="'+G.Internal+'">inside the Flake</option><option value="'+G.External+'">external player</option></select></td></tr></tr><tr><td>Title:</td><td><input style="display:none;" id="'+v+'txtTitle" type="text" onkeyup="'+v+'.titleChanged();" /><input id="'+v+'btnResetTitle" class="button" type="button" value="Reset" onclick="'+v+'.setOriginalTitle();" /></td></tr><tr><td>No of posts:</td><td><select id="'+v+'drpItemCount" onchange="'+v+'.settingChanged()"> <option value="1">1</option> <option value="2">2</option><option value="3">3</option> <option value="4">4</option> <option value="5">5</option> <option value="6">6</option> <option value="7">7</option><option value="8">8</option> <option value="9">9</option> <option value="10">10</option> <option value="11">11</option> <option value="12">12</option><option value="13">13</option> <option value="14">14</option> <option value="15">15</option> <option value="16">16</option> <option value="17">17</option><option value="18">18</option> <option value="19">19</option> <option value="20">20</option> <option value="25">25</option> </select></td></tr><tr><td>Show tooltip:</td><td><input id="'+v+'chkShowTooltip" type="checkbox" checked="CHECKED" onclick="'+v+'.settingChanged()" /></td><tr><td>Older postings:</td><td><input id="'+v+'chkShowNavigation" type="checkbox" onclick="'+v+'.settingChanged()"/></td></tr></tr><tr><td></td><td><input class="button" type="button" id="'+v+'btnSave" value="Save" onclick="'+v+'.save();" />&nbsp;<input type="button" id="'+v+'btnSave" class="button cancel" value="Cancel" onclick="'+v+'.cancelSave();" /></td></tr></table></div>')}}};
this.onEvent=function(Al,An){c.refreshResult(false);var Am=c.getProfileLocationTitle();$(v+"profileLoc").innerHTML=Am};
this.loadBody=function(){var Al=c.getFlakeMode();if(Al==L.UniversalNewsSearch||Al==L.TechnoratiBlogSearch){var An="Pageflakes";if(Y.Profiles[o]!=null){An=Y.Profiles[o]}else{Y.Profiles[o]=An}Y.body.innerHTML='<div class="rssSearchKeyDiv"><input class="rssSearchKey" type="text" value="'+An+'" id="'+v+'searchKey" onkeypress="if( event.keyCode == 13 ) '+v+'.universalNews_Search();" onfocus="this.select();"/> <input type="button" value="Search" onclick="'+v+'.universalNews_Search()" /></div><div id="'+v+'divResult" style="width: 100%;"><span style="padding:8px;">Downloading...</span></div><div id="'+v+'divNavigation"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><div id="'+v+'lnkPrev" onclick="'+v+'.prev();" style="display: none; cursor:pointer;cursor:hand; color=navy;">later articles</div></td><td style="width: 100px"></td><td align="right"><div id="'+v+'lnkNext" onclick="'+v+'.next();" style="display: none; cursor:pointer;cursor:hand;text-align:right; color=navy;">older articles</div></td></tr></table></div>'}else{var Am='<div id="'+v+'divPreview" class="rssMediaPreviewWindow" ><table cellpadding="0" cellspacing="0" width="100%"><tr><td align="center"><div id="'+v+'divPlayer"></div></td></tr><tr><td align="center"><input  style="margin-top:10px" type="button" value="< Back" class="button" onclick="'+v+'.switchToRegularView();" /></td></tr></table></div>';Y.body.innerHTML='<div id="'+v+'divResult" style="width:100%;"><span style="padding:8px;">Downloading...</span></div>'+Am+'<div id="'+v+'divNavigation"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><div id="'+v+'lnkPrev" onclick="'+v+'.prev();" style="display: none; cursor:pointer;cursor:hand; color=navy;">later articles</div></td><td style="width: 100px"></td><td align="right"><div id="'+v+'lnkNext" onclick="'+v+'.next();" style="display: none; cursor:pointer;cursor:hand;text-align:right;color=navy;">older articles</div></td></tr></table></div>'}Y.body.style.padding="0px"};
this.loadFavicon=function(An){if(An!=null){var Al=c.getFlakeMode();var Am=$("icon"+v);if(Al==L.UniversalNewsSearch||Al==L.TechnoratiBlogSearch){Y.setIcon(I)}else{if(c.getFlakeMode()==L.LocalEvent){Y.setIcon(p)}else{Y.setIcon(An.Favicon)}}}};
this.onLocationOptionChange=function(){var Al=c.getFlakeMode();if(Al==L.LocalEvent){var An=$(v+"defaultLocation");var Am=$(v+"customLocation");if(An.checked){Y.Profiles[Ad]=x.Default}else{Y.Profiles[Ad]=x.Custom}b=true;c.settingChanged()}};
this.onTitleChange=function(){Y.Profiles[J]=Y.title;Y.save();c.refreshTitle()};
this.autoRefresh=function(){MQ.add(v+"autoRefresh",U,true,function(){try{if(Ae==0){var Am=RC.getCachedRssChannel(a);Am.DownloadStatus=ChannelDownloadStatus.CURRENT_PAGE_DOWNLOAD_PENDING;RC.updateCachedRssChannel(Am,false);c.showFeeds(false)}c.autoRefresh()}catch(Al){PU.dumpException(Al)}})};
this.loadSettings=function(){if(Y.Profiles[H]!=null){$(v+"drpShowPostIn").value=Y.Profiles[H]}c.refreshTitle();if(Y.Profiles[g]==null){Y.Profiles[g]=t}$(v+"drpItemCount").value=Y.Profiles[g];if(App.IsCompactFramework){Y.Profiles[T]="false"}if(Y.Profiles[T]=="true"){$(v+"chkShowTooltip").checked=true}else{$(v+"chkShowTooltip").checked=false}var Am=$(v+"drpMediaTarget");if(Am!=null){if(Y.Profiles[Ab]==null){Am.value=G.Internal}else{Am.value=Y.Profiles[Ab]}}var Al=c.getFlakeMode();if(Y.Profiles[D]=="true"){$(v+"chkShowNavigation").checked=true}else{if(Al==L.UniversalNewsSearch||Al==L.TechnoratiBlogSearch){$(v+"chkShowNavigation").checked=true;Y.Profiles[D]="true"}else{$(v+"chkShowNavigation").checked=false}}if(Y.Profiles[Ah]!=null){$(v+"drpViewMode").value=Y.Profiles[Ah]}else{if(c.getFeedUrl().indexOf("flickr")>0){Y.Profiles[g]="12";$(v+"drpItemCount").value="12";$(v+"drpItemCount").disabled=true;Y.Profiles[Ah]=M;$(v+"drpViewMode").value=M}else{Y.Profiles[Ah]=K;$(v+"drpViewMode").value=K}}RssFlakeResizer.subscribe(c);if($(v+"drpItemCount").value=="12"){$(v+"drpItemCount").disabled=true}else{$(v+"drpItemCount").disabled=false}if(Y.Profiles[Ad]==x.Custom){$DC(function(){if($(v+"defaultLocation")!=null){$(v+"customLocation").checked=true}})}else{$DC(function(){if($(v+"defaultLocation")!=null){$(v+"defaultLocation").checked=true}})}if(Y.Profiles[R]!=null){$(v+"txtLoc").value=Y.Profiles[R]}var Al=c.getFlakeMode();if(Al==L.RegularRSS){$(v+"customUrl").value=c.getFeedUrl()}};
this.settingChanged=function(){O=true;if($(v+"drpViewMode").value==M){$(v+"drpItemCount").value=12;$(v+"drpItemCount").disabled=true;RssFlakeResizer.subscribe(c)}else{$(v+"drpItemCount").disabled=false;RssFlakeResizer.unSubscribe(c)}var Al=c.getFlakeMode();if(Al==L.LocalEvent){if(Y.Profiles[R]!=$(v+"txtLoc").value){b=true}}};
this.changeSettings=function(){if($(v+"drpViewMode").value==M){Y.Profiles[g]=12;$(v+"drpItemCount").value=12;$(v+"drpItemCount").disabled=true;RssFlakeResizer.subscribe(c)}else{$(v+"drpItemCount").disabled=false;RssFlakeResizer.unSubscribe(c)}if(Y.Profiles[g]!=$(v+"drpItemCount").value){Ae=0}Y.Profiles[H]=$(v+"drpShowPostIn").value;Y.Profiles[g]=$(v+"drpItemCount").value;if($(v+"chkShowTooltip").checked){Y.Profiles[T]="true"}else{Y.Profiles[T]="false"}if($(v+"chkShowNavigation").checked){Y.Profiles[D]="true"}else{Y.Profiles[D]="false"}if($(v+"drpMediaTarget")!=null){Y.Profiles[Ab]=$(v+"drpMediaTarget").value}Y.Profiles[Ah]=$(v+"drpViewMode").value;var Al=c.getFlakeMode();if(Al==L.LocalEvent){Y.Profiles[R]=$(v+"txtLoc").value;var An=$(v+"defaultLocation");var Am=$(v+"customLocation");if(An.checked){Y.Profiles[Ad]=x.Default}else{Y.Profiles[Ad]=x.Custom}}var Al=c.getFlakeMode();if(Al==L.RegularRSS){if(Y.Profiles[n]!=$(v+"customUrl").value){i=true;RC.removeChannelFromCache(Y.Profiles[n]);RssServices.Unsubscribe(Y.Profiles[n]);Y.Profiles[n]=$(v+"customUrl").value}}};
this.refreshTitle=function(){var Aq=RC.getCachedRssChannel(a);var Am=Y.title;if(Y.Profiles[J]!=null){Am=Y.Profiles[J]}if(Am.substring(Am.length-1,Am.length)==")"){Am=Am.substring(0,Am.lastIndexOf("("))}if($trim(Am).length==0){Am=c.getOriginalTitle();if($trim(Am).length>0){try{var An=$module(v);An.setTitle(Am);An.isDirty=true;An.save()}catch(Ap){}}}if(Am.length>Z){if(Am.substring(Am.length-3)!="..."){Am=Am.substring(0,Z)+"..."}}Y.setTitle(Am);var Al=c.getFlakeMode();if(Al!=L.UniversalNewsSearch&&Al!=L.TechnoratiBlogSearch){if(Aq!=null){Aq.UnreadCount=0;if(Aq.Feeds!=null){for(var Ao=0;Ao<Aq.Feeds.length;Ao++){if(!Aq.Feeds[Ao].IsRead){Aq.UnreadCount++}}Y.setNumber(Aq.UnreadCount)}}}};
this.getOriginalTitle=function(){var Al=RC.getCachedRssChannel(a);if(Al!=null){return Al.Title}else{return""}};
this.setOriginalTitle=function(){var Al=c.getOriginalTitle();Y.title=Al;Y.Profiles[J]=null;c.refreshTitle()};
this.cancelSave=function(){Y.toggleEdit();c.loadSettings()};
this.save=function(){c.changeSettings();Y.save();var Al=RC.getCachedRssChannel(a);if(Al!=null){if(parseInt(Y.Profiles[g])>Al.Feeds.length){c.downloadFeeds(Al.FeedSource,false,1)}}Y.toggleEdit();c.resizeGridView();c.refreshResult(false)};
this.getFlakeMode=function(){var Al=c.getRawUrl();if(Al.indexOf("locationaware=true")>0){return L.LocalEvent}else{if(Al.indexOf("flakemode=universalnewssearch")>0){return L.UniversalNewsSearch}else{if(Al.indexOf("flakemode=technoratiblogsearch")>0){return L.TechnoratiBlogSearch}else{return L.RegularRSS}}}};
this.titleEdited=function(){Y.Profiles.TitleEdited=1;e.apply(Y)};
this.isTitleEdited=function(){return(Y.Profiles.TitleEdited=="1")};
this.getRawUrl=function(){var Al="";if(Y.Profiles[n]==null){Al=unescape(Y.url.substring(Y.url.indexOf("?")+5))}else{Al=Y.Profiles[n]}if(Al.indexOf("http")==-1){Al="http://"+Al}return Al};var q=" US us United States united states USA usa";
this.getFeedUrl=function(){var Am=c.getRawUrl();if(c.getFlakeMode()==L.LocalEvent){var Ar=App.My.City;var An=App.My.State;var Aq=App.My.Country;var Ap=App.My.Country;if(Y.Profiles[Ad]==x.Custom){Ag.parseLocation();Ar=Ag.City;An=Ag.State;Aq=Ag.Country;Ap=Ag.Country}if(q.indexOf(Aq)>0){if(An.length>0){Ap=An}}if(s){Am=String.format(Am,Ar,An,Aq,(An.length==0?Aq:An),Ap)}else{Am=String.format(Am,"",An,Aq,(An.length==0?Aq:An),Ap)}}else{if(c.getFlakeMode()==L.UniversalNewsSearch){var As="en";var Al="us";if(App.My.Country!=null){if(App.My.Country.length>0){Al=App.My.Country}}if(startupInfo.Language!=null){As=startupInfo.Language}var Ao=Y.Profiles[o];if(Ao.length>0){Am=String.format(Am,As,Al,Ao)}else{Am=""}}else{if(c.getFlakeMode()==L.TechnoratiBlogSearch){var Ao=Y.Profiles[o];if(Ao.length>0){Am=Am.replace("&flakemode=technoratiblogsearch","");Am=String.format(Am,Ao)}else{Am=""}}}}return Am};
this.setFeedUrl=function(Al){var Am=Y.url.substring(0,Y.url.indexOf("?"));Y.url=Am+"?url="+Al};
this.refreshResult=function(Al){$ND(v+"divNavigation");var Am=c.getFeedUrl();if(Am.length>0){this.downloadFeeds(Am,Al,2,0)}};
this.showDownloadInProgress=function(){var Al=$(v+"divResult");Al.innerHTML="<div class='downloadInProgress'>Loading...</div>";$("refresh"+v).className="refreshInProgress_icon"};
this.isFeedTooOld=function(Am){var Ao=86400000;var Al=new Date();Al.getHours();var An=Al-Am.PublishDate;if(An>Ao){return true}else{return false}};
this.sortFeedForThumbnailView=function(At,Am,Ao,Al){for(var Aq=Am;Aq<Ao;Aq++){var As=At[Aq];var Ar=As.PreviewImage;if(Ar.length>0){$(v+"drpViewMode").value=K;if(Al){Y.Profiles[Ah]=$(v+"drpViewMode").value}if(Aq!=Am&&!c.isFeedTooOld(As)){var An=At[Aq];for(var Ap=Aq-1;Ap>=Am;Ap--){At[Ap].SerialNo=At[Ap+1].SerialNo;At[Ap+1]=At[Ap]}An.SerialNo=At[Am].SerialNo;At[Am]=An}break}else{if(As.Description.length>0||As.EncodedContent.length>0){}else{if(Y.Profiles[Ah]==null){}}}}};
this.updateEditAreaOptions=function(Ao){c.ensureUI();var Al=false;if(Ao!=null){if(Ao.Feeds.length>0){for(var An=0;An<Ao.Feeds.length;An++){if(Ao.Feeds[An].PreviewImage.length>0){Al=true;break}}}}if(!Al){var Am=$(v+"drpViewMode");var Ap=Am.getElementsByTagName("option");for(var An=0;An<Ap.length;An++){if(Ap[An].getAttribute("value")==M){Am.removeChild(Ap[An])}}}};
this.ensureUI=function(){var Al=$(v+"divResult");if(null==Al){c.loadEditArea();c.loadBody();c.loadSettings()}};
this.downloadFeeds=function(Ar,Am,Aq,Ap){if(Ap==null){Ap=0}var An=$(v+"divResult");if(null!=An){c.showDownloadInProgress()}var Ao=Y.getProfile(g,t);var Al=c.getFlakeMode();if(Al==L.UniversalNewsSearch||Al==L.TechnoratiBlogSearch){Ao=50}RssServices.GetRSSChannel8(Ar,Am,Ap,Ao,true,function(At){c.ensureUI();if(At!=null){a=At.ID;F=At;if(E){E=false;c.loadFavicon(At)}c.updateEditAreaOptions(At);At.DownloadStatus=ChannelDownloadStatus.CURRENT_PAGE_DOWNLOAD_PENDING;if(At.Feeds.length>0){var As=c.getFlakeMode();if(As==L.UniversalNewsSearch||As==L.TechnoratiBlogSearch){F=At}else{RC.updateCachedRssChannel(At,false);RC.addToSubscriberList(c)}if(At.Feeds.length<Ao){c.showFeeds(false)}else{c.showFeeds(true)}}else{var Au=c.getFeedUrl();if(c.getFlakeMode()==L.LocalEvent){if(!(Au.indexOf(Ak)>0)){s=false;Au=c.getFeedUrl();if(Aq>0){c.downloadFeeds(Au,true,--Aq,0)}}else{RC.updateCachedRssChannel(At,false);RC.addToSubscriberList(c);c.showFeeds(false)}}else{RC.updateCachedRssChannel(At,false);RC.addToSubscriberList(c);c.showFeeds(false)}}c.refreshTitle()}else{c.showInvalidFeedMsg()}},function(As){c.ensureUI();if(Aq==0){$(v+"divResult").innerHTML=As+' Please <a href="#" onclick="'+v+'.refreshResult(true)">click here</a> to try again.'}else{c.downloadFeeds(Ar,Am,--Aq,Ap)}})};
this.showInvalidFeedMsg=function(){c.ensureUI();var Al=$(v+"divResult");Al.innerHTML="<div style='padding:5px;'>The address you have entered does not contain an RSS Feed. Please check the URL in the Flake settings.</div>";Y.setTitle("Error retrieving RSS feed");Y.setIcon("images/rss.jpg")};
this.getProfileLocationTitle=function(){var An=c.getFeedUrl();var Am="";if(App.My.City!=""){var Al=App.My.Country;if(q.indexOf(App.My.Country)>0){Al=App.My.State}if(An.indexOf(Ak)>0){Am=Al}else{Am=App.My.City+", "+Al}}else{Am="Local news"}return Am};
this.getLocationTitle=function(){var Am="";var An=c.getFeedUrl();if(Y.Profiles[Ad]!=x.Custom){Am=c.getProfileLocationTitle()}else{Ag.parseLocation();if(Ag.City!=""){var Al=Ag.Country;if(q.indexOf(Ag.Country)>0){Al=Ag.State}if(An.indexOf(Ak)>0){Am=Al+" News"}else{Am=Ag.City+", "+Al+" News"}}else{Am="Local news"}}return Am};
this.showFeeds=function(Au){c.ensureUI();var As=null;var Am=c.getFlakeMode();if((Am==L.UniversalNewsSearch||Am==L.TechnoratiBlogSearch)&&Y.Profiles[o]==""){$(v+"divResult").innerHTML="<div style='padding:5px'>Please enter search key.</div>";$nodisplay(v+"divNavigation");return}if((Am==L.UniversalNewsSearch||Am==L.TechnoratiBlogSearch)&&F!=null){As=F}else{As=RC.getCachedRssChannel(a)}var Ar=c.getFeedUrl();if(c.getFlakeMode()==L.LocalEvent){if(!c.isTitleEdited()){var Av=c.getLocationTitle();Y.setTitle(Av)}}var Ax=$(v+"divResult");if(Ax==null){return}if(Ax.offsetWidth>0){C=Math.round(Ax.offsetWidth/A);C-=8;j=Math.round(Ax.offsetWidth/f);W=Ax.offsetWidth-30}if(i){if(Y.Profiles[J]==null){c.setOriginalTitle()}$DC(function(){As=RC.getCachedRssChannel(a);c.loadFavicon(As)});Y.save()}var An=true;$("refresh"+v).className="refresh_icon";if(As==null){Ax.innerHTML='There was a connection problem. Please <a href="javascript:void(0)" onclick="'+v+'.refreshResult(true)">click here</a> to try again.';return}RC.sortFeedList(As.Feeds,false);var Aw=As.Feeds;if(Aw.length==0){Ax.innerHTML="<div style='padding:5px;'>No items found.</div>";return}if(Ae>=Aw.length){var Am=c.getFlakeMode();if(Au&&Am!=L.UniversalNewsSearch&&Am!=L.TechnoratiBlogSearch){c.downloadFeeds(As.FeedSource,false,1,Ae);return}}else{if(Y.Profiles[Ah]==M){if((Aw.length-Ae)<12){if(Au){c.downloadFeeds(As.FeedSource,false,1,Ae);return}}}}var Ap=Ae+parseInt(Y.Profiles[g]);if(Ap>Aw.length){Ap=Aw.length}if(Ae>=Ap&&Ae>0){Ae-=parseInt(Y.Profiles[g]);An=false}if(Y.Profiles[Ah]==null||Y.Profiles[Ah]==K){c.sortFeedForThumbnailView(Aw,Ae,Ap,false)}var At="";if(Y.Profiles[Ah]==M){At=c.getGridViewHTML(Aw,Ae,Ap)}else{At=c.getListViewHTML(Aw,Ae,Ap)}var Aq=Ap-Ae;var Al=$(v+"lnkPrev");if(Ae>0){Al.style.display="block"}else{Al.style.display="none"}var Ao=$(v+"lnkNext");if(Y.Profiles[g]==Aq&&An){Ao.style.display="block"}else{Ao.style.display="none"}if(Al.style.display=="none"&&Ao.style.display=="none"){$(v+"divNavigation").style.display="none"}else{if(Y.Profiles[D]=="true"){$(v+"divNavigation").style.display="block";$(v+"divNavigation").style.padding="5px"}else{Ao.style.display="none";Al.style.display="none";$(v+"divNavigation").style.display="none"}}c.refreshTitle();Ax.innerHTML=At;c.resizeGridView()};
this.getListViewHTML=function(Al,Ao,Ar){var Aq=new Sys.StringBuilder("");Aq.append('<div class="rssOutputWindow"><table border="0" cellpadding="0" cellspacing="0" width="100%">');var Am=false;for(var An=Ao;An<Ar;An++){if(Ar-1==An){Am=true}if(Al[An].Description.length>0){var Ap=c.getSingleRowHTML(Al[An],C,An,Am);Aq.append(Ap)}else{var Ap=c.renderHeadlineView(Al[An],C);Aq.append(Ap)}}Aq.append("</table></div>");return Aq.toString()};
this.getGridViewHTML=function(Ax,At,Ar){var As=new Sys.StringBuilder("");As.append('<table width="100%"><tr><td>');var Al="";var Aw=null;var Am=$(v+"divResult").offsetWidth;var Ap=Am-16;var Au=(Ap/4);var An=0;for(var Ao=At;Ao<Ar;Ao++){Aw=Ax[Ao];Al=c.getLinkScript(Aw,"lnk"+Aw.ID);var Av=Ax[Ao].PreviewImage;if(Av.length>0){An++;var Aq=c.getPreviewImageHTML(Aw,Av,Au,Au,null,"gridItem","gridItem");As.append(Aq);c.loadThumbnail(Ax[Ao].PreviewImage,"img"+Ax[Ao].ID)}}if(An==0){As.append('No image found. Please <a onclick="'+v+'.showEditDiv()" href="javascript:void(0)">click here</a> to edit settings.')}As.append("</td></tr></table>");return As.toString()};
this.showEditDiv=function(){Y.toggleEdit()};
this.resizeFlake=function(){};
this.resizeFlake2=function(){if(Y.Profiles[Ah]==M){c.resizeGridView()}else{c.showFeeds()}};
this.resizeGridView=function(){if(Y.Profiles[Ah]==M){var Ap=$(v+"divResult");var Ar=Ap.offsetWidth;var Aq=Ar-16;var Am=Aq/4;var Al=Ap.getElementsByTagName("img");for(var An=0;An<Al.length;An++){if(Al[An].getAttribute("type")=="playButton"){Al[An].style.top=(Am-16)+"px";Al[An].style.left=(Am-19)+"px"}else{Al[An].setAttribute("height",Am);Al[An].setAttribute("width",Am)}}var Ao=Ap.getElementsByTagName("div");for(var An=0;An<Ao.length;An++){if(Am>0&&Ao[An].className!="downloadInProgress"){Ao[An].style.width=(Am+1)+"px"}}}};
this.getSingleRowHTML=function(Ap,Ao,Am,Al){var An=Y.Profiles[Ah];switch(An){case y:return c.renderHeadlineView(Ap,Ao);break;case d:return c.renderSummaryView(Ap,Ao,Al);break;case K:if(Am==Ae){if(Ap.PreviewImage.length>0){return c.renderThumbnailView(Ap,Ao,Al)}else{return c.renderSummaryView(Ap,Ao,Al)}}else{return c.renderHeadlineView(Ap,Ao)}break;case null:case undefined:if(Am==Ae){if(Ap.PreviewImage.length>0){return c.renderThumbnailView(Ap,Ao,Al)}else{return c.renderSummaryView(Ap,Ao,Al)}}else{return c.renderHeadlineView(Ap,Ao)}break;case k:if(Ap.PreviewImage.length>0){return c.renderThumbnailView(Ap,Ao,Al)}else{return c.renderSummaryView(Ap,Ao,Al)}break}};
this.renderHeadlineView=function(Aq,Ao){var Ap=c.getFormattedTitle(Aq,Ao);var An;var Am=c.getLinkScript(Aq,"lnk"+Aq.ID);var Al=c.getPreviewButtonHtml(Aq.ID);if(Aq.IsRead){An='<tr><td class="headlineView_rssitem_body"><div class="headlineView_bullet">&nbsp;</div><div class="headlineView_titleDiv"><a id="lnk'+Aq.ID+'" viewMode="'+y+'" '+Am+' class="headlineView_title_read">'+Ap+"</a>"+Al+"</div></td></tr>"}else{An='<tr><td class="headlineView_rssitem_body"><div class="headlineView_bullet">&nbsp;</div><div class="headlineView_titleDiv"><a id="lnk'+Aq.ID+'" viewMode="'+y+'" '+Am+' class="headlineView_title_unread">'+Ap+"</a>"+Al+"</div></td></tr>"}return An};
this.renderSummaryView=function(Au,As,Al){var Ar=c.getFormattedTitle(Au,j);var Am=c.getFormattedDescription(Au,As*2);var An;var At=c.getLinkScript(Au,"lnk"+Au.ID);var Ap=c.getLinkScript(Au,"lnkDes"+Au.ID);var Aq="summaryView_rssitem_body";var Ao=c.getPreviewButtonHtml(Au.ID);if(Al){Aq="summaryView_rssitem_body_lastItem"}if(Au.IsRead){An='<tr><td class="'+Aq+'"><a id="lnk'+Au.ID+'" viewMode="'+d+'" '+At+' class="summaryView_title_read">'+Ar+'</a><a id="lnkDes'+Au.ID+'" '+Ap+' class="summaryView_desc">'+Am+"</a>"+Ao+"</td></tr>"}else{An='<tr><td class="'+Aq+'"><a id="lnk'+Au.ID+'" viewMode="'+d+'" '+At+' class="summaryView_title_unread">'+Ar+'</a><a id="lnkDes'+Au.ID+'" '+Ap+' class="summaryView_desc">'+Am+"</a>"+Ao+"</td></tr>"}return An};
this.renderThumbnailView=function(AB,Ay,Am){var Az=AB.PreviewImage;var Aw=$$("img");Aw.id=v+AB.ID;Aw.setAttribute("rssItemId",AB.ID);Aw.style.left="-2000px";Aw.style.top="0px";Aw.style.position="absolute";document.body.appendChild(Aw);PF.addEvent(Aw,"load",function(){var AC=this.getAttribute("rssItemId");c.renderThumbnailView2(this.src,this.width,this.height,AC);document.body.removeChild(this)});if(Browser.isIE){setTimeout('$("'+v+AB.ID+'").src = "'+Az+'";',50)}else{Aw.src=Az}PF.addEvent(Aw,"error",function(){var AC=this.getAttribute("rssItemId");if(Browser.isIE){MQ.add("CreateRssUI"+AC,100,true,c.renderThumbnailView2(this.src,Math.round(W/3),70,AC))}else{c.renderThumbnailView2(this.src,this.width,this.height,AC)}});var Au="thumbnailView_rssitem_body";if(Am){Au="thumbnailView_rssitem_body_lastItem"}var An=$("td"+v+AB.ID);var Aq="100";if(An!=null){if(An.offsetHeight>0){Aq=An.offsetHeight}}var Av=c.getFormattedTitle(AB,j);var Ao=c.getFormattedDescription(AB,Ay*2);var As=c.getPreviewButtonHtml(AB.ID);var Ax="thumbnailView_title_unread";if(AB.IsRead){Ax="thumbnailView_title_read"}var AA=c.getLinkScript(AB,"lnk"+AB.ID);var Ar=c.getLinkScript(AB,"lnkDes"+AB.ID);var Al=c.getLinkScript(AB,"lnkDesImg"+AB.ID);var At='<div><a class="'+Ax+'" '+AA+' id="lnk'+AB.ID+'" viewMode="'+K+'">'+Av+'</a><a id="lnkDesImg'+AB.ID+'" '+Al+'><div style="width:'+(W/3)+'px;" class="thumbnailDummyImage">&nbsp;</div></a><div class="thumbnailView_desc"><a id="lnkDes'+AB.ID+'" class="thumbnailView_desc"'+Ar+" >"+Ao+"</a>"+As+"</div></div>";var Ap='<tr><td class="'+Au+'" id="td'+v+AB.ID+'">'+At+"</td></tr>";return Ap};
this.getItemFromChannel=function(Al){for(var Am=0;Am<F.Feeds.length;Am++){if(F.Feeds[Am].ID==Al){return F.Feeds[Am]}}return null};
this.renderThumbnailView2=function(AC,As,AA,Av){var Az=null;var Aq=$("td"+v+Av);if(Aq==null){return}var AB=c.getFlakeMode();if(AB==L.UniversalNewsSearch||AB==L.TechnoratiBlogSearch){Az=c.getItemFromChannel(Av)}else{Az=RC.getCachedRssFeed(a,Av)}var Am=c.getFormattedTitle(Az,j);var Aw="thumbnailView_title_unread";if(Az.IsRead){Aw="thumbnailView_title_read"}var Ar=c.getLinkScript(Az,"lnk"+Az.ID);var Ax=c.getLinkScript(Az,"lnkDes"+Az.ID);if(Az.PreviewImage.length==0||As==0){var Ap=W-As;var Al=Math.round(Ap/A);var Ay=c.getFormattedDescription(Az,Al*2);var At=c.getPreviewButtonHtml(Az.ID);Aq.innerHTML='<div><a class="'+Aw+'" '+Ar+' id="lnk'+Av+'" viewMode="'+K+'">'+Am+'</a><div class="thumbnailView_desc"><a id="lnkDes'+Av+'" class="thumbnailView_desc"'+Ax+" >"+Ay+"</a>"+At+"</div></div>"}else{if(As>(W/3)){var Ao=AA/As;As=W/3;AA=Ao*As;As=Math.round(As);AA=Math.round(AA)}var Ap=W-As;var Al=Math.round(Ap/A);var AD=c.getLinkScript(Az,"lnkDesImg"+Az.ID);var An=Math.round(AA/N);var Ay=c.getFormattedDescription(Az,Al*An);var Au=c.getPreviewImageHTML(Az,AC,AA,As,"thumbnailView_image",null,"thumbnailView_image");Aq.innerHTML='<a class="'+Aw+'" '+Ar+' id="lnk'+Av+'" viewMode="'+K+'">'+Am+"</a><div>"+Au+'<div class="thumbnailView_desc"><a id="lnkDes'+Av+'" class="thumbnailView_desc"'+Ax+" >"+Ay+"</a></div></div>"}};
this.getPreviewImageHTML=function(AA,Al,Av,Am,AC,Ao,Aq){var Az="";if(Aq!=null){Az=' class="'+Aq+'" '}var An="";if(Ao!=null){An=' class="'+Ao+'" '}var As="";if(AC!=null){As=' class="'+AC+'" '}var Aw="img"+AA.ID;var Ar="";var AD=false;if(AA.MediaGroup!=null){var Ap=EmbeddedMedia.getBestMediaFormatForClient(AA.MediaGroup);if(Ap!=null&&Ap.URL!=null&&Ap.URL.length>0){AD=true;if(Y.Profiles[Ab]==G.External){Ar=' target="_blank" href="'+Ap.URL+'" '}else{if(Y.Profiles[Ab]==G.Internal){Ar='onclick="'+v+".showPreview(event,"+AA.ID+')" '}}}}if(AD){var Ax=Av-14;var Ay=Am-19;var AB="lnkDesImg"+AA.ID;var At=' onmouseover="'+v+".title_onmouseover(event,"+AA.ID+", '"+AB+'\');" onmouseout="'+v+'.title_onmouseout();" ';var Au='<a id="'+AB+'" '+An+Ar+At+"><div "+As+' class="prevImgDiv" style="width:'+Am+'"><img '+Az+' id="'+Aw+'" width="'+Am+'" height="'+Av+'" src="'+Al+'" /><img type="playButton" id="imgPlayMedia'+AA.ID+'" style="z-index:10; position: absolute; left:'+Ay+"px; top:"+Ax+'px;" src="'+IMAGE_PREFIX+'App_Themes/common/mediaPreviewButton.gif" alt="'+Lang.CLICK_TO_PLAY+'" title="'+Lang.CLICK_TO_PLAY+'" class="rssMediaPreviewButton" /></div></a>';return Au}else{Ar=c.getLinkScript(AA,"lnkDesImg"+AA.ID);var Au='<a id="lnkDesImg'+AA.ID+'" '+Ar+"><img "+Az+' width="'+Am+'" height="'+Av+'" src="'+Al+'" /></a>';return Au}};
this.getPreviewButtonHtml=function(Al){var Am='<div style="display:inline;" id="divDummy'+Al+'" ></div>';setTimeout(function(){var An=$("divDummy"+Al);if(An!=null){An.innerHTML=c.getPreviewButtonHtml2(Al)}},100);return Am};
this.getPreviewButtonHtml2=function(An){var Ap=null;var Al=c.getFlakeMode();if(Al==L.UniversalNewsSearch||Al==L.TechnoratiBlogSearch){Ap=c.getItemFromChannel(An)}else{Ap=RC.getCachedRssFeed(a,An)}var Aq="";if(Ap.MediaGroup!=null){var Ao=EmbeddedMedia.getBestMediaFormatForClient(Ap.MediaGroup);if(Ao!=null){var Am=Y.Profiles[Ab];if(Ao.URL!=null&&Ao.URL.length>0){if(Am==G.External){Aq='<a href="{0}" target="_blank"><img style="z-index:100" src="'+IMAGE_PREFIX+'App_Themes/common/mediaPreviewButton.gif" alt="'+Lang.CLICK_TO_PLAY+'" title="'+Lang.CLICK_TO_PLAY+'" class="rssMediaPreviewButton"/></a>';Aq=String.format(Aq,Ao.URL)}else{if(Am==G.Internal){Aq='<img style="z-index:100" src="'+IMAGE_PREFIX+'App_Themes/common/mediaPreviewButton.gif" alt="'+Lang.CLICK_TO_PLAY+'" title="'+Lang.CLICK_TO_PLAY+'" class="rssMediaPreviewButton" onclick="'+v+'{0}"/>';Aq=String.format(Aq,".showPreview(event,"+An+")")}}}}}return Aq};
this.switchToPreview=function(){$ND(v+"divResult");$D(v+"divPreview");$ND(v+"divNavigation")};
this.switchToRegularView=function(){EM.removePlayer(Af);var Am=$(v+"divPlayer");if(Am!=null){Am.innerHTML=""}$D(v+"divResult");$D(v+"divNavigation");$ND(v+"divPreview");var Al=$(v+"divResult");if(Al.offsetHeight<20){c.showFeeds(false)}};
this.showPreview=function(Aq,Ar){w=Ar;var Am=RC.getCachedRssFeed(a,Ar);c.switchToPreview();var Ao=EmbeddedMedia.getBestMediaFormatForClient(Am.MediaGroup);var An=$(v+"divPreview").offsetWidth-10;if(An>350){An=350}var Al=Math.abs(Math.round(An/10*8));var Ap=EmbeddedMedia.getPlayerHtml2(Af,Am.MediaGroup,Ao.URL,Al,An);$(v+"divPlayer").innerHTML=Ap};
this.showPhotoPreview=function(Al){c.switchToPreview();$(v+"divPreview").innerHTML="<img src='"+Al.PreviewImage+"' />"};
this.getLinkScript=function(Ao,Al){var Am=' onmouseover="'+v+".title_onmouseover(event,"+Ao.ID+", '"+Al+'\');" onmouseout="'+v+'.title_onmouseout();" ';var An="";if(App.IsCompactFramework){An='href="'+Ao.Link+'" ';if(Y.Profiles[H]==null||Y.Profiles[H]==B){An+=' target="_blank" '}}else{if(Y.Profiles[H]==null||Y.Profiles[H]==B){An='target="_blank" href="'+Ao.Link+'"  onclick="'+v+".title_onclick("+Ao.ID+');" '}else{if(Y.Profiles[H]==X){An='href="'+Ao.Link+'" onclick="'+v+".title_onclick("+Ao.ID+');" '}else{An='href="javascript:void(0);" onclick="'+v+".title_onclick("+Ao.ID+');" '}}}return An+Am};
this.title_onmouseout=function(){TM.hideTooltip()};
this.title_onclick=function(An){var Am=RC.getCachedRssFeed(a,An);if(App.IsCompactFramework){top.location=Am.Link}else{TM.hideTooltip();var Ao=$("lnk"+An);if(Ao!=null){var Ap=Ao.getAttribute("viewMode");switch(Ap){case y:Ao.className="headlineView_title_read";break;case d:Ao.className="summaryView_title_read";break;case K:Ao.className="summaryView_title_read";break}}var Al=c.getFlakeMode();if(Al!=L.UniversalNewsSearch&&Al!=L.TechnoratiBlogSearch){c.markAsRead(An)}c.refreshTitle();if(Y.Profiles[H]==P){var Aq=c.stripHTML(Am.Title);App.showHtmlViewer(Aq,Am.Link)}else{if(Y.Profiles[H]==X){}else{if(Y.Profiles[H]==null||Y.Profiles[H]==B){}else{if(Y.Profiles[H]==Aj){FeedViewer.loadChannel(a,An)}}}}}};
this.title_onmouseover=function(Al,At,Ap){Al=$fix(Al);if(Y.Profiles[T]=="true"){var Ar=Lang.NO_DESCRIPTION_PROVIDED;var An=c.getFlakeMode();var Ao=null;if((An==L.UniversalNewsSearch||An==L.TechnoratiBlogSearch)&&F!=null){Ao=c.getFeed(F,At)}else{Ao=RC.getCachedRssFeed(a,At)}var As=$(Ap);if(Ao!=null){var Aq="";if(Ao.Description.trim().length>0){Aq=Ao.Description}else{Aq=Ao.EncodedContent}Aq=c.stripHTML(Aq);As.onmouseover=null;if(TM!=null){if($trim(Aq).length==0){TM.setTooltip(As,Ar);TM.showTooltipNow(Al,As,Ar)}else{if(Aq.length>Q){var Am=Aq.substring(0,Q)+"...";TM.setTooltip(As,Am);TM.showTooltipNow(Al,As,Am)}else{TM.setTooltip(As,Aq);TM.showTooltipNow(Al,As,Aq)}}}}}};
this.getFeed=function(An,Am){for(var Al=0;Al<An.Feeds.length;Al++){if(An.Feeds[Al].ID==Am){return An.Feeds[Al]}}return null};
this.markAsRead=function(Al){RC.changeReadStatus(a,Al,true)};
this.getFeedLinkByRSSItemId=function(An){var Al=RC.getCachedRssChannel(a).Feeds;for(var Am=0;Am<Al.length;Am++){if(Al[Am].ID==An){return Al[Am].Link}}return""};
this.prev=function(){Ae=Ae-parseInt(Y.Profiles[g]);c.showFeeds(false)};
this.next=function(){Ae=Ae+parseInt(Y.Profiles[g]);c.showFeeds(true)};
this.getFormattedTitle=function(Am,An){var Al="";if(Am.Title.length>0){Al=c.stripHTML(Am.Title)}else{if(Am.Description.length>0){Al=c.stripHTML(Am.Description)}else{if(Am.EncodedContent.length>0){Al=stripHTML(Am.EncodedContent)}}}if(Al.length<10){return Al}else{return c.getFullSentences(Al,An)}};
this.getFormattedDescription=function(Am,An){var Ao="";if(Am.Description.length>0){Ao=c.stripHTML(Am.Description)}else{if(Am.EncodedContent.length>0){Ao=c.stripHTML(Am.EncodedContent)}}var Al=c.getFullSentences(Ao,An);if(Am.MediaGroup==null){Al+='<img src="'+IMAGE_PREFIX+'App_Themes/common/rss_desc_link.gif" class="rss_desc_link"/>'}return Al};
this.stripHTML=function(Al){return Al.replace(/<[^>]*>/g,"")};var l=["?","."];
this.getSentences=function(Au,Al){var At=Au.split(l[0]);var Ao=new Array();var Av=0;for(var Aq=0;Aq<At.length;Aq++){if(Av<Al){Ao[Aq]=At[Aq];if(Aq+1<At.length){Ao[Aq]+=l[0]}}Av+=At[Aq].length}for(var Aq=1;Aq<l.length;Aq++){var Am=new Array();var Ar=0;for(var Ap=0;Ap<Ao.length;Ap++){var As=Ao[Ap].split(l[Aq]);for(var An=0;An<As.length;An++){Am[Ar++]=As[An]}}seelctedSentences=Am}return Ao};
this.getFullSentences=function(Ar,Am){var Ap=4;var Al="";var An=c.getSentences(Ar,Am);if(An.length>0){if(An[0].length>Am){Al=An[0].substring(0,Am-3)+"..."}else{var Aq=An.length;for(var Ao=0;Ao<Aq;Ao++){if(An[Ao].length<=Am-Al.length){if(An[Ao].length>Ap){Al+=An[Ao]}else{if(Ao+1<Aq){if(An[Ao].length+An[Ao+1].length<Am-Al.length){Al+=An[Ao]}else{if(Ao==0){Al+=An[Ao];Al+=An[Ao+1].substring(0,Am-Al.length-3)+"..."}else{break}}}}}else{break}}}return Al}else{return Ar}};
this.loadThumbnail=function(Ao,Al){var An=Ao;var Am=$$("img");Am.id=v+Al;Am.setAttribute("imgId",Al);Am.style.left="-4000px";Am.style.top="0px";Am.style.position="absolute";document.body.appendChild(Am);Am.onload=function(){try{var Aq=this.getAttribute("imgId");var Ap=document.getElementById(Aq);Ap.setAttribute("src",this.src)}catch(Ar){}document.body.removeChild(this)};if(Browser.isIE){setTimeout('$("'+v+Al+'").src = "'+An+'";',50)}else{Am.src=An}Am.onerror=function(){document.body.removeChild(this)}};
this.universalNews_Search=function(){var Al=$(v+"searchKey");Y.Profiles[o]=Al.value;Y.save();if(Al.value.length>0){Ae=0;c.refreshResult(false)}else{$(v+"divResult").innerHTML="<div style='padding:5px'>Please enter search key.</div>";$nodisplay(v+"divNavigation")}}};

var RssFlakeResizer={flakeList:[],subscribe:function(A){RssFlakeResizer.flakeList.add(A)},unSubscribe:function(A){RssFlakeResizer.flakeList.remove(A)},resizeAllGridView:function(){for(var A=0;A<RssFlakeResizer.flakeList.length;A++){RssFlakeResizer.flakeList[A].resizeFlake()}}};
var $PageFlakesHelper={newNode:function(A){return $$(A)},select:function(D,A){var C=[];for(var B=0;B<D.length;B++){if(A(D[B])){C.push(D[B])}}return C},find:function(D,A){for(var B=0;B<D.length;B++){var C=A(D[B]);if(C){return D[B]}}return null},foreach:function(B,C){for(var A=0;A<B.length;A++){C(B[A],(A==B.length-1))}},bind:function(B,A){return function(){return B.apply(A,arguments)}},bindAsEventListener:function(B,A){return function(C){return B.call(A,C||window.event)}},trim:function(A){return A.replace(/^\s*|\s*$/g,"")},stripTags:function(A){return A.replace(/<\/?[^>]+>/gi,"")},newLocation:function(A,B){return{label:A,p:B,toggle:"none"}},mapArrayToString:function(A){var D="[";for(var C=0;C<A.length;C++){var E=A[C];D+="{";for(var B in E){D+="'"+B+"': '"+E[B]+"',"}D=D.substring(0,D.length-1);D+="},"}D=D.substring(0,D.length-1);D+="]";return D},stringToMapArray:function(str){eval("var arr = "+str);return arr},getXmlDoc:function(A){return new XMLDOM(A)},getFirstNode:function(B,A){return this.getNodes(B,A)[0]},getNodes:function(C,B){var D=B.split(":");if(D.length==1){return C.getElementsByTagName(D[0])}else{var A=C.getElementsByTagName(D.shift())[0];while(D.length!=1){A=A.getElementsByTagName(D.shift())[0]}return A.getElementsByTagName(D.shift())}},addRefreshLink:function(B,A){},isFlashInstalled:function(){var C;if(navigator.plugins){C=navigator.plugins["Shockwave Flash"]!=null}if(!C&&ie){for(var A=8;A>=3;A--){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+A);return true}catch(B){}}}return C},setClassName:function(B,A){B.className=A},encodeURIComponent:(window.encodeURIComponent?window.encodeURIComponent:escape)};
var FlakeMenuTimer;
var FlakeMenu={flakeId:null,icon:null,me:null,justOpened:false,dispose:function(){FlakeMenu.me=null;FlakeMenu.icon=null},init:function(){FlakeMenu.me=$("sendFlakeOptionsMenu");FlakeMenu.flakeId=FlakeMenu.me.flakeId;FlakeMenu.icon=$("sendFlake"+FlakeMenu.flakeId);FlakeMenu.show()},show:function(){var G=$("sendFlakeOptionsMenu");var C=$("sendFlake"+FlakeMenu.flakeId);var H=PU.getPosition(C);G.flakeId=this.id;var F=(H[0]-10);var B=130;var A=G.getElementsByTagName("b")[0];if(F+B>window.Width){var D=window.Width-B;var E=F-D;A.style.marginLeft=(10+E)+"px";F=D}else{A.style.marginLeft="10px"}G.style.left=F+"px";G.style.top=(H[1]+15)+"px";$D(G);hoverClassName="sendFlake_icon sendFlake_icon_hover";C.className=hoverClassName;C.parentNode.className="flake_toolbar flake_toolbar_hover";if(Browser.isIE){$stopBubble()}FlakeMenu.justOpened=true;document._onclick=document.onclick;document.onclick=function(){if(FlakeMenu.justOpened==false||Browser.isIE){FlakeMenu.hide();document.onclick=document._onclick;document._onclick=null}FlakeMenu.justOpened=false}},hide:function(){$ND(FlakeMenu.me);var A=$("sendFlake"+FlakeMenu.flakeId);if(A){A.className="sendFlake_icon"}FlakeMenu.icon.parentNode.className="flake_toolbar"},emailFriend:function(){FlakeMenu.hide();SendFlakeToFriend.init(FlakeMenu.flakeId)},putInBlog:function(){$module(FlakeMenu.flakeId).publish();FlakeMenu.hide()},opqTb:function(){opqTb(FlakeMenu.icon.parentNode.parentNode)}};var hoverClassName;function hover(A){hoverClassName=A.className;A.className=hoverClassName+" "+hoverClassName+"_hover"}function hout(A){A.className=hoverClassName}function opqTb(B){var A=B.getElementsByTagName("div")[0];A.className="flake_toolbar flake_toolbar_hover"}function alphaTb(B){if(!$isVisible("sendFlakeOptionsMenu")){var A=B.getElementsByTagName("div")[0];A.className="flake_toolbar"}};
HttpLoader={getUrl:function(B,D){var A=new Sys.Net.WebRequest();A.set_url(B);A.set_httpVerb("GET");A.add_completed(function(E){if(E.get_responseAvailable()){D(E.get_responseData(),B)}else{D("",B)}});var C=new Sys.Net.XMLHttpExecutor();A.set_executor(C);C.executeRequest()},load:function(A,B){HttpLoader.getUrl(A,function(C){HttpLoader.process(C,B)})},process:function(M,B){var P=HttpLoader.parseTags(M,"style");var S=HttpLoader.parseTags(M,"link","href","text/css");var I=HttpLoader.parseTags(M,"script","src");var G=HttpLoader.parseTags(M,"script");var O=HttpLoader.contentOutsideTags(M,["style","link","script"]);var H=O.indexOf("<body");var F=O.indexOf(">",H)+1;var J=O.substring(F,O.lastIndexOf("</body>"));var C=document.getElementsByTagName("head")[0];for(var N=0;N<P.length;N++){var Q=P[0];var R=PF.$$("style");R.setAttribute("type","text/css");if(R.styleSheet){R.styleSheet.cssText=Q}else{var T=document.createTextNode(Q);R.appendChild(Q)}C.appendChild(R)}for(var N=0;N<S.length;N++){var E=S[0];var A=PF.$$("link");A.setAttribute("type","text/css");A.setAttribute("rel","stylesheet");A.setAttribute("href",E);C.appendChild(A)}if(Browser.isSafari){insertAdjacentHTML(document.body,"beforeEnd",J)}else{document.body.insertAdjacentHTML("beforeEnd",J)}for(var N=0;N<I.length;N++){var L=I[N];var K=PF.$$("script");K.type="text/javascript";K.setAttribute("src",L);C.appendChild(K)}for(var N=0;N<G.length;N++){var D=G[N];if(Browser.isFirefox||Browser.isSafari){PU.exec(D)}else{var K=PF.$$("script");K.type="text/javascript";K.text=D;C.appendChild(K)}}$DC(B)},parseTags:function(O,C,L,G){var N=new RegExp("<"+C,"gim");var I=O.split(N);var K=[];var S="</"+C+">";for(var P=1;P<I.length;P++){var R=I[P];var M=R.indexOf(">");var J=R.substring(0,M);if(G){if(J.indexOf(G)<0){continue}}if(L){var Q=J.indexOf(L);if(Q>=0){var A=J.indexOf("=",Q+L.length);var B=J.indexOf('"',A+1);var F=J.indexOf('"',B+1);var E=J.substring(B+1,F);K.push(E)}}else{var D=R.indexOf(S,M);if(D-M>2){var H=R.substring(M+1,D);if(H.trim().length>0){K.push(H)}}}}return K},contentOutsideTags:function(E,H){var F="<"+H.join("|<");var K=new RegExp(F,"gim");var M=[];var D=K.exec(E);if(D==null){return E}var J=0;while(D!=null){var G=K.lastIndex;var B=D[0];M.push(E.substring(J,G-B.length));var I=B.substring(1,B.length);var C=E.indexOf(">",G);if(E.charAt(C-1)=="/"){J=C+1}else{var A="</"+I+">";var L=E.indexOf(A,G);J=L+A.length}D=K.exec(E)}M.push(E.substring(J,E.length));return M.join("\n")}};var ScriptLoader=function ScriptLoader(){var A=this;this.urls=[];this.callback=null;this.onScriptLoad=null};

function UserRegistration(A){if(typeof A=="undefined"){var A=""}document.location.href="Signup.aspx"+A}function ScriptLoader_add(A){this.urls.add(A)}function ScriptLoader_setCallback(A,B){this.onScriptLoad=A;this.callback=B}function ScriptLoader_start(){if(this.urls.length>0){var A=this.urls.pop();this.load(A,this.loadComplete)}}function ScriptLoader_loadComplete(){if(this.urls.length>0){this.start()}else{this.callback()}}function ScriptLoader_load_safari(A,B){if(A.indexOf(SITE_PREFIX)==0||A.indexOf("http://")<0){HttpLoader.getUrl(A,function(C){B(C,A)})}else{App.ContentProxy.GetUrl1(A,43200,function(C){B(C,A)})}}function ScriptLoader_load(A,B){HttpLoader.getUrl(A,B)}function ScriptLoader_loadScript(B,E,D){if(Browser.isSafari){this.load_safari(B,function(F,G){PU.exec(F);D(B,F)})}else{var C=PF.$$("script");C.id=E;C.type="text/javascript";C.setAttribute("src",B);if(Browser.isFirefox||Browser.isSafari){if(C.readyState!="loaded"){function A(F){D(B);PF.clearEvent(this)}PF.addEvent(C,"error",A);PF.addEvent(C,"load",A)}}else{if(C.readyState!="loaded"&&C.readyState!="complete"){PF.addEvent(C,"readystatechange",function(F){if(this.readyState=="loaded"||this.readyState=="complete"){PF.clearEvent(this);D(B)}})}else{D(B)}}$head.appendChild(C)}}ScriptLoader.prototype={add:ScriptLoader_add,setCallback:ScriptLoader_setCallback,start:ScriptLoader_start,loadComplete:ScriptLoader_loadComplete,load:ScriptLoader_load,load_safari:ScriptLoader_load_safari,loadScript:ScriptLoader_loadScript};

App.startup=function(A){window.document.designMode="Off";App.Server=CoreServices;App.ContentProxy=ContentProxy;if(A){App.initApp(window.startupInfo)}else{App.showPageflakes(window.startupInfo,window.currentPageContent)}};disposeElements=function(B){var C=document.getElementsByTagName(B);for(var A=0;A<C.length;A++){$clearEvent(C[A])}};removeElements=function(B){var C=document.getElementsByTagName(B);for(var A=0;A<C.length;A++){$remove(C[A])}};DisposePageflakes=function(){try{var C=new Date().getTime();$ND(document.body);if(Browser.isIE6){$clearEvent(document.body);if($head){$clearEvent($head)}$head=null;removeElements("IFRAME");disposeElements("DIV");disposeElements("A")}if(null!=App.pages){for(var A=0;A<App.pages.length;A++){App.pages[A].dispose()}delete App.pages;delete App}if(typeof TabManager!="undefined"){TabManager.dispose()}if(typeof TM!="undefined"){TM.hideTooltip()}if(typeof FlakeMenu!="undefined"){FlakeMenu.dispose()}if(typeof Start!="undefined"){if(typeof Start.Theme!="undefined"){Start.Theme.dispose()}}Sys.Application.dispose()}catch(B){}};

function loadFirstPage(D){startupInfo=window.startupInfo;if(startupInfo==null){return alert("An error occured. Please refresh")}if(startupInfo.ErrorMsg!=null&&startupInfo.ErrorMsg!==""){alert(startupInfo.ErrorMsg);window.suppressLoad=true;$showMsg(PU.formatText(startupInfo.ErrorMsg));$hide("PageLoadProgress");return}if(LANGUAGE!=startupInfo.Language){LANGUAGE=startupInfo.Language}if(VERSION_SUFFIX!=startupInfo.VersionSuffix){document.location.reload(true)}else{if(startupInfo.IsMySite&&startupInfo.CurrentPageID==0){document.location.href="Logout.aspx?LoadProblem=true&ReturnUrl="+escape(document.location.href)}else{if(!startupInfo.IsMySite&&startupInfo.CurrentPageID==0){if(startupInfo.IsAnonymous){document.location.href="Login.aspx?ReturnUrl="+escape(document.location.href)}else{$showMsg(Lang.NO_PAGE_TO_ViEW);window.suppressLoad=true;$hide("headerRight")}}else{var A=startupInfo.CurrentPageID;if(A>0){var F=false;function B(G){if(null==G&&F===false){F=true;E()}else{window.startupInfo=startupInfo;window.currentPageContent=G;l.endPageContent=new Date();App.startup();if(typeof D!="undefined"){D()}}}function E(){window.setTimeout(function(){CoreServices.GetPageContent(startupInfo.UserGUID,startupInfo.CurrentPageID,VERSION_SUFFIX+"retry",B)},3000)}if(startupInfo.IsCurrentPageLoaded){var C=startupInfo.Pages.find(function(G){return G.ID==startupInfo.CurrentPageID});B(C)}else{CoreServices.GetPageContent(startupInfo.UserGUID,startupInfo.CurrentPageID,VERSION_SUFFIX,B,E)}}}}}}var PrimaryFramework={};$DC(function(){if(!window.suppressLoad){if(null==window.startupInfo){$showMsg(Lang.SOMETHING_WRONG)}else{if(!window.startupInfo.IsFirstVisit){loadFirstPage()}}}});window.onunload=function(){DisposePageflakes()};
var GCQ={_callQueue:[],_callInProgress:0,_maxConcurrentCall:2,TIMEOUT:10000,call:function(C,H,G,B,E,A,D,F){var I=new QueuedCall(C,H,G,B,E,A,D,F);Array.add(GCQ._callQueue,I);GCQ.run()},run:function(){if(0==GCQ._callQueue.length){return}if(GCQ._callInProgress<GCQ._maxConcurrentCall){GCQ._callInProgress++;var A=GCQ._callQueue[0];Array.removeAt(GCQ._callQueue,0);A.execute()}else{GCQ.setCallTimeout()}},callComplete:function(){if(GCQ._callInProgress>0){GCQ._callInProgress--}GCQ.run()},setCallTimeout:function(){if(GCQ.timerID>0){}else{GCQ.timerID=window.setTimeout(function(){if(GCQ._callInProgress>0){GCQ._callInProgress--}},GCQ.TIMEOUT)}}};QueuedCall=function(H,A,D,F,E,B,G,C){this._servicePath=H;this._methodName=A;this._useGet=D;this._params=F;this._onSuccess=E;this._onFailure=B;this._userContext=G;this._timeout=C};QueuedCall.prototype={execute:function(){Sys.Net.WebServiceProxy.original_invoke(this._servicePath,this._methodName,this._useGet,this._params,Function.createDelegate(this,this.onSuccess),Function.createDelegate(this,this.onFailure),this._userContext,this._timeout)},onSuccess:function(A,E,B){if(this._onSuccess!=null){try{this._onSuccess(A,E,B)}catch(C){var D="GCQ:  Error while calling onSuccess: "+B+" : "+C;App.addError(D);$alert(D)}}GCQ.callComplete()},onFailure:function(A,E,B){if(this._onFailure!=null){try{this._onFailure(A,E,B)}catch(C){var D="GCQ: Error while calling onFailure: "+B+" : "+C;App.addError(D);$alert(D)}}GCQ.callComplete()}};(function(){Sys.Net.WebServiceProxy.original_invoke=Sys.Net.WebServiceProxy.invoke;Sys.Net.WebServiceProxy.invoke=function A(I,B,E,G,F,C,H,D){GCQ.call(I,B,E,G,F,C,H,D)}})();
var TabManagerLight={create:function(){var A=$("tabs");PF.removeAll(A);App.pages.forEach(function(G){var D=G.id;var C=D===App.currentPage.id;var I=G.title;if(I===""){I=Lang.UNTITLED}if(!G.IsOwner&&App.IsMySite){I+=" ("+G.OwnerFullname+")"}var B=PF.$$("li");B.className=G.pageTheme.ThemeShortcut+"_tab";B.id=D;var H=PF.$$("a");var F=PF.$$("div");F.className="page_title";T(F,I);H.appendChild(F);if(C){if(G.IsOwner){H.className=" page_tab page_tab"+(G.IsPublished?"_public":(G.IsShared?"_shared":""))}else{if(App.IsMySite){H.className="page_tab page_tab_notmine"+(G.IsPublished?"_public":(G.IsShared?"_shared":""))}else{H.className="page_tab page_tab"}}var E=$$("a","","delete_page","X");H.appendChild(E)}else{if(G.IsOwner){H.className="page_tab_off page_tab"+(G.IsPublished?"_public":(G.IsShared?"_shared":""))+"_off"}else{if(App.IsMySite){H.className="page_tab_off page_tab_notmine"+(G.IsPublished?"_public":(G.IsShared?"_shared":""))+"_off"}else{H.className="page_tab_off page_tab_off"}}}B.appendChild(H);A.appendChild(B)})}};
